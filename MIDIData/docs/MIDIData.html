<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML LANG="ja">
<HEAD>
<TITLE>MIDIDataライブラリ　公式ガイドブック</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<STYLE TYPE="text/css">
<!--
H1 {FONT-SIZE:36px; BORDER-WIDTH:1px; BORDER-COLOR:#000000; BORDER-STYLE:SOLID; PADDING:20px; BACKGROUND-COLOR:#E0E0D0; TEXT-ALIGN:CENTER;}
H2 {FONT-SIZE:28px; BORDER-WIDTH:1px; BORDER-COLOR:#000000; BORDER-STYLE:SOLID; PADDING:20px; BACKGROUND-COLOR:#E0E0D0}
H3 {FONT-SIZE:24px;}
H4 {FONT-SIZE:16px;}
H5 {FONT-SIZE:14px;}
H6 {FONT-SIZE:12px;}
P {FONT-SIZE:12px; LINE-HEIGHT:18px;}
DIV {FONT-SIZE:12px; LINE-HEIGHT:18px;}
DIV.INDEX {FONT-SIZE:14px; LINE-HEIGHT:18px;}
DIV.TITLE {FONT-SIZE:12px; LINE-HEIGHT:18px;}
SPAN.RED {FONT-SIZE:12px; COLOR:#FF0000; LINE-HEIGHT:18px;}
SPAN.KEYWORD {FONT-SIZE:12px; COLOR:#0000FF; LINE-HEIGHT:18px;}
SPAN.COMMENT {FONT-SIZE:12px; COLOR:#008000; LINE-HEIGHT:18px;}
SPAN.STRING {FONT-SIZE:12px; COLOR:#808000; LINE-HEIGHT:18px;}
LI {FONT-SIZE:12px; LINE-HEIGHT:18px;}
TABLE {FONT-SIZE:12px; LINE-HEIGHT:18px;}
TH {BACKGROUND-COLOR:#FFE0B0; FONT-WEIGHT:NORMAL;}
TR {BACKGROUND-COLOR:#FFFFD0; FONT-WIEGHT:NORMAL;}
PRE {FONT-SIZE:12px; LINE-HEIGHT:18px; BACKGROUND-COLOR:#E0E0E0; PADDING:1px;}
-->
</STYLE>
</HEAD>
<BODY BGCOLOR="#FFFFFFF" ALINK="#0040FF" VLINK="#0040FF">

<H1>MIDIDataライブラリ<BR>公式ガイドブック<BR><FONT SIZE=3>(C)2002-2020 くず / おーぷんMIDIぷろじぇくと</FONT></H1>

<H3>はじめに</H3>

<P>　MIDIDataライブラリは、フリーでオープンソースの、MIDIデータ作成・編集用ライブラリである。このライブラリは、MIDIデータの作成、世界樹シーケンスファイル(*.skj)入出力、スタンダードMIDIファイル(*.mid)入出力(SMFフォーマット0/1/2)、Cherryシーケンスファイル(*.chy)入出力、MIDICSVファイル(*.csv)入出力、MIDIトラックの作成・追加・変更・削除、MIDIイベントの作成・追加・変更・削除など、MIDIデータのあらゆる要素に迅速にアクセスする関数を提供している。</P>

<P>　タイムベースは、TPQNベース(分解能=1〜32767)とSMPTEベース(24,25,29.97,30フレーム／秒)(分解能=1〜255)の両方に対応。タイムベース取得・変換関数も装備。フォーマットは0/1/2に対応。フォーマット取得・変換関数も装備。MIDIデータのタイトル・著作権・コメント・開始タイム・終了タイムなどを簡易に取得・設定する関数も提供している。</P>

<P>　また、MIDIデータ中のテンポイベントを解析して、タイムコードをミリ秒に変換する関数や、拍子記号イベントを解析して、タイムコードを小節：拍：ティックに変換する関数も装備。内部演算は必要に応じて64ビットとし、テンポチェンジの激しい曲でも計算誤差を1ミリ秒以内に抑えている。</P>

<P>　MIDIDataライブラリは普通のC言語で書かれているが、ソースのほか、ダイナミックリンクライブラリ(*.dll)の形で提供される。ゆえに、C/C++からはもちろんのこと、Visual BasicやDelphiから使用することもできる。最新のMIDIDataライブラリは、2020年現在<A HREF="https://openmidiproject.osdn.jp/index.html">おーぷんMIDIぷろじぇくと</A>からダウンロードできる。</P>

<P>　本書はMIDIDataライブラリの使い方を解説した公式ガイドブックである。本書は、サンプルコードと関数リファレンスを交えつつ、Cマガ風味に仕上げた。<SPAN CLASS="RED">本書はスタンダードMIDIファイル(SMF)のフォーマットを解説したものではない。</SPAN>とは言え、MIDIデータライブラリの構造は限りなくSMFに近く、関数名や変数名もSMFを基にしている。SMFの知識があれば、この本を理解するのに大いに役に立つであろう。</P>

<P>　本書は、基本的なMIDIの知識とC言語の知識があることを前提に書かれている。従って、MIDIとは何かとか、4分音符とは何かとか、構造体とは何かとか、ポインタとは何かとかについては、一切述べていない。MIDIやC言語については、良質な市販の本が多く出版されているので、そちらを参照されたい。</P>

<H3>謝辞</H3>

<P>　MIDIDataライブラリは、MIDIデータを扱うあらゆるアプリケーションの中核となるべく、数年がかりで開発された。当初の開発のきっかけは、自作のRPGやMIDIシーケンサーソフトを作るために、MIDIデータを簡単に作成編集できるライブラリが必要と感じたからである。しかし、sourceforgeを見てもわかるように、画像やオーディオ関係の作成編集ライブラリが充実しているのに比べて、MIDI関係の作成編集ライブラリは無いに等しかった。そこで筆者はこのライブラリを製作することを決意した。</P>

<P>　思えば、本ライブラリがリリースできたのは奇跡的である。会社は大変に忙しかったため、時間は限りなく足りなかった。その上不況は深刻で、金欠病でもあった。そのようなさなか、昔から愛用のノートパソコンがついに壊れた。やがて筆者は疲れていたのか、電車内で失神したのである。幸いにも入院せずに済んだが、今後の人生に暗い影を落とした。</P>

<P>　リリースにあたっては、まず、書庫部の皆様にお礼を述べなければならない。書庫部にはベテランのプログラマがおり、彼らの刺激なくしてはこのライブラリはリリースできなかったであろう。中でもあましんさんは、もともと正常だった筆者をこちらの世界に導いた人物として重要である。彼無くしては、筆者はいまだにC言語やMIDIの存在を知らなかった恐れすらある。そして最後に、あらゆる面においていつも筆者を支えてくださった家族の皆に、深く感謝の意とお礼を申し上げたい。</P>

<H3>もくじ</H3>
<DIV CLASS="INDEX"><A HREF="#MIDIOverview">第1章　概略</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_MIDI">1-1.MIDIについて</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_MIDIData">1-2.MIDIデータについて</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_Structure">1-3.MIDIDataライブラリのデータ構造</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_Create">1-4.MIDIDataライブラリでMIDIデータを作る</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_Print">1-5.MIDIDataライブラリでMIDIデータを表示する</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_ANSI_UNICODE">1-6.ANSIとUNICODEの使い分けについて</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIOverview_SetDefaultCharCode">1-7.MIDIDataLib_SetDefaultCharCodeについて</A></DIV>
<DIV CLASS="INDEX"><A HREF="#MIDIData">第2章　MIDIデータ</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_Struct">2-1.MIDIデータの構造</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_Format">2-2.MIDIデータのフォーマット</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_TimeBase">2-3.MIDIデータのタイムベース</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_CreateFunction">2-4.MIDIデータの生成</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_DeleteFunction">2-5.MIDIデータの削除</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_LoadFunction">2-6.MIDIデータのファイル読み込み</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_SaveFunction">2-7.MIDIデータのファイル保存</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_InsertTrackFunction">2-8.MIDIデータへのトラック挿入</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_RemoveTrackFunction">2-9.MIDIデータからトラック除去</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_GetFunction">2-10.MIDIデータの情報取得</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_SetFunction">2-11.MIDIデータの情報設定</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_OtherFunction">2-12.MIDIデータのその他の関数</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIData_forEachTrack">2-13.MIDIデータ内の各トラックへのアクセス</A></DIV>
<DIV CLASS="INDEX"><A HREF="#MIDITrack">第3章　MIDIトラック</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_Struct">3-1.MIDIトラックの構造</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_Status">3-2.MIDIトラックの状態</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_CreateFunction">3-3.MIDIトラックの生成</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_DeleteFunction">3-4.MIDIトラックの削除</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_InsertEventFunction">3-5.MIDIトラックへのイベント挿入</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_RemoveEventFunction">3-6.MIDIトラックからイベント除去</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_IsFunction">3-7.MIDIトラックの状態取得</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_GetFunction">3-8.MIDIトラックの情報取得</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_SetFunction">3-9.MIDIトラックの情報設定</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_OtherFunction">3-10.MIDIトラック上での時刻変換</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDITrack_forEachEvent">3-11.MIDIトラック内の各イベントへのアクセス</A></DIV>
<DIV CLASS="INDEX"><A HREF="#MIDIEvent">第4章　MIDIイベント</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_Struct">4-1.MIDIイベントの構造</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_Kind">4-2.MIDIイベントの種類</A></DIV>
<DIV CLASS="INDEX">　　　　<A HREF="#MIDIEvent_MetaEvent">メタイベント</A></DIV>
<DIV CLASS="INDEX">　　　　<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A></DIV>
<DIV CLASS="INDEX">　　　　<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_Status">4-3.MIDIイベントの状態</A></DIV>
<DIV CLASS="INDEX">　　　　<A HREF="#MIDIEvent_FloatingEvent">浮遊イベント</A></DIV>
<DIV CLASS="INDEX">　　　　<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_CreateFunction">4-4.MIDIイベントの生成</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_DeleteFunction">4-5.MIDIイベントの削除</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_IsFunction">4-6.MIDIイベントの状態取得</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_GetFunction">4-7.MIDIイベントの情報取得</A></DIV>
<DIV CLASS="INDEX">　　<A HREF="#MIDIEvent_SetFunction">4-8.MIDIイベントの情報設定</A></DIV>
<DIV CLASS="INDEX"><A HREF="#APPENDIX_A">付録A　よくある質問(F.A.Q)</A></DIV>
<DIV CLASS="INDEX"><A HREF="#APPENDIX_B">付録B　キー・ナンバー対応表</A></DIV>
<DIV CLASS="INDEX"><A HREF="#APPENDIX_C">付録C　MIDIイベント取得・設定関数対応表</A></DIV>
<DIV CLASS="INDEX"><A HREF="#APPENDIX_D">付録D　更新履歴</A></DIV>


<H2><A NAME="MIDIOverview">第1章：概略</A></H2>


<H3><A NAME="MIDIOverview_MIDI">1-1.MIDIについて</A></H3>
<P>　MIDIとは<U>M</U>usical <U>I</U>nstrument <U>D</U>igital <U>I</U>nterfaceの略で、電子楽器の間で情報を通信するための規格である。その中でも中核となるのが、MIDI音源と呼ばれる機器である。MIDI音源は電子楽器の一種であり、さまざまな音色を内蔵している。MIDI音源は予め内蔵された音色しか使えないが、シンセサイザーを用いれば内蔵された音色を自由に加工・変形・合成して新しい音色を作り出すことができる。</P>

<P>　MIDI音源の基本的な使い方は、MIDI対応キーボードで演奏をして音を鳴らすというものである。最近では、コンピュータの普及により、パソコンで再生してMIDI音源を演奏することもできるようになった。自動演奏をする場合の演奏方法を記述したものがMIDIデータである。</P>

<DIV>▼Fig1-1-1　MIDIの構成</DIV>
<IMG SRC="MIDIDR02.gif" WIDTH=600 HEIGHT=360 ALT="">

<H3><A NAME="MIDIOverview_MIDIData">1-2.MIDIデータについて</A></H3>

<P>　MIDIデータは電子楽器の演奏方法を記述したものである。一般的にMIDIデータ内には単数又は複数のトラックが含まれ、トラックの中には複数のイベントが含まれている。各イベントには、「いつ」「何をする」という情報が含まれている。</P>

<DIV>▼Fig1-2-1　MIDIデータの構成</DIV>
<IMG SRC="MIDIDR03.gif" WIDTH=600 HEIGHT=525 ALT="">

<P>　しばしばMIDIデータは、WaveやMP3と同様にオーディオデータとして扱われるが、これは大きな間違いである。MIDIデータに記述されているものは、オーディオの波形ではなく、あくまで「ドの音を押す」「ペダルを踏む」といった<STRONG>楽器に対する動作</STRONG>である。</P>

<P>　また、しばしばMIDIデータは音が悪いと言われるが、これも大きな間違いである。MIDIはあくまで演奏方法の伝達規格であるから、そもそも音質に関する情報をもっていない。音質は音源(サウンドジェネレーター又はシンセサイザー)によって決定する。よく音が悪いと誤解されるのは、多くの人がコンピュータ内蔵の安物の音源を使っているからであろう。MIDIデータを高品位に演奏しようと思えば、専用の音源モジュールやシンセサイザーが必要となる。</P>

<H3><A NAME="MIDIOverview_Structure">1-3.MIDIDataライブラリのデータ構造</A></H3>

<P>　MIDIDataライブラリでは、MIDIデータ内のすべての情報を管理するために、<A HREF="#MIDIData">MIDIデータ</A>, <A HREF="#MIDITrack">MIDIトラック</A>, <A HREF="#MIDIEvent">MIDIイベント</A>という3つの構造体を定義している。MIDIデータはMIDIトラックを子に持ち、MIDIトラックはMIDIイベントを子に持つことができる。MIDIデータライブラリにおける操作や参照は、これらの構造体へのポインタを介して行われる。</P>

<DIV>▼Fig1-3-1　MIDIDataライブラリのデータ構造</DIV>
<IMG SRC="MIDIDR01.gif" WIDTH=640 HEIGHT=480 ALT="MIDIデータの全体構成図">

<P>　MIDIデータ・MIDIトラック・MIDIイベントは互いにポインタで接続されている。同一構造体の接続は双方向リンクリスト形式になっており、前後の要素へはGetPrev系関数、GetNext系関数でアクセスすることができる。またすべての子オブジェクトは親オブジェクトへのポインタを保持しており、GetParent系関数でアクセスすることができる。親オブジェクトは子の最初と最後のオブジェクトのみポインタを保持しており、それぞれGetFirst系関数、GetLast系関数でアクセスすることができる。</P>

<H3><A NAME="MIDIOverview_Create">1-4.MIDIDataライブラリでMIDIデータを作る</A></H3>

<P>　ここにMIDIデータを製作するサンプルプログラムを示す。作成するMIDIデータは、次の図に示す「ちょうちょ」である。この曲は、テンポは120、音色はピアノで、「そみみー、ふぁれれー、どれみふぁそそそー」の旋律を演奏するものである。</P>

<DIV>▼Fig1-4-1　「ちょうちょ」のMIDIデータのもとになる楽譜</DIV>
<IMG SRC="MIDIDR04.gif" WIDTH=400 HEIGHT=100 ALT="MIDIデータの製作">

<DIV>▼List1-4-1　「ちょうちょ」のMIDIデータを製作するプログラム</DIV>
<PRE>
<SPAN CLASS="KEYWORD">#include</SPAN> &lt;stdio.h&gt;
<SPAN CLASS="KEYWORD">#include</SPAN> &lt;MIDIData.h&gt;
<SPAN CLASS="KEYWORD">int</SPAN> main () {
	MIDIData* pMIDIData;
	MIDITrack* pMIDITrack;
	<SPAN CLASS="COMMENT">/* MIDIデータの生成(フォーマット0,トラック数1,TPQNベース,120) */</SPAN>
	pMIDIData = MIDIData_Create (MIDIDATA_FORMAT0, 1, MIDIDATA_TPQNBASE, 120);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIData == NULL) {
		printf (<SPAN CLASS="STRING">"MIDIデータの生成に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 最初のトラックへのポインタを取得 */</SPAN>
	pMIDITrack = MIDIData_GetFirstTrack (pMIDIData);
	<SPAN CLASS="COMMENT">/* イベントを挿入 */</SPAN>
	MIDITrack_InsertTrackName (pMIDITrack, 0, "ちょうちょ"); <SPAN CLASS="COMMENT">/* タイトル */</SPAN>
	MIDITrack_InsertTempo (pMIDITrack, 0, 60000000 / 120); <SPAN CLASS="COMMENT">/* 120BPM */</SPAN>
	MIDITrack_InsertProgramChange (pMIDITrack, 0, 0, 0); <SPAN CLASS="COMMENT">/* Piano1 */</SPAN>
	<SPAN CLASS="COMMENT">/* ノートイベントを挿入            Time  ch  key  vel  dur */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,     0,  0,  67, 100, 120); <SPAN CLASS="COMMENT">/* そ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   120,  0,  64, 100, 120); <SPAN CLASS="COMMENT">/* み */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   240,  0,  64, 100, 240); <SPAN CLASS="COMMENT">/* みー */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   480,  0,  65, 100, 120); <SPAN CLASS="COMMENT">/* ふぁ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   600,  0,  62, 100, 120); <SPAN CLASS="COMMENT">/* れ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   720,  0,  62, 100, 240); <SPAN CLASS="COMMENT">/* れー */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   960,  0,  60, 100, 120); <SPAN CLASS="COMMENT">/* ど */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1080,  0,  62, 100, 120); <SPAN CLASS="COMMENT">/* れ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1200,  0,  64, 100, 120); <SPAN CLASS="COMMENT">/* み */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1320,  0,  65, 100, 120); <SPAN CLASS="COMMENT">/* ふぁ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1440,  0,  67, 100, 120); <SPAN CLASS="COMMENT">/* そ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1560,  0,  67, 100, 120); <SPAN CLASS="COMMENT">/* そ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,  1680,  0,  67, 100, 240); <SPAN CLASS="COMMENT">/* そー */</SPAN>
	<SPAN CLASS="COMMENT">/* エンドオブトラックイベントを挿入 */</SPAN>
	MIDITrack_InsertEndofTrack (pMIDITrack, 1920);
	<SPAN CLASS="COMMENT">/* MIDIデータを保存 */</SPAN>
	MIDIData_SaveAsSMF (pMIDIData, <SPAN CLASS="STRING">"chocho.mid"</SPAN>);
	<SPAN CLASS="COMMENT">/* MIDIデータをメモリ上から削除 */</SPAN>
	MIDIData_Delete (pMIDIData);
	pMIDIData = NULL;
	<SPAN CLASS="KEYWORD">return</SPAN> 1;
}
</PRE>

<P>　このプログラムでは、まず1つのトラックをもつ空のMIDIデータをメモリ上に生成している。MIDIデータの生成には、<A HREF="#MIDIData_Create">MIDIData_Create</A>関数を使っている。最初のトラックに、トラック名、テンポチェンジ、プログラムチェンジ、及びノートイベントを挿入していく。イベントの挿入には、それぞれ<A HREF="#MIDITrack_InsertTrackName">MIDITrack_InsertTrackName</A>関数、<A HREF="#MIDITrack_InsertTempo">MIDITrack_InsertTempo</A>関数、<A HREF="#MIDITrack_InsertProgramChange">MIDITrack_InsertProgramChange</A>関数、<A HREF="#MIDITrack_InsertNote">MIDITrack_InsertNote</A>関数を使った。最後に、MIDIデータをスタンダードMIDIファイルに保存し、MIDIデータをメモリ上から削除して終了する。MIDIデータのファイル保存には<A HREF="#MIDIData_SaveAsSMF">MIDIData_SaveAsSMF</A>関数を、メモリ上からの削除には<A HREF="#MIDIData_Delete">MIDIData_Delete</A>関数を使用した。</P>

<P>　このプログラムの実行により、<A HREF="chocho.mid">chocho.mid</A>というファイルが出力される。このファイルは、メディアプレイヤーなどで再生できる、スタンダードMIDIファイル(SMFフォーマット0)である。</P>


<H3><A NAME="MIDIOverview_Print">1-5.MIDIDataライブラリでMIDIデータを表示する</A></H3>

<P>　次に、MIDIデータをダンプするサンプルプログラムを示す。ここでは先ほどのchocho.midを読み込み、各トラック中の全イベントの内容を表示する。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_Dump1">▼List1-5-1.MIDIデータの内容をダンプするプログラム</A></DIV>
<PRE>
<SPAN CLASS="KEYWORD">#include</SPAN> &lt;stdio.h&gt;
<SPAN CLASS="KEYWORD">#include</SPAN> &lt;MIDIData.h&gt;
<SPAN CLASS="KEYWORD">int</SPAN> main () {
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDIData* pMIDIData;
	MIDITrack* pMIDITrack;
	MIDIEvent* pMIDIEvent;
	<SPAN CLASS="COMMENT">/* MIDIデータをスタンダードMIDIファイル(*.mid)から読み込む */</SPAN>
	pMIDIData = MIDIData_LoadFromSMF (<SPAN CLASS="STRING">"chocho.mid"</SPAN>);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIData == NULL) {
		printf (<SPAN CLASS="STRING">"MIDIファイルが開けません。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* MIDIデータのプロパティを出力する。*/</SPAN>
	printf (<SPAN CLASS="STRING">"[MIDIデータ]\n"</SPAN>);
	printf (<SPAN CLASS="STRING">"フォーマット=%d\n"</SPAN>, MIDIData_GetFormat (pMIDIData));
	printf (<SPAN CLASS="STRING">"トラック数=%d\n"</SPAN>, MIDIData_GetNumTrack (pMIDIData));
	printf (<SPAN CLASS="STRING">"タイムモード=%d\n"</SPAN>, MIDIData_GetTimeMode (pMIDIData));
	printf (<SPAN CLASS="STRING">"タイムレゾリューション=%d\n"</SPAN>, MIDIData_GetTimeResolution (pMIDIData));
	<SPAN CLASS="COMMENT">/* それぞれのトラックについて */</SPAN>
	forEachTrack (pMIDIData, pMIDITrack) {
		printf (<SPAN CLASS="STRING">"[MIDIトラック]\n"</SPAN>);
		printf (<SPAN CLASS="STRING">"小節:拍:ﾃｨｯｸ 種類              長さ  内容\n"</SPAN>);
		<SPAN CLASS="COMMENT">/* それぞれのイベントについて */</SPAN>
		forEachEvent (pMIDITrack, pMIDIEvent) {
			printf (<SPAN CLASS="STRING">"%s\n"</SPAN>, MIDIEvent_ToString (pMIDIEvent, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
		}
	}
	<SPAN CLASS="COMMENT">/* MIDIデータをメモリ上から削除する */</SPAN>
	MIDIData_Delete (pMIDIData);
	<SPAN CLASS="KEYWORD">return</SPAN> 1;
}
</PRE>

<P>　このプログラムでは、まずMIDIデータをスタンダードMIDIファイル(*.mid)から読み込み、<A HREF="#MIDIData_Format">フォーマット</A>、トラック数、<A HREF="#MIDIData_TimeBase">タイムモード</A>、<A HREF="#MIDIData_TimeBase">タイムレゾリューション(分解能)</A>を表示する。MIDIデータの読み込みには、<A HREF="#MIDIData_LoadFromSMF">MIDIData_LoadFromSMF</A>関数を、MIDIデータのプロパティの取得にはそれぞれ、<A HREF="#MIDIData_GetFormat">MIDIData_GetFormat</A>関数、<A HREF="#MIDIData_GetNumTrack">MIDIData_GetNumTrack</A>関数、<A HREF="#MIDIData_GetTimeMode">MIDIData_GetTimeMode</A>関数、<A HREF="#MIDIData_GetTimeResolution">MIDIData_GetTimeResolution</A>関数を用いた。次に、各々のトラックについて、イベントのタイム、種類、長さ[バイト]、内容を出力する。イベントの内容を文字列で表すために、デバッグ用のMIDIEvent_ToString関数(※この関数はデバッグ用であり、非公式なものである)を用いた。</P>

<P>　全要素にアクセスする際に活躍するのが<A HREF="#forEachTrack">forEachTrack</A>マクロと<A HREF="#forEachEvent">forEachEvent</A>マクロである。これらのマクロはforループの一種である。forEachTrackマクロはMIDIデータ内の全トラックを順番に評価する。一方、forEachEventマクロはトラック内の全イベントを順番に評価する。</P>

<P>　次にこのプログラムの実行結果を示す。MIDIデータのプロパティの他、各トラック(ここでは1トラックしかないが)のイベントリストが表示される。注意すべきことは、<A HREF="#MIDITrack_InsertNote">MIDITrack_InsertNote</A>関数により、<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>と<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>の2つのMIDIイベントが挿入されていることである。ほとんどのMIDIシーケンサー上ではノートオフイベントは見えないが、<SPAN CLASS="RED">スタンダードMIDIファイルでは、ノートオフイベントとノートオンイベントは別々に格納されているのである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_Dump2">▼List1-5-2.上のプログラムの実行結果</A></DIV>
<PRE>
[MIDIデータ]
フォーマット=0
トラック数=1
タイムモード=0
レゾリューション=120
[MIDIトラック]
小節:拍:ﾃｨｯｸ 種類              長さ  内容
00000:00:000 TrackName           10 {"ちょうちょ"}
00000:00:000 Tempo                3 {500000[microsec/beat](120[BPM])}
00000:00:000 ProgramChange        2 {0xC0    0}
00000:00:000 NoteOn               3 {0x90  G_5  100       120}
00000:01:000 NoteOff              3 {0x90  G_5    0      -120}
00000:01:000 NoteOn               3 {0x90  E_5  100       120}
00000:02:000 NoteOff              3 {0x90  E_5    0      -120}
00000:02:000 NoteOn               3 {0x90  E_5  100       240}
00001:00:000 NoteOff              3 {0x90  E_5    0      -240}
00001:00:000 NoteOn               3 {0x90  F_5  100       120}
00001:01:000 NoteOff              3 {0x90  F_5    0      -120}
00001:01:000 NoteOn               3 {0x90  D_5  100       120}
00001:02:000 NoteOff              3 {0x90  D_5    0      -120}
00001:02:000 NoteOn               3 {0x90  D_5  100       240}
00002:00:000 NoteOff              3 {0x90  D_5    0      -240}
00002:00:000 NoteOn               3 {0x90  C_5  100       120}
00002:01:000 NoteOff              3 {0x90  C_5    0      -120}
00002:01:000 NoteOn               3 {0x90  D_5  100       120}
00002:02:000 NoteOff              3 {0x90  D_5    0      -120}
00002:02:000 NoteOn               3 {0x90  E_5  100       120}
00002:03:000 NoteOff              3 {0x90  E_5    0      -120}
00002:03:000 NoteOn               3 {0x90  F_5  100       120}
00003:00:000 NoteOff              3 {0x90  F_5    0      -120}
00003:00:000 NoteOn               3 {0x90  G_5  100       120}
00003:01:000 NoteOff              3 {0x90  G_5    0      -120}
00003:01:000 NoteOn               3 {0x90  G_5  100       120}
00003:02:000 NoteOff              3 {0x90  G_5    0      -120}
00003:02:000 NoteOn               3 {0x90  G_5  100       240}
00004:00:000 NoteOff              3 {0x90  G_5    0      -240}
00004:00:000 EndofTrack           0 {}
</PRE>



<H3><A NAME="MIDIOverview_ANSI_UNICODE">1-6.ANSIとUNICODEの使い分けについて</A></H3>

<P>MIDIDataライブラリ2.6から文字列がANSIとUNICODEの両対応になった。今まではANSIのみに対応していた。今までのC/C++ソースコードはそのまま使用できるが、再コンパイルは必要である。プリプロセッサでUNICODEが定義されているときのみUNICODEとなり、その他の場合はANSIとなる。</P>

<H4>構造体の文字列フィールドはchar*型からvoid*型になった。</H4>

<P>文字列フィールドは<SPAN class="keyword">char</SPAN>*型であったが、ANSIでは<SPAN class="keyword">char</SPAN>*型、UNICODEではwchar_t*型とするために、<SPAN class="keyword">void</SPAN>*型とした。実際、プログラマーはこの点を気にする必要はない。</P>

<H4>関数の文字列はchar*型はTCHAR*型となった。</H4>

<P>関数の文字列は<SPAN class="keyword">char</SPAN>*型であったが、ANSIでは<SPAN class="keyword">char</SPAN>*型、UNICODEではwchar_t型とするために、TCHAR型とした。</P>
<PRE>
<SPAN class="keyword">#ifdef</SPAN> UNICODE
<SPAN class="keyword">typedef</SPAN> TCHAR wchar_t;
<SPAN class="keyword">#else</SPAN>
<SPAN class="keyword">typedef</SPAN> TCHAR <SPAN class="keyword">char</SPAN>;
<SPAN class="keyword">#endif</SPAN>
</PRE>


<P>実際の関数は、次のようにANSI用とUNICODE用の2種類が用意されている。これは、普通のWindowsAPI関数と同じ手法である。</P>
<PRE>
MIDIData* MIDIData_LoadFromSMFA (<SPAN class="keyword">const char</SPAN>* pszFileName);
MIDIData* MIDIData_LoadFromSMFW (<SPAN class="keyword">const</SPAN> wchar_t* pszFileName);
<SPAN class="keyword">#ifdef</SPAN> UNICODE
MIDIData_LoadFromSMF MIDIData_LoadFromSMFW
<SPAN class="keyword">#else</SPAN>
MIDIData_LoadFromSMF MIDIData_LoadFromSMFA
<SPAN class="keyword">#endif</SPAN>
</PRE>

<H4>文字列の長さの単位はバイトから文字になった。</H4>

<P>従来、文字列の長さの単位はバイトであったが、文字になった。1文字の長さは、ANSI版では1バイト、UNICODE版では2バイト(Visual Studioの場合)となる。</P>

<H3><A NAME="MIDIOverview_SetDefaultCharCode">1-7.MIDIDataLib_SetDefaultCharCode</A></H3>

<P>MIDIデータでは、文字コードに関する情報を保持していない。そのため、テキスト系イベントの文字列を正しく取得・設定するために、MIDIDataLib_SetDefaultCharCodeを用いて、MIDIDataライブラリのテキストエンコーダで用いる文字コードを予め正しく設定しておく必要がある。何も指定しなかった場合、MIDIEVENT_NOCHARCODEが適用される。MIDIEVENT_NORCHARCODEのときは、Windowsのコントロールパネルで指定されている文字コード(ANSI Code Page)でテキストエンコードするものとみなされる。</P>

<DIV CLASS="TITLE"><A NAME="MIDIDataLib_SetDefaultCharCode">▼List1-7.MIDIDataLib_SetDefaultCharCode関数の使い方</A></DIV>
<PRE>
	MIDIDataLib_SetDefaultCharCode (MIDIEVENT_JP);
</PRE>

<DIV CLASS="TITLE"><A NAME="MIDIDataLib_SetDefaultCharCodeTable">▼Table1-7.MIDIDataLib_SetDefaultCharCode関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIDataLib_SetDefaultCharCode"><SPAN CLASS="KEYWORD">long</SPAN> MIDIDataLib_SetDefaultCharCode<BR>(<SPAN CLASS="KEYWORD">long</SPAN> lCharCode);</A> </TD>
  <TD>lCharCode : (MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR></TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIDataライブラリのテキストエンコーダで用いるデフォルトの文字コードを設定する。この関数は、<A HREF="#MIDITrack_InsertTextEvent">MIDITrack_InsertTextEvent</A>, <A HREF="#MIDITrack_InsertCopyrightNotice">MIDITrack_InsertCopyrightNotice</A>, <A HREF="#MIDITrack_InsertTrackName">MIDITrack_InsertTrackName</A>, <A HREF="#MIDITrack_InsertInstrumentName">MIDITrack_InsertInstrumentName</A>, <A HREF="#MIDITrack_InsertLyric">MIDITrack_InsertLyric</A>, <A HREF="#MIDITrack_InsertMarker">MIDITrack_InsertMarker</A>, <A HREF="#MIDITrack_InsertCuePoint">MIDITrack_InsertCuePoint</A>, <A HREF="#MIDITrack_InsertProgramName">MIDITrack_InsertProgramName</A>, <A HREF="#MIDITrack_InsertDeviceName">MIDITrack_InsertDeviceName</A>, <A HREF="#MIDIEvent_CreateTextEvent">MIDIEvent_CreateTextEvent</A>, <A HREF="#MIDIEvent_CreateCopyrightNotice">MIDIEvent_CreateCopyrightNotice</A>, <A HREF="#MIDIEvent_CreateTrackName">MIDIEvent_CreateTrackName</A>, <A HREF="#MIDIEvent_CreateInstrumentName">MIDIEvent_CreateInstrumentName</A>, <A HREF="#MIDIEvent_CreateLyric">MIDIEvent_CreateLyric</A>, <A HREF="#MIDIEvent_CreateMarker">MIDIEvent_CreateMarker</A>, <A HREF="#MIDIEvent_CreateCuePoint">MIDIEvent_CreateCuePoint</A>, <A HREF="#MIDIEvent_CreateProgramName">MIDIEvent_CreateProgramName</A>, <A HREF="#MIDIEvent_CreateDeviceName">MIDIEvent_CreateDeviceName</A>, <A HREF="#MIDIEvent_GetText">MIDIEvent_GetText</A>, <A HREF="#MIDIEvent_SetText">MIDIEvent_SetText</A>, MIDIEvent_ToString, MIDIEvent_ToStringEx に影響を及ぼす。</TD>
 </TR>
</TABLE>


<H2><A NAME="MIDIData">第2章：MIDIデータ</A></H2>

<H3><A NAME="MIDIData_Struct">2-1.MIDIデータの構造</A></H3>

<P>　MIDIデータは、<A HREF="#MIDIData_Format">フォーマット</A>、トラック数、タイムベース(タイムモード及び分解能)の情報を持ち、子に単数又は複数のトラックを持つことができる。</P>

<P><SPAN CLASS="RED">　MIDIデータのプロパティとして、よくタイトルや著作権情報が表示されるが、これらはMIDIデータ構造体の管理する情報ではない。MIDIデータの中にある最初のトラックの、最初の<A HREF="#MIDIEvent_TrackName">トラック名イベント</A>及び最初の<A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>が、そういった情報を保持しているのである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_FieldTable">▼Table2-1.MIDIデータ構造体のフィールドと使い方</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">フィールド</TH>
  <TH WIDTH="75%">使い方</TH>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lFormat</TD>
  <TD><A HREF="#MIDIData_FormatTable">MIDIデータのフォーマット</A>。<A HREF="#MIDIData_Format0">MIDIDATA_FORMAT0(=0)</A>, <A HREF="#MIDIData_Format1">MIDIDATA_FORMAT1(=1)</A>, <A HREF="#MIDIData_Format2">MIDIDATA_FORMAT2(=2)</A>のいずれかの値とする。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lNumTrack</TD>
  <TD>このMIDIデータ内にあるトラックの数。<A HREF="#MIDIData_CountTrack">MIDIData_CountTrack</A>関数を使うと更新される。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lTimeBase</TD>
  <TD>MIDIデータの<A HREF="#MIDIData_TimeBase">タイムベース</A>。タイムベースにはタイムモードとタイムレゾリューション(分解能)の両方の情報が含まれている。m_lTimeBaseの値は、((256 - タイムモード) &lt;&lt; 8) + タイムレゾリューション　である。</TD>
 </TR>
 <TR>
  <TD>MIDITrack* m_pFirstTrack</TD>
  <TD>このMIDIデータ内にある最初の<A HREF="#MIDITrack">MIDIトラック</A>へのポインタ。最初のMIDIトラックがない場合はNULL。</TD>
 </TR>
 <TR>
  <TD>MIDITrack* m_pLastTrack</TD>
  <TD>このMIDIデータ内にある最後の<A HREF="#MIDITrack">MIDIトラック</A>へのポインタ。最後のMIDIトラックがない場合はNULL。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser1</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その1。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser2</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その2。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser3</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その3。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUserFlag</TD>
  <TD>ユーザーが自由に使うことのできるフラグのための拡張領域。例えば、選択/非選択・可視/不可視・フィルタリング中・編集ロック中などの状態を保持する。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_Format">2-2.MIDIデータのフォーマット</A></H3>

<P>　MIDIデータには、フォーマット0/1/2の3種類が存在する。それぞれのフォーマットによって、<A HREF="#MIDITrack">MIDIトラック</A>の取り扱い方が異なる。以下に各MIDIデータのフォーマットと意味を示す。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_FormatTable">▼Table2-2.MIDIデータのフォーマットと意味</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="20%">識別番号</TH>
  <TH WIDTH="20%">名前</TH>
  <TH WIDTH="60%">意味</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_Format0">MIDIDATA_FORMAT0 (=0)</A></TD>
  <TD>フォーマット0</TD>
  <TD>フォーマット0のMIDIデータは、ひとつの<A HREF="#MIDITrack">MIDIトラック</A>をもち、そのMIDIトラックにすべての<A HREF="#MIDIEvent">MIDIイベント</A>が格納されている。フォーマット0のMIDIデータは最も単純であり、ほとんどすべてのMIDIプレイヤーで再生できる反面、全イベントが1トラックに混在しており編集するには不便である。MIDIトラックがひとつしかなくても、1音又は1音色しか使えないというわけではない。MIDIチャンネル情報は各<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>ごとに付加されているので、ひとつのMIDIトラックでも16チャンネルを普通に取り扱うことができる。ただし、XFデータ(YAMAHAの拡張仕様)の場合は、3つのトラックを持ち、第2トラックにXFで始まるテキストイベントが、第3トラックに歌詞とキューポイントが格納される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_Format1">MIDIDATA_FORMAT1 (=1)</A></TD>
  <TD>フォーマット1</TD>
  <TD>フォーマット1のMIDIデータは、複数の<A HREF="#MIDITrack">MIDIトラック</A>をもつ。<SPAN CLASS="RED">最初のMIDIトラックはコンダクタートラックと呼ばれ、<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_Tempo">テンポ</A>・<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>・<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>・<A HREF="#MIDIEvent_KeySignature">調性記号</A>などのイベントと、音源調整のための<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシヴイベント</A>が含まれる。ノートオンなどの<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>は、2番目以降のMIDIトラックに含まれる。</SPAN>従って、通常の16トラックのMIDIデータには、コンダクタートラックも含めると実は17トラック入っている。フォーマット1のMIDIデータでは、編集のしやすさを考えて、普通は1トラックに1つのチャンネルを対応させる。<SPAN CLASS="RED">なお、1つのトラック内に複数チャンネルのMIDIチャンネルイベントを混入させてはならない。</SPAN>また、トラックごとにポートを設定することにより、2台以上の音源を同時に制御することができる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_Format2">MIDIDATA_FORMAT2 (=2)</A></TD>
  <TD>フォーマット2</TD>
  <TD>フォーマット2のMIDIデータは、複数の<A HREF="#MIDITrack">MIDIトラック</A>をもつ。トラックごとに異なる楽曲が記述されたものであり、楽曲を切り替えながら演奏する目的で使う。各トラックは同時に演奏されるものではない。各MIDIトラックには、あらゆる種類の<A HREF="#MIDIEvent">MIDIイベント</A>を含めることができる。なお、現在ではフォーマット2はほとんど用いられないので、このフォーマットを使用するべきではない。</TD>
 </TR>
</TABLE>

<P>　MIDIデータのフォーマットは、<A HREF="#MIDIData_GetFormat">MIDIData_GetFormat</A>関数で取得できる。又、<A HREF="#MIDIData_SetFormat">MIDIData_SetFormat</A>関数で変換できる。ただし、変換によってMIDIデータの一部の情報が失われることがある。</P>

<H3><A NAME="MIDIData_TimeBase">2-3.MIDIデータのタイムベース</A></H3>

<P>　MIDIデータのタイムベースは、このMIDIデータの全イベントの時刻の単位を定めるものである。タイムベースはタイムモードとタイムレゾリューション(分解能)からなる。タイムモードには大きく分けて<A HREF="#MIDIDATA_TPQNBASE">TPQNベース</A>と<A HREF="#MIDIDATA_SMPTEBASE">SMPTEベース</A>があり、タイムレゾリューションは4分音符当たりの分解能又は1フレーム当たりの分解能を表す値である。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_TimeModeTable">▼Table2-3.タイムモード一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">識別番号</TH>
  <TH WIDTH="25%">名前</TH>
  <TH WIDTH="50%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIDATA_TPQNBASE">MIDIDATA_TPQNBASE (=0)</A></TD>
  <TD>TPQNベース</TD>
  <TD>　TPQN(<U>T</U>icks <U>P</U>er <U>Q</U>uarter <U>N</U>ote)ベースのMIDIデータは、4分音符の長さを基準としたもので、時刻単位としてティック[tick]と呼ばれる単位を用いる。このモードの場合、タイムレゾリューションは4分音符当たりの分解能を表し、48, 96, 120, 144, 192, 240, 360, 480, 960などの値がよく使われる。例えばタイムレゾリューション(分解能)が120であれば、8分音符の長さは60[tick]、4分音符の長さは120[tick]、2分音符の長さは240[tick]となる。タイムレゾリューションは値が大きいほうがより精密にイベントの時刻を指定できるが、データ量や演算が重くなるので、また、長い楽曲が作成できなくなるので、通常は120、最大でも480あれば十分である。4分音符の実際の時間はテンポに依存する。テンポは<A HREF="#MIDIEvent_Tempo">テンポイベント</A>で別途定義される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIDATA_SMPTEBASE"></A><A NAME="MIDIDATA_SMPTE24BASE">MIDIDATA_SMPTE24BASE (=24)</A></TD>
  <TD>SMPTEベース・24フレーム／秒</TD>
  <TD ROWSPAN=4>　SMPTEフレームベースのMIDIデータは、主に映画のフレームに同期することを目的としており、テンポという概念はない。タイムモードの値は1秒あたりのフレーム数を表す(ただし29は29.97とする)。このモードの場合、タイムレゾリューションの値は、1フレーム当たりの分解能を表す。なお、タイムモードにMIDIDATA_SMPTE25BASE、タイムレゾリューションに40を指定すれば、1秒当たりの分解能ははちょうど1000となり、1ミリ秒単位のMIDIデータを作成することができる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIDATA_SMPTE25BASE">MIDIDATA_SMPTE25BASE (=25)</A></TD>
  <TD>SMPTEベース・25フレーム／秒</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIDATA_SMPTE29BASE">MIDIDATA_SMPTE29BASE (=29)</A></TD>
  <TD>SMPTEベース・29.97フレーム／秒</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIDATA_SMPTE30BASE">MIDIDATA_SMPTE30BASE (=30)</A></TD>
  <TD>SMPTEベース・30フレーム／秒</TD>
 </TR>
</TABLE>

<P>　MIDIデータのタイムモードは<A HREF="#MIDIData_GetTimeMode">MIDIData_GetTimeMode</A>関数で、MIDIデータのタイムレゾリューションは<A HREF="#MIDIData_GetTimeResolution">MIDIData_GetTimeResolution</A>関数で取得できる。また、MIDIデータのタイムモードとタイムレゾリューションの両方を、<A HREF="#MIDIData_GetTimeBase">MIDIData_GetTimeBase</A>関数で同時に取得できる。また、<A HREF="#MIDIData_SetTimeBase">MIDIData_SetTimeBase</A>関数を使って、MIDIデータのタイムモードとタイムレゾリューションを変更することができる。ただし、変更により時刻精度が失われることがある。</P>


<H3><A NAME="MIDIData_CreateFunction">2-4.MIDIデータの生成</A></H3>

<P>　MIDIデータをメモリ上に新規生成するには、MIDIData_Create系関数を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_CreateFunctionList">▼List2-4.MIDIDataCreate系関数の使い方</A></DIV>
<PRE>
	MIDIData* pMIDIData;
	<SPAN CLASS="COMMENT">/* MIDIデータの生成(フォーマット1,トラック数=6,TPQNベース,分解能=120/4分音符) */</SPAN>
	pMIDIData = MIDIData_Create (MIDIDATA_FORMAT1, 6, MIDIDATA_TPQNBASE, 120);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIData == NULL) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIデータの生成に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_CreateFunctionTable">▼Table2-4.MIDIDataCreate系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_Create">MIDIData* MIDIData_Create <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lFormat, <SPAN CLASS="KEYWORD">long</SPAN> lNumTrack, <SPAN CLASS="KEYWORD">long</SPAN> lTimeMode, <SPAN CLASS="KEYWORD">long</SPAN> lTimeResolution);</A> </TD>
  <TD>lFormat:MIDIデータのフォーマット(<A HREF="#MIDIData_Format0">MIDIDATA_FORMAT0</A>, <A HREF="#MIDIData_Format1">MIDIDATA_FORMAT1</A>, <A HREF="#MIDIData_Format2">MIDIDATA_FORMAT2</A>のいずれか)<BR>lNumTrack:初期トラック数(0〜)<BR>lTimeMode:タイムモード(<A HREF="#MIDIDATA_TPQNBASE">MIDIDATA_TPQNBASE</A>, <A HREF="#MIDIDATA_SMPTE24BASE">MIDIDATA_SMPTE24BASE</A>, <A HREF="#MIDIDATA_SMPTE25BASE">MIDIDATA_SMPTE25BASE</A>, <A HREF="#MIDIDATA_SMPTE29BASE">MIDIDATA_SMPTE29BASE</A>, <A HREF="#MIDIDATA_SMPTE30BASE">MIDIDATA_SMPTE30BASE</A>のいずれか)<BR>lTimeResolution:タイムレゾリューション</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>空のMIDIデータを新規に生成する。生成直後には指定した数のMIDIトラックが既に含まれているが、各々のMIDIトラックには何のMIDIイベントも含まれていない。各MIDIトラックに<A HREF="#MIDIEvent_EndofTrack">エンドオブトラック</A>イベントを挿入するには、プログラマの責任である。lNumTrackの値は、<A HREF="#MIDIData_Format0">フォーマット0</A>のとき1、その他の場合は1以上でなければならない。<BR><A HREF="#MIDIData_TimeBase">タイムレゾリューション(分解能)</A>は、タイムモードがTQPNベースの場合、4分音符あたりの分解能を指定する。その値は、MIDIDATA_MINTPQNRESOLUTION(=1)以上、MIDIDATA_MAXTPQNRESOLUTION(=32767)以下の値でなければならない。タイムモードがSMPTEベースの場合、1フレームあたりの分解能を指定する。その値は、MIDIDATA_MINSMPTERESOLUTION(=1)以上、MIDIDATA_MAXSMPTERESOLUTION(=255)以下の値でなければならない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_DeleteFunction">2-5.MIDIデータの削除</A></H3>

<P>　MIDIデータをメモリ上から削除するには、MIDIData_Delete系関数を使う。</P>

<P><SPAN CLASS="RED">　<A HREF="#MIDIData_CreateFunction">MIDIData_Create系関数</A>又は<A HREF="#MIDIData_LoadFunction">MIDIData_Load系関数</A>で生成したMIDIデータは、使用し終わったらMIDIData_Delete系関数でメモリ上から削除しなければならない。</SPAN>MIDIデータライブラリではメモリの自動解放(ガベージコレクション)を行わないので、この手続きは常に必要である。もし忘れれば、メモリリークが発生するであろう。</P>

<P><SPAN CLASS="RED">　MIDIデータを削除した直後には、ポインタにNULLを代入しておくべきである。</SPAN>これをしなければ、このMIDIデータが既に削除されていることが外部からわからなくなってしまい、バグの原因となりうる。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_DeleteFunctionList">▼List2-5.MIDIDataDelete関数の使い方</A></DIV>
<PRE>
	MIDIData_Delete (pMIDIData);
	pMIDIData = NULL;
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_DeleteFunctionTable">▼Table2-5.MIDIDataDelete系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_Delete"><SPAN CLASS="KEYWORD">void</SPAN> MIDIData_Delete <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>未定義</TD>
  <TD>MIDIデータを削除する。<SPAN CLASS="RED">この関数は、MIDIデータ内に含まれる全MIDIトラック、そのMIDIトラック内に含まれる全MIDIイベントをも、自動的に削除する。</SPAN></TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_LoadFunction">2-6.MIDIデータのファイル読み込み</A></H3>

<P>　MIDIDataライブラリはMIDIデータのファイル入力に対応している。現在のところ、世界樹シーケンスファイル(*.skj)と、スタンダードMIDIファイル(*.mid)フォーマット0/1/2と、Cherryシーケンスファイル(*.chy)と、MIDICSVファイル(*.csv)に対応している。</P>

<P>　スタンダードMIDIファイル(*.mid)又はMIDICSVファイル(*.csv)からのMIDIデータの読み込みに成功したら、<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>と<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>を結合するために、すべてのノートオンイベントに対して、<A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>をかけるとよい。これにより、MIDIイベントの総数は変わることはないが、互いのイベントが結合状態となり、ノートイベントの音長さが取得・設定可能になる。なお、世界樹シーケンスファイル(*.skj)又はCherryシーケンスファイル(*.chy)から読み込んだ場合は、ノートオンとノートオフの結合状態は、保存時のものが復元されるため、このような処理は必要ない。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_LoadFunctionList">▼List2-6.MIDIData_Load系関数の使い方</A></DIV>
<PRE>
	MIDIData* pMIDIData;
	MIDITrack* pMIDITrack;
	MIDIEvent* pMIDIEvent;
	<SPAN CLASS="COMMENT">/* スタンダードMIDIファイル(*.mid)からMIDIデータの読み込み */</SPAN>
	pMIDIData = MIDIData_LoadFromSMF (<SPAN CLASS="STRING">"c:\\my documents\\test1.mid"</SPAN>);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIData == NULL) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIデータの読み込みに失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	forEachTrack (pMIDIData, pMIDITrack) {
		forEachEvent (pMIDITrack, pMIDIEvent) {
			<SPAN CLASS="KEYWORD">if</SPAN> (MIDIEvent_IsNoteOn (pMIDIEvent)) {
				MIDIEvent_Combine (pMIDIEvent);
			}
		}
	}
	....
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_LoadFunctionTable">▼Table2-6.MIDIData_Load系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromBinary">MIDIData* MIDIData_LoadFromBinary <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>世界樹シーケンスファイル(*.skj)からMIDIデータを読み込む。この関数は、ユーザー用拡張領域などを含むすべての情報を復元する。<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>の結合状態も復元する。その意味で、完全な可逆性を保つ。この関数は、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>も読み込む(そのようなメタイベントの取扱い方はプログラマが定義しなければならない)。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromSMF">MIDIData* MIDIData_LoadFromSMF <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>スタンダードMIDIファイル(*.mid)からMIDIデータを読み込む。この関数は、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>も読み込む(そのようなメタイベントの取扱い方はプログラマが定義しなければならない)。スタンダードMIDIファイルではイベントの結合状態を保存していないので、読み込み直後には、<A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>でノートオンとノートオフを結合することが望ましい。また、各MIDIトラックの入力・出力はすべてONで初期化され、入力ポート・出力ポートは<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>に従って初期化され(ない場合は0)、入力チャンネル・出力チャンネルは、そのトラック内の<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>のチャンネルに従って初期化され(不明な場合はn/a)、表示モードは、トラック内のMIDIイベント解析して自動的に通常かドラムかが設定される。この関数は、MThdチャンクに保存されているトラック数に関係なく、実際に保存されているMTrkチャンクを可能な限り読み込む。MIDIデータが、XFデータ(YAMAHAの拡張形式)であり、かつフォーマット0の場合は、第二トラックのXFIHチャンクと第三トラックのXFKMチャンクも読み込める。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromCherry">MIDIData* MIDIData_LoadFromCherry <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>Cherryシーケンスファイル(*.chy)からMIDIデータを読み込む。Cherryシーケンスファイル(*.chy)では、<A HREF="#MIDIEvent_NoteOn">ノートオン</A>と<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>はもともとセットで保存されているので、この関数呼び出しと同時に自動的にノートオンとノートオフは結合状態となる。MIDITrackの入力・出力はすべてONで初期化され、入力ポート・出力ポートは保存されているポート番号に従って初期化され、入力チャンネル・出力チャンネルは、保存されているチャンネル番号に従って初期化され、表示モードは保存されている表示モードに従って初期化される。Cherryシーケンスファイル(*.chy)には、リズムパターンという特殊なデータを持つことがあるが、それは読み込まない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromMIDICSV">MIDIData* MIDIData_LoadFromMIDICSV <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>MIDICSVファイル(*.csv)からMIDIデータを読み込む。この関数は、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>は読み込まない。MIDICSVファイルではイベントの結合状態を保存していないので、読み込み直後には、<A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>でノートオンとノートオフを結合することが望ましい。また、各MIDIトラックの入力・出力はすべてONで初期化され、入力ポート・出力ポートは<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>に従って初期化され(ない場合は0)、入力チャンネル・出力チャンネルは、そのトラック内の<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>のチャンネルに従って初期化され(不明な場合はn/a)、表示モードは、トラック内のMIDIイベント解析して自動的に通常かドラムかが設定される。また、この関数は、隠しトラック・XFデータ(YAMAHAの拡張形式)の拡張部を読み込めない。テキスト系イベント中に含まれる"\011","\015","\012"は、それぞれTAB,CR,LFとして読み込まれる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromWRK">MIDIData* MIDIData_LoadFromWRK <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>旧Cakewalkシーケンスファイル(*.wrk)からMIDIデータを読み込む。この関数は、スタンダードMIDIファイルに関係ない部分は無視するが、トラックの出力ポート、出力チャンネルについては、wrkファイルに保存されているものを採用する。wrkファイルでは、<A HREF="#MIDIEvent_NoteOn">ノートオン</A>と<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>はもともとセットで保存されているので、この関数呼び出しと同時に自動的にノートオンとノートオフは結合状態となる。wrkファイルはプロプライエタリなフォーマットであり、解析が困難であるため、すべてのイベントが正確に読み込めるとは限らない。現在のところ、ファイルヴァージョン2.0(Cakewalk3.xにより生成)と3.0(Cakewalk5.xにより生成)に関しては、ほぼ正確に読み込める状態である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromMIDICSV">MIDIData* MIDIData_LoadFromMIDICSV <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>MIDICSVファイル(*.csv)からMIDIデータを読み込む。この関数は、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>は読み込まない。MIDICSVファイルではイベントの結合状態を保存していないので、読み込み直後には、<A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>でノートオンとノートオフを結合することが望ましい。また、各MIDIトラックの入力・出力はすべてONで初期化され、入力ポート・出力ポートは<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>に従って初期化され(ない場合は0)、入力チャンネル・出力チャンネルは、そのトラック内の<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>のチャンネルに従って初期化され(不明な場合はn/a)、表示モードは、トラック内のMIDIイベント解析して自動的に通常かドラムかが設定される。また、この関数は、隠しトラック・XFデータ(YAMAHAの拡張形式)の拡張部を読み込めない。テキスト系イベント中に含まれる"\011","\015","\012"は、それぞれTAB,CR,LFとして読み込まれる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_LoadFromMabiMML">MIDIData* MIDIData_LoadFromMabiMML <BR>(<SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:MIDIデータへのポインタ<BR>異常終了:NULL</TD>
  <TD>マビノギMMLファイル(*.mmml)からMIDIデータを読み込む。ファイルはANSIテキストフォーマットで、そのテキストは"t95v14l16o4eg#ab&gt;c4&amp;c8&lt;a4.gb&gt;cdd4e8&lt;b4."のような1チャンネルフォーマットか、"MML@[ch1],[ch2],[ch3];"のようなマルチチャンネルフォーマットでなければならない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_SaveFunction">2-7.MIDIデータのファイル保存</A></H3>

<P>　MIDIDataライブラリはMIDIデータのファイル出力に対応している。現在のところ、世界樹シーケンスファイル(*.skj)と、スタンダードMIDIファイル(*.mid)フォーマット0/1/2と、Cherryシーケンスファイル(*.chy)と、MIDICSVファイル(*.csv)に対応している。</P>

<P>　<SPAN CLASS="RED">スタンダードMIDIファイル(*.mid)で保存する場合には、注意が必要である。まず、各トラックの最後は必ず<A HREF="#MIDIEvent_EndofTrack">エンドオブトラック</A>イベントで終わらなければならない。また、特に<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータの時、最初のトラックに<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>が混入していてはならず、2番目以降のトラックに<A HREF="#MIDIEvent_Tempo">テンポ</A>・<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>・<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>・<A HREF="#MIDIEvent_KeySignature">調性記号</A>イベントが混入していてはならない。これらのチェックは行われないので、プログラマが注意深くMIDIデータを作成しなければならない。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_SaveFunctionList">▼List2-7.MIDIData_Save系関数の使い方</A></DIV>
<PRE>
	...
	<SPAN CLASS="COMMENT">MIDIデータをスタンダードMIDIファイルとして保存</SPAN>
	ret = MIDIData_SaveAsSMF (pMIDIData, <SPAN CLASS="STRING">"c:\\my documents\\test2.mid"</SPAN>);
	<SPAN CLASS="KEYWORD">if</SPAN> (ret == 0) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIデータの保存に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_SaveFunctionTable">▼Table2-7.MIDIData_Save系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SaveAsBinary"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SaveAsBinary <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータを世界樹シーケンスファイル(*.skj)として保存する。保存時のフォーマット0/1/2やタイムベース(タイムモードと分解能)はMIDIデータ構造体に保持されているものをそのまま適用する。この関数は、ユーザー用拡張領域などを含むすべての情報を保存する。ノートオンとノートオフなどの<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>も保存する。その意味で、完全な可逆性を保つ。なお、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>も保存する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SaveAsSMF"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SaveAsSMF <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータをスタンダードMIDIファイル(*.mid)として保存する。保存時のフォーマット0/1/2やタイムベース(タイムモードと分解能)は、MIDIData構造体に保持されているものをそのまま適用する。なお、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>も保存する。一方、スタンダードMIDIファイル(*.mid)では、MIDIDataのユーザー用拡張領域、MIDITrackの入力・入力ポート・入力チャンネル・出力・出力ポート・出力チャンネル・タイム+・キー+・ベロシティ+・表示モード・前景色・背景色・ユーザー用拡張領域、MIDIEventのユーザー用拡張領域を保存しない。また、スタンダードMIDIファイル(*.mid)は、MIDIイベントが結合しているという概念を持たないので、ノートオンとノートオフなどの<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>はすべて切り離して保存される。その意味で、完全な可逆性は保たれない。MIDIデータが、XFデータ(YAMAHAの拡張仕様)であり、かつフォーマット0の場合、第二トラックと第三トラックは、それぞれXFIHとXFKMチャンクとして保存される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SaveAsCherry"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SaveAsCherry <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータをCherryシーケンスファイル(*.chy)として保存する。保存時のタイムベースはMIDIData構造体に保持されているものをそのまま適用する。Cherryシーケンスファイル(*.chy)では、MIDIDataのユーザー用拡張領域、MIDITrackの入力・入力ポート・入力チャンネル・出力・前景色・背景色・ユーザー用拡張領域、MIDIEventのユーザー用拡張領域を保存しないが、MIDITrackの出力ポート・出力チャンネル・タイム+・キー+・ベロシティ+は保存する。また、Cherryシーケンスファイル(*.chy)に保存されるMIDIイベントの種類は、<A HREF="#MIDIEvent_TrackName">トラック名</A>(1トラックにつき1つだけ)、<A HREF="#MIDIEvent_NoteOnNoteOff">ノート</A>(<A HREF="#MIDIEvent_NoteOn">ノートオン</A>と<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>の結合しているもの)、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>、<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>、<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシヴ</A>、<A HREF="#MIDIEvent_TextEvent">テキスト</A>、<A HREF="#MIDIEvent_Lyric">歌詞</A>、<A HREF="#MIDIEvent_Tempo">テンポ</A>、<A HREF="#MIDIEvent_EndofTrack">エンドオブトラック</A>、<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>、<A HREF="#MIDIEvent_KeySignature">調性記号</A>に限る。MIDIデータのタイトルと著作権は、最初のトラックの<A HREF="#MIDIEvent_TrackName">トラック名</A>と<A HREF="#MIDIEvent_CopyrightNotice">著作権</A>が1つずつ保存される。その意味で、完全な可逆性は保たれない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SaveAsMIDICSV"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SaveAsMIDICSV <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszFileName);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszFileName:ファイル名を表すヌル終了文字列へのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータをMIDICSVファイル(*.csv)として保存する。保存時のフォーマット0/1/2やタイムベース(タイムモードと分解能)は、MIDIData構造体に保持されているものをそのまま適用する。なお、スタンダードMIDIファイル又はMIDIDataライブラリで未定義の種類の<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>も保存する。一方、MIDICSVファイル(*.csv)では、MIDIDataのユーザー用拡張領域、MIDITrackの入力・入力ポート・入力チャンネル・出力・出力ポート・出力チャンネル・タイム+・キー+・ベロシティ+・表示モード・前景色・背景色・ユーザー用拡張領域、MIDIEventのユーザー用拡張領域を保存しない。また、MIDICSVファイル(*.csv)は、MIDIイベントが結合しているという概念を持たないので、ノートオンとノートオフなどの<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>はすべて切り離して保存される。その意味で、完全な可逆性は保たれない。MIDIデータが、XFデータ(YAMAHAの拡張仕様)である場合、最初のトラックしか保存されない。テキスト系イベント中に含まれるTAB,CR,LFは、それぞれ"\011","\015","\012"として保存される。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDIData_InsertTrackFunction">2-8.MIDIデータへのトラック挿入</A></H3>

<P>　MIDIデータにトラックを挿入するには、MIDIData_InsertTrack系関数を使う。</P>

<P>　MIDIDataライブラリでは、無制限にトラックを追加することができるが、スタンダードMIDIファイルは最大65535トラックまでしか保持できない。フォーマット0のMIDIデータは1トラックまでである。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_InsertTrackFunctionList">▼List2-8.MIDIData_InsertTrack系関数の使い方</A></DIV>
<PRE>
	...
	pMIDIData = MIDIData_Create (MIDIDATA_FORMAT1, 6, MIDIDATA_TPQNBASE, 120);
	...
	<SPAN CLASS="COMMENT">/* 新しいトラックを生成 */</SPAN>
	pMIDITrack = MIDITrack_Create ();
	...
	<SPAN CLASS="COMMENT">/* 新しいトラックをMIDIデータの最後に追加 */</SPAN>
	MIDIData_InsertTrackAfter (pMIDIData, pMIDITrack, pMIDIData-&gt;m_pLastTrack);
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_InsertTrackFunctionTable">▼Table2-8.MIDIData_InsertTrack系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_InsertTrackBefore"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_InsertTrackBefore <BR>(MIDIData* pMIDIData, MIDITrack* pMIDITrack, MIDITrack* pTarget);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pMIDITrack:挿入するトラックへのポインタ<BR>pTarget:ターゲットトラックへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>ターゲットトラックの直前にpMIDITrackで示すトラックを挿入する。挿入するトラックは予め作成しておく必要があり、かつ浮遊状態でなければならない。pTargetがNULLの場合、リストの最後に挿入される。pTargetがNULLでない場合、pTargetはpMIDITrackに所属しているトラックでなければならない。トラック数は自動的に1加算される。この関数は、MIDIトラックとMIDIデータのフォーマットに関する整合性をチェックしない。特に<A HREF="#MIDIData_Format1">フォーマット1</A>の時、非コンダクタートラックを最初に挿入しないように、又はコンダクタートラックを最初以外に挿入しないように、細心の注意をするべきである。<A HREF="#MIDIData_Format0">フォーマット0</A>のとき、MIDIデータ内の最大トラック数は1つであり、それ以上追加できない。ただし、XFデータ(YAMAHAの拡張形式)の場合で、かつフォーマット0の場合の最大トラック数は3つである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_InsertTrackAfter"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_InsertTrackAfter <BR>(MIDIData* pMIDIData, MIDITrack* pMIDITrack, MIDITrack* pTarget);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pMIDITrack:挿入するトラックへのポインタ<BR>pTarget:ターゲットトラックへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>ターゲットトラックの直後にpMIDITrackで示すトラックを挿入する。挿入するトラックは予め作成しておく必要があり、かつ浮遊状態でなければならない。pTargetがNULLの場合、リストの最初に挿入される。pTargetがNULLでない場合、pTargetはpMIDITrackに所属しているトラックでなければならない。トラック数は自動的に1加算される。この関数は、MIDIトラックとMIDIデータのフォーマットに関する整合性をチェックしない。特に<A HREF="#MIDIData_Format1">フォーマット1</A>の時、非コンダクタートラックを最初に挿入しないように、又はコンダクタートラックを最初以外に挿入しないように、細心の注意をするべきである。<A HREF="#MIDIData_Format0">フォーマット0</A>のとき、MIDIデータ内の最大トラック数は1つであり、それ以上追加できない。ただし、XFデータ(YAMAHAの拡張形式)の場合で、かつフォーマット0の場合の最大トラック数は3つである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_AddTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_AddTrack <BR>(MIDIData* pMIDIData, MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pMIDITrack:挿入するトラックへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータ内の全トラックの最後にpMIDITrackで示すトラックを挿入する。挿入するトラックは予め作成しておく必要があり、かつ浮遊状態でなければならない。この関数は、MIDITrack_InsertTrackBefore (pMIDIData, pMIDITrak, NULL)と同等である。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_RemoveTrackFunction">2-9.MIDIデータからトラック除去</A></H3>

<P>　MIDIデータからトラックを除去するには、MIDIData_RemoveTrack系関数を使う。この関数は、MIDIトラックをMIDIデータから除外するだけであり、MIDIトラック自体の削除は行わない。MIDIトラック自体をメモリ上から削除するには、<A HREF="#MIDITrack_Delete">MIDITrack_Delete</A>関数を使う。</P>

<P>　<SPAN CLASS="RED">フォーマット1のMIDIデータの場合、誤ってコンダクタートラック(最初のトラック)を削除しないように注意すべきである。</SPAN>コンダクタートラックを削除した場合は、直ちに新しいコンダクタートラックを挿入するべきである。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_RemoveTrackFunctionList">▼List2-9.MIDIData_RemoveTrack系関数の使い方</A></DIV>
<PRE>
	<SPAN CLASS="COMMENT">/* MIDIデータ内の最後のトラックを除外 */</SPAN>
	MIDIData_RemoveTrack (pMIDIData, pMIDIData-&gt;m_pLastTrack);
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_RemoveTrackFunctionTable">▼Table2-9.MIDIData_RemoveTrack系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_RemoveTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_RemoveTrack<BR>(MIDIData* pMIDIData, MIDITrack* pMIDITrack)</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pMIDITrack:除外するMIDIトラックへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータから指定のMIDIトラックを除外する。この関数は、MIDIトラック自体とそのMIDIトラックに含まれるイベントはメモリ上から削除しない。この関数は、MIDIトラックをMIDIデータから除去したいが、MIDIトラック自体は別の場所に保持しておきたい場合に使う。MIDIトラックは後で手動で削除されなければならない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_GetFunction">2-10.MIDIデータの情報取得</A></H3>

<P>　MIDIデータの各種情報(プロパティ)を安全に取得するには、MIDIData_Get系関数を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_GetFunctionList">▼List2-10.MIDIData_Get系関数の使い方</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDIData* pMIDIData;
	<SPAN CLASS="COMMENT">/* MIDIデータの読み込み */</SPAN>
	pMIDIData = MIDIData_LoadFromSMF (<SPAN CLASS="STRING">"c:\\my document\\e.mid"</SPAN>);
	...
	<SPAN CLASS="COMMENT">/* MIDIデータのプロパティを出力します。 */</SPAN>
	printf (<SPAN CLASS="STRING">"フォーマット = %d\n"</SPAN>, MIDIData_GetFormat (pMIDIData));
	printf (<SPAN CLASS="STRING">"トラック数 = %d\n"</SPAN>, MIDIData_GetNumTrack (pMIDIData));
	printf (<SPAN CLASS="STRING">"タイムモード = %d\n"</SPAN>, MIDIData_GetTimeMode (pMIDIData));
	printf (<SPAN CLASS="STRING">"レゾリューション = %d\n"</SPAN>, MIDIData_GetResolution (pMIDIData));
	printf (<SPAN CLASS="STRING">"最初のイベントのタイム = %d\n"</SPAN>, MIDIData_GetBeginTime (pMIDIData));
	printf (<SPAN CLASS="STRING">"最後のイベントのタイム = %d\n"</SPAN>, MIDIData_GetEndTime (pMIDIData));
	printf (<SPAN CLASS="STRING">"タイトル = \"%s\"\n"</SPAN>, MIDIData_GetTitle (pMIDIData, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
	printf (<SPAN CLASS="STRING">"著作権 = \"%s\"\n"</SPAN>, MIDIData_GetCopyright (pMIDIData, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
	printf (<SPAN CLASS="STRING">"コメント = \"%s\"\n"</SPAN>, MIDIData_GetComment (pMIDIData, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_GetFunctionTable">▼Table2-10.MIDIData_Get系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetFormat"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetFormat <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータのフォーマット(0〜2)</TD>
  <TD>MIDIデータの<A HREF="#MIDIData_Format">フォーマット</A>を返す。フォーマットは、<A HREF="#MIDIData_Format0">MIDIDATA_FORMAT0(=0)</A>, <A HREF="#MIDIData_Format1">MIDIDATA_FORMAT1(=1)</A>, <A HREF="#MIDIData_Format2">MIDIDATA_FORMAT2(=2)</A>のいずれかである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetNumTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetNumTrack <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータのトラック数</TD>
  <TD>MIDIデータのトラック数を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetTimeMode"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetTimeMode <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータのタイムモード</TD>
  <TD>MIDIデータの<A HREF="#MIDIData_TimeBase">タイムモード</A>を返す。タイムモードは、<A HREF="#MIDIDATA_TPQNBASE">MIDIDATA_TPQNBASE(=0)</A>, <A HREF="#MIDIDATA_SMPTE24BASE">MIDIDATA_SMPTE24BASE(=24)</A>, <A HREF="#MIDIDATA_SMPTE25BASE">MIDIDATA_SMPTE25BASE(=25)</A>, <A HREF="#MIDIDATA_SMPTE29BASE">MIDIDATA_SMPTE29BASE(=29)</A>, <A HREF="#MIDIDATA_SMPTE30BASE">MIDIDATA_SMPTE30BASE(=30)</A>のうちのいずれかである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetTimeResolution"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetTimeResolution <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータのタイムレゾリューション(分解能)</TD>
  <TD>MIDIデータの<A HREF="#MIDIData_TimeBase">タイムレゾリューション(分解能)</A>を返す。タイムレゾリューションは、タイムモードがMIDIDATA_TQPNBASE(=0)の場合、MIDIDATA_MINTPQNRESOLUTION(=1)以上、MIDIDATA_MAXTPQNRESOLUTION(=32767)以下の値である。タイムモードがその他の場合、MIDIDATA_MINSMPTERESOLUTION(=1)以上、MIDIDATA_MAXSMPTERESOLUTION(=255)以下の値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetTimeBase"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetTimeBase <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN>* pMode, <SPAN CLASS="KEYWORD">long</SPAN>* pResolution);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pMode:タイムモードを格納するバッファへのポインタ<BR>pResolution:タイムレゾリューション(分解能)を格納するバッファへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータの<A HREF="#MIDIData_TimeBase">タイムベース</A>、すなわちタイムモードとタイムレゾリューション(分解能)を同時に取得する。タイムモードとタイムレゾリューションの取得値は、<A HREF="#MIDIData_GetTimeMode">MIDIData_GetTimeMode</A>と<A HREF="#MIDIData_GetTimeResolution">MIDIData_GetTimeResolution</A>に順ずる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetTitle">TCHAR* MIDIData_GetTitle <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">TCHAR</SPAN>* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pBuf:タイトル文字列を格納するバッファへのポインタ<BR>lLen:最大取り込み長さ[文字]</TD>
  <TD>pBuf</TD>
  <TD>MIDIデータのタイトルを調べ、指定のバッファに格納する。ここでいうMIDIデータのタイトルとは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_TrackName">トラック名イベント</A>に含まれる文字列である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetCopyright">TCHAR* MIDIData_GetCopyright <BR>(MIDIData* pMIDIData, TCHAR* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pBuf:著作権文字列を格納するバッファへのポインタ<BR>lLen:最大取り込み長さ[文字]</TD>
  <TD>pBuf</TD>
  <TD>MIDIデータの著作権を調べ、指定のバッファに格納する。ここでいうMIDIデータの著作権とは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>に含まれる文字列である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetComment">TCHAR* MIDIData_GetComment <BR>(MIDIData* pMIDIData, TCHAR* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pBuf:コメント文字列を格納するバッファへのポインタ<BR>lLen:最大取り込み長さ[文字]</TD>
  <TD>pBuf</TD>
  <TD>MIDIデータのコメントを調べ、指定のバッファに格納する。ここでいうMIDIデータのコメントとは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_TextEvent">テキストイベント</A>に含まれる文字列である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetFirstTrack">MIDITrack* MIDIData_GetFirstTrack <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>最初のトラックへのポインタ</TD>
  <TD>最初のトラックへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetLastTrack">MIDITrack* MIDIData_GetLastTrack <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>最後のトラックへのポインタ</TD>
  <TD>最後のトラックへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetTrack">MIDITrack* MIDIData_GetTrack <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTrackIndex);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTrackIndex:トラック番号(0〜)</TD>
  <TD>指定トラック番号のトラックへのポインタ</TD>
  <TD>指定トラック番号のトラックへのポインタを返す。なければNULLを返す。この関数は低速であるので、あまり頻繁に使ってはならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetBeginTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetBeginTime <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータの開始時刻</TD>
  <TD>MIDIデータの開始時刻を返す。開始時刻とは、全トラック中における最も最初の<A HREF="#MIDIEvent">イベント</A>の時刻である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetEndTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetEndTime <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIデータの開始時刻</TD>
  <TD>MIDIデータの終了時刻を返す。終了時刻とは、全トラック中における最も最後の<A HREF="#MIDIEvent">イベント</A>の時刻である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_GetXFVersion"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_GetXFVersion <BR>(MIDIData* pMIDIData);</A> </TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>XFデータ(YAMAHAの拡張形式)のヴァージョン。XFデータでない場合は0。</TD>
  <TD>このMIDIデータにXFデータ(YAMAHAの拡張形式)であることを示すシーケンサ独自のイベントが含まれている場合、XFのヴァージョンを取得する。具体的には、シーケンサ固有のイベントで、{43 7B 00 58 46 Mj Mn S1 S0} を探し、(Mj | (Mn &lt;&lt; 8) | (S1 &lt;&lt; 16) | (S0 &lt;&lt; 24)) を返す。XFデータでない場合は0を返す。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDIData_SetFunction">2-11.MIDIデータの情報設定</A></H3>

<P>　MIDIデータの各種情報(プロパティ)を安全に設定するには、MIDIData_Set系関数を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_GetFunctionList">▼List2-11.MIDIData_Set系関数の使い方</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDIData* pMIDIData;
	<SPAN CLASS="COMMENT">/* スタンダードMIDIファイル(*.mid)からMIDIデータの読み込み */</SPAN>
	pMIDIData = MIDIData_LoadFromSMF (<SPAN CLASS="STRING">"c:\\my document\\e.mid"</SPAN>);
	...
	<SPAN CLASS="COMMENT">/* MIDIデータのプロパティを設定します。 */</SPAN>
	MIDIData_SetTitle (pMIDIData, <SPAN CLASS="STRING">"グルグル火山"</SPAN>, 12);
	MIDIData_SetCopypright (pMIDIData, <SPAN CLASS="STRING">"(C)2112 あーみぃ"</SPAN>, 16);
	MIDIData_SetComment (pMIDIData, <SPAN CLASS="STRING">"使用音源：Poland SC-88Ero"</SPAN>, 25);
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_SetFunctionTable">▼Table2-11.MIDIData_Set系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SetFormat"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SetFormat <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lFormat);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lFormat:MIDIデータのフォーマット(<A HREF="#MIDIData_Format0">MIDIDATA_FORMAT0</A>, <A HREF="#MIDIData_Format1">MIDIDATA_FORMAT1</A>, <A HREF="#MIDIData_Format2">MIDIDATA_FORMAT2</A>のいずれか)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータのフォーマットを設定する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>又は<A HREF="#MIDIData_Format2">フォーマット2</A>のMIDIデータを<A HREF="#MIDIData_Format0">フォーマット0</A>にした場合、すべての<A HREF="#MIDIEvent">MIDIイベント</A>は1個のトラックに統合される。ただし、XFデータ(YAMAHAの拡張仕様)の場合は3個のトラックに統合され、XFで始まるテキストイベントは第2トラックに、歌詞とキューポイントは第3トラックに移動する。<A HREF="#MIDIData_Format0">フォーマット0</A>のMIDIデータを<A HREF="#MIDIData_Format1">フォーマット1</A>又は<A HREF="#MIDIData_Format2">フォーマット2</A>にした場合、すべての<A HREF="#MIDIEvent">MIDIイベント</A>は、17個のトラックに分割される。このうち<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>と<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A>は最初の<A HREF="#MIDITrack">トラック</A>に、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>はチャンネル番号(0〜15)をもとにして第2トラック〜第17トラックに割り振られる。ただし、XFデータ(YAMAHAの拡張仕様)の場合は19個のトラックに分割され、XFで始まるテキストイベントは第18トラックに、歌詞とキューポイントは第19トラックに移動する。その他のフォーマットの変換は、何も起こらず、0を返す。フォーマット変換後には、各MIDIトラックの入力・出力はすべてONで初期化され、入力ポート・出力ポートは<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>に従って初期化され(ない場合は0)、入力チャンネル・出力チャンネルは、そのトラック内の<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>のチャンネルに従って初期化され(不明な場合はn/a)、表示モードは、トラック内のMIDIイベント解析して自動的に通常かドラムかが設定される。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SetTimeBase"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SetTimeBase <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTimeMode, <SPAN CLASS="KEYWORD">long</SPAN> lTimeResolution);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTimeMode:タイムモード(<A HREF="#MIDIDATA_TPQNBASE">MIDIDATA_TPQNBASE</A>, <A HREF="#MIDIDATA_SMPTE24BASE">MIDIDATA_SMPTE24BASE</A>, <A HREF="#MIDIDATA_SMPTE25BASE">MIDIDATA_SMPTE25BASE</A>, <A HREF="#MIDIDATA_SMPTE29BASE">MIDIDATA_SMPTE29BASE</A>, <A HREF="#MIDIDATA_SMPTE30BASE">MIDIDATA_SMPTE30BASE</A>のいずれか)<BR>lTimeResolution:タイムレゾリューション</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIデータのタイムモードとタイムレゾリューションを同時に設定する。この関数はタイムベース変換機能を含んでいる。それゆえ、タイムモードとタイムレゾリューションを別々に設定する関数は用意されていない。<BR>
<SPAN CLASS="RED">タイムレゾリューションは、タイムモードがTQPNベースの場合、4分音符あたりの分解能を指定する。その値は、MIDIDATA_MINTPQNRESOLUTION以上、MIDIDATA_MAXTPQNRESOLUTION以下の値でなければならない。タイムモードがSMPTEベースの場合、1フレームあたりの分解能を指定する。その値は、MIDIDATA_MINSMPTERESOLUTION以上、MIDIDATA_MAXSMPTERESOLUTION以下の値でなければならない。</SPAN><BR>
<SPAN CLASS="RED">タイムベースを変更した場合、MIDIデータ内のすべてのMIDIイベントのタイムスタンプは演奏速度が同一になるように再計算される。いったん低いタイムベースに変換した場合、時間に関する精度はその時点で失われるため、あとで高いタイムベースに戻しても、元の精度は得られない。また、TPQNベースのMIDIデータをSMPTEベースのMIDIデータに変換した場合、又はSMPTEベースのMIDIデータをTPQNベースのMIDIデータに変換した場合、タイムスタンプの小数部分は切り捨てられる。</SPAN>変換の際には内部的には64bit演算を行い、誤差が±1以下になるように最大限の努力がなされる。<BR>
</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SetTitle"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SetTitle <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>未定義</TD>
  <TD>MIDIデータのタイトルを設定する。ここでいうMIDIデータのタイトルとは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_TrackName">トラック名イベント</A>に含まれる文字列である。該当イベントが存在しない場合、自動的に追加される。pszTextがNULLの場合、タイトルは削除される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SetCopyright"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SetCopyright <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>未定義</TD>
  <TD>MIDIデータの著作権を設定する。ここでいうMIDIデータの著作権とは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>に含まれる文字列である。該当イベントが存在しない場合、自動的に追加される。pszTextがNULLの場合、著作権は削除される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_SetComment"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_SetComment <BR>(MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>未定義</TD>
  <TD>MIDIデータのコメントを設定する。ここでいうMIDIデータのコメントとは、MIDIデータ内の最初の<A HREF="#MIDITrack">トラック</A>の、最初の<A HREF="#MIDIEvent_TextEvent">テキストイベント</A>に含まれる文字列である。該当イベントが存在しない場合、自動的に追加される。pszTextがNULLの場合、コメントは削除される。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_OtherFunction">2-12.MIDIデータのその他の関数</A></H3>

<DIV CLASS="TITLE"><A NAME="MIDIData_OtherFunctionTable">▼Table2-12.MIDIData_その他の関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_CountTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_CountTrack (MIDIData* pMIDIData);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ</TD>
  <TD>MIDIトラック数</TD>
  <TD>指定したMIDIデータに含まれるMIDIトラックの数を数える。また、<A HREF="#MIDIData_FieldTable">m_lNumTrack</A>の値を更新する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_TimeToMillisec"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_TimeToMillisec (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:時刻</TD>
  <TD>ミリ秒単位の時刻</TD>
  <TD>lTimeで示される時刻から、ミリ秒単位の時刻を計算して取得する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を使って計算する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_MillisecToTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_MillisecToTime (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lMillisec);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lMillisec:ミリ秒単位の時刻</TD>
  <TD>ティック単位の時刻(TPQNベースの場合)<BR>サブフレーム単位の時刻(SMPTEベースの場合)</TD>
  <TD>lMillisecで示されるミリ秒単位の時刻から、ティック単位の時刻(TPQNベースの場合)又はサブフレーム単位の時刻(SMPTEベースの場合)を取得する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を使って計算する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_MakeTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_MakeTime (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lMeasure, <SPAN CLASS="KEYWORD">long</SPAN> lBeat, <SPAN CLASS="KEYWORD">long</SPAN> lTick, <SPAN CLASS="KEYWORD">long</SPAN>* pTime);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lMeasure:小節番号(0オリジン)<BR>lBeat:拍番号(0オリジン)<BR>lTick:ティック番号(0オリジン)<BR>pTime:累積ティック単位のタイムを格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>MIDIデータのタイムモードがTPQNベースの場合、小節：拍：ティックで表されるタイムから、累積ティック単位のタイムを計算してバッファに格納する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索して計算する。MIDIデータのタイムモードがSMPTEベースの場合、フレーム：サブフレームで表されるタイムから、累積サブフレーム単位のタイムを計算してバッファに格納する。lMeasureにはフレーム番号を、lTickにはサブフレーム番号を指定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_MakeTimeEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_MakeTimeEx (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lMeasure, <SPAN CLASS="KEYWORD">long</SPAN> lBeat, <SPAN CLASS="KEYWORD">long</SPAN> lTick, <SPAN CLASS="KEYWORD">long</SPAN>* pTime, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lMeasure:小節番号(0オリジン)<BR>lBeat:拍番号(0オリジン)<BR>lTick:ティック番号(0オリジン)<BR>pTime:累積ティック単位のタイムを格納するバッファ<BR>pnn：最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分子を格納するバッファ<BR>pdd:最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分母の指数部分を格納するバッファ<BR>pcc:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照<BR>pbb:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>この関数は<A HREF="#MIDIData_MakeTime">MIDIData_MakeTime</A>と変わらないが、同時に指定時刻における拍子記号情報を得ることができる。それに伴うオーバーヘッドは無視できるほど小さい。タイムモードがSMPTEベースの場合、拍子記号情報を得ることはできない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_BreakTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_BreakTime (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pMeasure, <SPAN CLASS="KEYWORD">long</SPAN>* pBeat, <SPAN CLASS="KEYWORD">long</SPAN>* pTick);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:分解すべき累積タイム<BR>pMeasure:小節番号(0オリジン)を格納するバッファ<BR>pBeat:拍番号(0オリジン)を格納するバッファ<BR>pTick:ティック番号(0オリジン)を格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>MIDIデータのタイムモードがTPQNベースの場合、累積ティック単位のタイムから、小節：拍：ティックで表されるタイムを計算してバッファに格納する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索して計算する。MIDIデータのタイムモードがSMPTEベースの場合、指定したタイムから、フレーム番号とサブフレーム番号(0以上(分解能-1)以下)を計算してバッファに格納する。フレーム番号はpMeasureに、サブフレーム番号はpTickに格納され、pBeatは常に0となる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_BreakTimeEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_BreakTimeEx (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pMeasure, <SPAN CLASS="KEYWORD">long</SPAN>* pBeat, <SPAN CLASS="KEYWORD">long</SPAN>* pTick, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:分解すべき累積タイム<BR>pMeasure:小節番号(0オリジン)を格納するバッファ<BR>pBeat:拍番号(0オリジン)を格納するバッファ<BR>pTick:ティック番号(0オリジン)を格納するバッファ<BR>pnn：最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分子を格納するバッファ<BR>pdd:最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分母の指数部分を格納するバッファ<BR>pcc:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照<BR>pbb:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>この関数は<A HREF="#MIDIData_BreakTime">MIDIData_BreakTime</A>と変わらないが、同時に指定時刻における拍子記号情報を得ることができる。それに伴うオーバーヘッドは無視できるほど小さい。タイムモードがSMPTEベースの場合、拍子記号情報は得られない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_FindTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_FindTempo (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pTempo);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:時刻<BR>pTempo:テンポを格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおけるテンポ(lTimeにテンポイベントがない場合は直前のテンポ)を調べ、バッファに格納する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を探索する。<SPAN CLASS="RED">テンポの単位は4分音符あたりのマイクロ秒[μ秒／4分音符]である。</SPAN>テンポイベントが指定時刻までに存在しない場合は、デフォルト値として、500000[μ秒／4分音符]が返される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_FindTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_FindTimeSignature (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:時刻<BR>pnn:分子を格納するバッファへのポインタ<BR>pdd:分母を格納するバッファへのポインタ<BR>pcc:1拍あたりのMIDIクロック数を格納するバッファへのポインタ<BR>pbb:1拍当たりの32分音符の数を格納するバッファへのポインタ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおける拍子記号(lTimeに拍子記号イベントがない場合は直前の拍子記号)を調べ、バッファに格納する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索する。pnnの指す値は拍子記号の分子を表す。pddの指す値は拍子記号の分母が2の何乗にであるかを表す。pccの指す値は1拍あたりのMIDIクロック数を表す。pbbの指す値は1拍の長さを32分音符の数で表す。拍子記号イベントが指定時刻までに存在しない場合は、デフォルト値として、4分の4拍子・24クロック・8個とみなされる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIData_FindKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIData_FindKeySignature (MIDIData* pMIDIData, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* psf, <SPAN CLASS="KEYWORD">long</SPAN>* pmi);</A></TD>
  <TD>pMIDIData:MIDIデータへのポインタ<BR>lTime:時刻<BR>psf:#又は♭の数を格納するバッファへのポインタ<BR>pmi:長調か短調かを格納するバッファへのポインタ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおける調性記号(lTimeに調性記号イベントがない場合は直前の調性記号)を調べ、バッファに格納する。この関数は、最初のMIDIトラックのみに含まれる<A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>を探索する。psfの指す値は正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。pmiの指す値はMIDIEVENT_KEYMAJOR(0)かMIDIEVENT_KEYMINOR(1)のいずれかである。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIData_forEachTrack">2-13.MIDIデータ内の各トラックへのアクセス</A></H3>

<P>　MIDIデータ内の各トラックへアクセスする方法として、便利なforEachTrackマクロとforEachTrackInverseマクロを用意している。これらのマクロは、MIDIデータ内の全トラックを順番に評価するforループの一種である。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_forEachTrackList1">▼List2-13-1.forEachTrack系マクロの使い方</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDIData* pMIDIData;
	MIDITrack* pMIDITrack;
	...
	<SPAN CLASS="COMMENT">/* MIDIデータの各トラックの名前を順次出力 */</SPAN>
	forEachTrack (pMIDIData, pMIDITrack) {
		printf (<SPAN CLASS="STRING">"トラック名：%s\n"</SPAN>, MIDITrack_GetName (pMIDITrack, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
	}
</PRE>

<P>　上のプログラムは、次のwhileループを使ったプログラムと等価である。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_forEachTrackList2">▼List2-13-2.forEachTrackに等価なプログラム</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDIData* pMIDIData;
	MIDITrack* pMIDITrack;
	...
	<SPAN CLASS="COMMENT">/* MIDIデータの各トラックの名前を順次出力 */</SPAN>
	pMIDITrack = pMIDIData-&gt;m_pFirstData;
	<SPAN CLASS="KEYWORD">while</SPAN> (pMIDITrack) {
		printf (<SPAN CLASS="STRING">"トラック名：%s\n"</SPAN>, MIDITrack_GetName (pMIDITrack, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
		pMIDITrack = pMIDITrack-&gt;m_pNextTrack;
	}
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_forEachTrackTable">▼Table2-13.forEachTrack系マクロ</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="40%">マクロ</TH>
  <TH WIDTH="60%">意味</TH>
 </TR>
 <TR>
  <TD><A NAME="forEachTrack"></A>forEachTrack (pMIDIData, pMIDITrack) {<BR>	...<BR>}</TD>
  <TD>pMIDIData内のトラックを最初から順番に評価する。pMIDITrackには最初のトラックへのポインタ、その次のトラックへのポインタ、その次のトラックへのポインタ……といった具合に代入される。</TD>
 </TR>
 <TR>
  <TD><A NAME="forEachInverse"></A>forEachTrackInverse (pMIDIData, pMIDITrack) {<BR>	...<BR>}</TD>
  <TD>pMIDIData内のトラックを最後から順番に評価する。pMIDITrackには最後のトラックへのポインタ、その前のトラックへのポインタ、その前のトラックへのポインタ……といった具合に代入される。</TD>
 </TR>
</TABLE>

<P>　<SPAN CLASS="RED">forEachTrack内ではトラックを追加してはならない。forEachTrack内でをトラックを追加した場合、次のトラックへのポインタが書き換えられ、ループを脱出できなくなることがある。必要であれば、まず最初にローカル配列に全トラックのポインタをコピーし、ローカル配列のポインタを用いてトラックを追加するべきである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_forEachTrackList3">▼List2-13-3.forEachTrack内でトラックを追加(悪い例)</A></DIV>
<PRE>
	...
	forEachTrack (pMIDIData, pMIDITrack) {
		pNewTrack = MIDITrack_Create ();
		MIDIData_InsertTrackAfter (pMIDIData, pNewTrack, pMIDITrack);
	}
</PRE>

<P>　<SPAN CLASS="RED">　一方、forEachTrack内でトラックを除外又は削除してはならない。トラックの消滅により、次のトラックが探索できなくなるからだ。必要であれば、まず最初にローカル配列に全トラックのポインタをコピーし、ローカル配列のポインタを用いてトラックを除外又は削除するべきである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIData_forEachTrackList6">▼List2-12-6.forEachTrack内でトラックを削除(悪い例)</A></DIV>
<PRE>
	...
	forEachTrack (pMIDIData, pMIDITrack) {
		MIDITrack_Delete (pMIDITrack);
	}
</PRE>

<P></P>




<H2><A NAME="MIDITrack">第3章：MIDIトラック</A></H2>

<H3><A NAME="MIDITrack_Struct">3-1.MIDIトラックの構造</A></H3>

<P>　MIDIトラックは、単数又は複数の<A HREF="#MIDIEvent">MIDIイベント</A>を子に持つ。MIDIトラック内のMIDIイベントは常に時間順に整列されている。トラック内の最初のイベントは、<A HREF="#MIDIEvent_TrackName">トラック名(シーケンス名)</A>であることが推奨される。一方、トラック内の最後のイベントは<A HREF="#MIDIEvent_EndofTrack">EOT(エンドオブトラック)</A>でなければならない。</P>

<P>　<A HREF="#MIDIData_FormatTable">フォーマット0</A>又は<A HREF="#MIDIData_FormatTable">フォーマット2</A>のMIDIデータの場合、MIDIトラックには、あらゆる種類の<A HREF="#MIDIEvent">MIDIイベント</A>を含めることができる。<A HREF="#MIDIData_FormatTable">フォーマット1</A>のMIDIデータの場合、最初のMIDIトラックは<A HREF="#MIDITrack_SetupTrack">コンダクタートラック</A>と呼ばれ、<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_Tempo">テンポ</A>・<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>・<A HREF="#MIDIEvent_TimeSignature">拍子</A>・<A HREF="#MIDIEvent_KeySignature">調性</A>イベントなどを入れる。ノートオンなどの<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>は、2番目以降のMIDIトラックに入れなければならない。また、ひとつのトラックに複数チャンネルのイベントを混入させてはならない。</P>

<P>　また、MIDIトラックは、双方向リンクリストの要素であり、次のMIDIトラックと前のMIDIトラックへのポインタを保持している。ただし、<A HREF="#MIDIData_FormatTable">フォーマット0</A>のMIDIデータの場合、トラック数は必ず1つしかないので、次のMIDIトラックと前のMIDIトラックは存在しない。</P>

<P>　次にMIDITrack構造体のメンバ変数を示す。これらのメンバ変数を直接参照することは安全であるが、直接操作することは整合性やメモリ管理の点において大変危険である。特殊な理由がない限り<A HREF="#MIDITrack_GetFunction">MIDITrack_Get系関数</A>と<A HREF="#MIDITrack_SetFunction">MIDITrack_Set系関数</A>を介してアクセスすることを推奨する。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_FieldTable">▼Table3-1.MIDIトラック構造体のメンバ変数と使い方</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">メンバ変数</TH>
  <TH WIDTH="75%">使い方</TH>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lNumEvent</TD>
  <TD>このトラックに含まれるMIDIイベントの数。<A HREF="#MIDITrack_CountEvent">MIDITrack_CountEvent</A>関数を使うと更新される。</TD>
 </TR>
 <TR>
  <TD>MIDITrack* m_pNextTrack</TD>
  <TD>次のトラックへのポインタ。次のトラックがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDITrack* m_pPrevTrack</TD>
  <TD>前のトラックへのポインタ。前のトラックがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pFirstEvent</TD>
  <TD>このトラック内にある最初の<A HREF="#MIDIEvent">MIDIイベント</A>へのポインタ。最初のMIDIイベントがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pLastEvent</TD>
  <TD>このトラック内にある最後の<A HREF="#MIDIEvent">MIDIイベント</A>へのポインタ。最後のMIDIイベントがなければNULL。なお、スタンダードMIDIファイル(*.mid)におけるMIDIトラック内の最後のイベントは<A HREF="#MIDIEvent_EndofTrack">EOT(エンドオブトラック)イベント</A>であり、このイベントを省略することは許されていない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">void</SPAN>* m_pParent</TD>
  <TD>親へのポインタ。通常このトラックが含まれる<A HREF="#MIDIData">MIDIデータ</A>へのポインタである。親がない場合はNULL。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lInputOn</TD>
  <TD>入力(0=OFF, 1=ON)。下位1ビットのみ使用。他のビットは未定義。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとに入力ミュートできる機能を持っているならば、この値が0になっているトラックは、MIDIメッセージを入力するべきではない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lInputPort</TD>
  <TD>入力ポート(0〜255)。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションが複数の入力ポートに対応しているならば、このトラックのMIDIイベントは、この値が指定する番号のポートから入力されるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lInputChannel</TD>
  <TD>入力チャンネル(-1=n/a, 0〜15)。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとの入力チャンネル設定に対応しているならば、このトラックのMIDIチャンネルイベントは、この値が指定する番号のチャンネル番号のもののみを入力するべきである。入力チャンネルが-1の時は、システムエクスクルーシヴイベントのみを入力するべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lOutputOn</TD>
  <TD>出力(0=OFF, 1=ON)。下位1ビットのみ使用。他のビットは未定義。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとに出力ミュートできる機能を持っているならば、この値が0になっているトラックは、MIDIメッセージを出力するべきではない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lOutputPort</TD>
  <TD>出力ポート(0〜255)。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションが複数の出力ポートに対応しているならば、このトラックのMIDIイベントは、この値が指定する番号のポートに出力されるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lOutputChannel</TD>
  <TD>出力チャンネル(-1=n/a, 0〜15)。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとの出力チャンネル設定に対応しているならば、このトラックのMIDIチャンネルイベントは、この値が指定する番号のチャンネル番号として出力されるべきである(出力チャンネルが-1の場合を除く)。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lTimePlus</TD>
  <TD>タイム+。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとのタイムシフトに対応しているならば、このトラックのイベントは、この値が指定するティック数だけ遅れて解釈又は出力されるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lKeyPlus</TD>
  <TD>キー+。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとのキーシフトに対応しているならば、このトラックのノートイベント及びキーアフタータッチは、この値が指定する半音数だけ上げて出力されるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lVelocityPlus</TD>
  <TD>ベロシティ+。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとのベロシティシフトに対応しているならば、このトラックのノートオンイベント(ベロシティが0のものを除く)は、この値が指定するベロシティ量だけ加算して出力されるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lViewMode</TD>
  <TD>表示モード(0=通常、1=ドラム)。下位1ビットのみ使用。他のビットは未定義。これはあくまで表示上の設定であり、実際に通常音色で演奏されるかドラム音色で演奏されるかは、トラック内のMIDIイベントによって決定される。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションが通常トラックとドラムトラックで異なる表示方法をとるのであれば、その表示方法はこの値によるべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lForeColor</TD>
  <TD>前景色。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとに前景色を色分けして表示する機能をもっているならば、このトラックの前景色はこの値が示す色を使うべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lBackColor</TD>
  <TD>背景色。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。アプリケーションがトラックごとに背景色を色分けして表示する機能をもっているならば、このトラックの背景色はこの値が示す色を使うべきである。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser1</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その1。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser2</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その2。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser3</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その3。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUserFlag</TD>
  <TD>ユーザーが自由に使うことのできるフラグのための拡張領域。例えば、選択/非選択・可視/不可視・フィルタリング中・編集ロック中などの状態を保持する。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_Status">3-2.MIDIトラックの状態</A></H3>

<H4><A NAME="MIDITrack_FloatTrack">浮遊トラック</A></H4>

<P>　どのMIDIデータにも属していないMIDIトラックを浮遊トラックという。浮遊トラックでは、m_pNextTrack=NULL, m_pPrevTrack=NULL, m_pParent=NULLとなっている。MIDIトラックが浮遊しているかどうかは、<A HREF="#MIDITrack_IsFloating">MIDITrack_IsFloating</A>で調べられる。</P>

<H4><A NAME="MIDITrack_SetupTrack">コンダクタートラック</A></H4>

<P>　<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータにおける最初のトラックを、コンダクタートラックという。コンダクタートラックは、主に<A HREF="#MIDIEvent_Marker">マーカー</A>、<A HREF="#MIDIEvent_CuePoint">キューポイント</A>、<A HREF="#MIDIEvent_Tempo">テンポ</A>、<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>、<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>、<A HREF="#MIDIEvent_KeySignature">調整記号</A>などのイベントと、音源調整のための<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシヴイベント</A>を入れる。コンダクタートラックには、ノートオンなどの<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>を入れてはならない。</P>

<P>　MIDIトラックがコンダクタートラックとしての条件を満たしているかどうかは、<A HREF="#MIDITrack_CheckSetupTrack">MIDITrack_CheckSetupTrack</A>で調べられる。</P>

<H4><A NAME="MIDITrack_NonSetupTrack">非コンダクタートラック</A></H4>

<P>　<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータにおける2番目以降のトラックを、非コンダクタートラックという。非コンダクタートラックは、ノートオンなどの<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>を入れる。非コンダクタートラックには、<A HREF="#MIDIEvent_Tempo">テンポ</A>、<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>、<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>、<A HREF="#MIDIEvent_KeySignature">調整記号</A>を入れてはならない。</P>

<P>　MIDIトラックが非コンダクタートラックとしての条件を満たしているかどうかは、<A HREF="#MIDITrack_CheckSetupTrack">MIDITrack_CheckNonSetupTrack</A>で調べられる。</P>

<H3><A NAME="MIDITrack_CreateFunction">3-3.MIDIトラックの生成</A></H3>

<P>　MIDIトラックを新規に生成するには、MIDITrack_Create系関数を使う。生成直後のトラックには、何のイベントも含まれていない。少なくともエンドオブトラックイベントを挿入するのはプログラマの責任である。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_CreateFunctionList">▼List3-3.MIDITrack_Create系関数の使い方</A></DIV>
<PRE>
	MIDITrack* pMIDITrack;
	<SPAN CLASS="COMMENT">/* MIDIトラックの生成 */</SPAN>
	pMIDITrack = MIDITrack_Create ();
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDITrack == NULL) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIトラックの生成に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_CreateFunctionTable">▼Table3-3.MIDITrack_Create系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_Create">MIDITrack* MIDITrack_Create <BR>();</A> </TD>
  <TD>なし</TD>
  <TD>正常終了:MIDIトラックへのポインタ<BR>異常終了:NULL</TD>
  <TD>MIDIトラックを新規に生成する。生成直後のトラックには、何のイベントも含まれていない。少なくとも<A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>を挿入するのは、プログラマの責任である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_CreateClone">MIDITrack* MIDITrack_CreateClone <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack : 複製元トラックへのポインタ</TD>
  <TD>正常終了:複製したMIDIトラックへのポインタ<BR>異常終了:NULL</TD>
  <TD>既存のMIDIトラックを複製して新しいMIDIトラックを生成する。生成直後のトラックには、複製元トラックと同じMIDIイベントの複製が含まれている。新しいMIDIトラックは浮遊状態であり、どのMIDIDataにも属していない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_DeleteFunction">3-4.MIDIトラックの削除</A></H3>

<P>　MIDIトラックを削除するには、MIDITrack_Delete系関数を使う。</P>

<P><SPAN CLASS="RED">　<A HREF="#MIDITrack_CreateFunction">MIDITrack_Create系関数</A>で生成したMIDIトラックは、使用し終わったらMIDITrack_Delete系関数でメモリ上から削除しなければならない。</SPAN>さもなければ、メモリリークが発生するであろう。ただし、親のMIDIデータに<A HREF="#MIDIData_DeleteFunction">MIDIData_Delete系関数</A>を使った場合はこの限りではない。</P>

<P><SPAN CLASS="RED">　MIDIトラックを削除した直後には、ポインタにNULLを代入しておくべきである。</SPAN>これをしなければ、このMIDIトラックが既に削除されていることが外部からわからなくなってしまい、バグの原因となりうる。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_DeleteFunctionList">▼List3-4.MIDITrack_Delete系関数の使い方</A></DIV>
<PRE>
	...
	<SPAN CLASS="COMMENT">/* MIDIトラックの削除 */</SPAN>
	MIDITrack_Delete (pMIDITrack);
	pMIDITrack = NULL;
</PRE>

<P></P>


<DIV CLASS="TITLE"><A NAME="MIDITrack_DeleteFunctionTable">▼Table3-4.MIDITrack_Delete系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_Delete"><SPAN CLASS="KEYWORD">void</SPAN> MIDITrack_Delete <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>なし</TD>
  <TD>MIDIトラックをメモリ上から削除する。<SPAN CLASS="RED">この関数は、MIDIトラック内に含まれる全MIDIイベントを自動的に削除する。</SPAN>指定したMIDIトラックがMIDIデータに属している場合、前後の要素のポインタをつなぎ替え、親のMIDIデータのトラック状態を正常に保つ。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_InsertEventFunction">3-5.MIDIトラックへのイベント挿入</A></H3>

<P>　MIDIトラックにイベントを挿入するには、MIDITrack_InsertEvent系関数を使う。</P>

<P>　MIDIDataライブラリでは、メモリの許す限りトラックに無制限にMIDIイベントを追加することができる。しかし、現実的には1トラックあたり65536イベント程度までが常用範囲である。</P>

<P>　MIDIイベントは、0以上の時刻かつ<A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>の前に挿入しなければならない。MIDIDataライブラリでは、エンドオブトラックイベントより後にイベントを挿入した場合、エンドオブトラックイベントはトラックの一番最後に自動的に移動されるようにできている。</P>

<P>　<SPAN CLASS="RED">MIDIイベントの挿入位置は、MIDIイベントの時刻により自動決定される。同時刻のイベントがあった場合には、同時刻イベントの末尾に挿入される。この関数は、後方から挿入位置を探索するため、最後に近いイベントほど高速に挿入される。最後以外の位置に挿入される場合、トラックに含まれるイベントが多いほど、また挿入位置が最初に近いほど、挿入に時間がかかる。</SPAN>このように設計した理由は、高速性を要求されるリアルタイム入力の場合、多くの場合はトラックの最後にイベントが挿入されるからである。一方、トラックの最後以外にイベントを挿入するのは、ピアノロールやイベントリストなど、低速でもよい場合が多い。</P>

<P>　いずれの関数も挿入に失敗した場合0を返す。0を返すのは、時刻が不正である、引数が不正である、挿入しようとしているイベントが既にどこかのトラックに属している、挿入しようとしているイベントの種類が不正である(フォーマット1のMIDIデータの場合)、エンドオブトラックを二重に挿入しようとしている、メモリ不足であるなどが考えられる。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_InsertFunctionList">▼List3-5.MIDITrack_InsertEvent系関数の使い方</A></DIV>
<PRE>
	MIDITrack* pMIDITrack = MIDITrack_Create ();
	...
	<SPAN CLASS="COMMENT">/* プログラムチェンジイベントを挿入 */</SPAN>
	MIDITrack_InsertProgramChange (pMIDITrack, 0, 0, 0); <SPAN CLASS="COMMENT">/* Piano1 */</SPAN>
	<SPAN CLASS="COMMENT">/* ノートイベントを挿入            Time  ch  key  vel  dur */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,     0,  0,  60, 100, 120); <SPAN CLASS="COMMENT">/* ど */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   120,  0,  62, 100, 120); <SPAN CLASS="COMMENT">/* れ */</SPAN>
	MIDITrack_InsertNote (pMIDITrack,   240,  0,  64, 100, 240); <SPAN CLASS="COMMENT">/* みー */</SPAN>
	...
	<SPAN CLASS="COMMENT">/* エンドオブトラックを挿入 */</SPAN>
	MIDITrack_InsertEndofTrack (pMIDITrack, 480);
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_InsertFunctionTable">▼Table3-5.MIDITrack_InsertEvent系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertEvent <BR>(MIDITrack* pMIDITrack, MIDIEvent* pMIDIEvent);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pMIDIEvent:挿入するイベントへのポインタ</TD>
  <TD>正常終了:挿入したイベントの数(1以上)<BR>異常終了:0</TD>
  <TD>MIDIトラックに任意のイベントを挿入する。挿入位置は、イベントの時刻により自動決定される。同時刻に他のイベントがある場合は、同時刻の他のイベントの最後に挿入される。ただし、ノートオフイベントの場合は、同時刻のノートオフイベントの直後に挿入される(ノートオフイベント優先の法則)。ただし、ノートオフに対応するノートオンよりも前に挿入されることはない。pMIDIEventが結合イベントの時、結合しているイベントがすべて挿入され、2以上の値を返す。1つでも挿入に失敗した場合は、既に挿入したイベントを取り除き、0を返す。この関数は、pMIDITrack内に既に大量のイベントがある場合(特にSMFフォーマット0の場合)、挿入するのにやや時間がかかることがある。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertEventBefore"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertEventBefore <BR>(MIDITrack* pMIDITrack, MIDIEvent* pMIDIEvent, MIDIEvent* pTarget);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pMIDIEvent:挿入するイベントへのポインタ<BR>pTarget:挿入位置指定用ターゲットイベントへのポインタ</TD>
  <TD>正常終了:挿入したイベントの数(1以上)<BR>異常終了:0</TD>
  <TD>MIDIトラックに任意のイベントを挿入する。挿入位置はターゲットイベントの直前である。時刻の整合性がとれていない場合、挿入するイベントの時刻が自動的に変更される。この関数は、挿入位置の探索を行わないため、MIDITrack_InsertEventに比べて高速である。pMIDIEventが結合イベントの時、結合しているイベントがすべて挿入され、2以上の値を返す。1つでも挿入に失敗した場合は、既に挿入したイベントを取り除き、0を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertEventAfter"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertEventAfter <BR>(MIDITrack* pMIDITrack, MIDIEvent* pMIDIEvent, MIDIEvent* pTarget);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pMIDIEvent:挿入するイベントへのポインタ<BR>pTarget:挿入位置指定用ターゲットイベントへのポインタ</TD>
  <TD>正常終了:挿入したイベントの数(1以上)<BR>異常終了:0</TD>
  <TD>MIDIトラックに任意のイベントを挿入する。挿入位置はターゲットイベントの直後である。時刻の整合性がとれていない場合、挿入するイベントの時刻が自動的に変更される。この関数は、挿入位置の探索を行わないため、MIDITrack_InsertEventに比べて高速である。pMIDIEventが結合イベントの時、結合しているイベントがすべて挿入され、2以上の値を返す。1つでも挿入に失敗した場合は、既に挿入したイベントを取り除き、0を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertSequenceNumber"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertSequenceNumber <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lNum:シーケンス番号(0〜65535)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_SequenceNumber">シーケンス番号イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTextEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTextEvent <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_TextEvent">テキストイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertTextEventExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTextEventEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTextEventEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_TextEvent">テキストイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のテキストイベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertCopyrightNotice"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertCopyrightNotice <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertCopyrightNoticeExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertCopyrightNoticeEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertCopyrightNoticeEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近の著作権イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTrackName"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTrackName <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_TrackName">シーケンス名・トラック名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertTrackNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTrackNameEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTrackNameEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_TrackName">シーケンス名・トラック名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のシーケンス名・トラック名イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertInstrumentName"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertInstrumentName <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertInstrumentNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertInstrumentNameEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertInstrumentNameEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のインストゥルメント名イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertLyric"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertLyric <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_Lyric">歌詞イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertLyricExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertLyricEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertLyricEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_Lyric">歌詞イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近の歌詞イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertMarker"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertMarker <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_Marker">マーカーイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertMarkerExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertMarkerEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertMarkerEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_Marker">マーカーイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のマーカーイベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertCuePoint"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertCuePoint <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_CuePoint">キューポイントイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertCuePointExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertCuePointEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertCuePointEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_CuePoint">キューポイントイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のキューポイントイベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertProgramName"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertProgramName <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ProgramName">プログラム名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertProgramNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertProgramNameEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertProgramNameEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_ProgramName">プログラム名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のプログラム名イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertDeviceName"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertDeviceName <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。これはMIDITrack_InsertDeviceNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertDeviceNameEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertDeviceNameEx <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子が付与される。MIDIEVENT_NOCHARCODEが指定された場合は、直近のデバイス名イベントに基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertChannelPrefix"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertChannelPrefix <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lNum:チャンネル番号(0〜15)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックスイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertPortPrefix"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertPortPrefix <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lNum:ポート番号(0〜255)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_PortPrefix">ポートプリフィックスイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertEndofTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertEndofTrack <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>を生成し、指定トラックに挿入する。<SPAN CLASS="RED">挿入位置は、lTimeが指定トラックの最後のイベントより前の場合、lTimeは自動的に最後のイベントと同じ値に変更され、トラックの最後に挿入される。</SPAN>その他の場合は、lTimeの値はそのままでトラックの最後に挿入する。<SPAN CLASS="RED">既にエンドオブトラックイベントを持つトラックに対してこの関数を使うと0を返し、何も起こらない。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTempo <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lTempo);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lTempo:テンポ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_Tempo">テンポイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、pMIDITrackは最初のトラックでなければならない。</SPAN><SPAN CLASS="RED">lTempoの単位は4分音符あたりのマイクロ秒[μ秒／4分音符]である。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertSMPTEOffset"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertSMPTEOffset <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lMode, <SPAN CLASS="KEYWORD">long</SPAN> lHour, <SPAN CLASS="KEYWORD">long</SPAN> lMin, <SPAN CLASS="KEYWORD">long</SPAN> lSec, <SPAN CLASS="KEYWORD">long</SPAN> lFrame, <SPAN CLASS="KEYWORD">long</SPAN> lSubFrame);</A></TD>
  <TD>lTime:絶対時刻<BR>lMode:モード(0〜3)<BR>lHour:時間(0〜23)<BR>lMin:分(0〜59)<BR>lSec:秒(0〜59)<BR>lFrame:フレーム(0〜30※)<BR>lSubFrame:サブフレーム(0〜99)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセットイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、pMIDITrackは最初のトラックでなければならない。</SPAN><SPAN CLASS="RED">lTimeの値は、0でなければならない。</SPAN>lModeは、MIDIEVENT_SMPTE24(0)・MIDIEVENT_SMPTE25(1)・MIDIEVENT_SMPTE30D(2)・MIDIEVENT_SMPTE30N(3)のいずれかでなければならない。lFrameの値は、lModeが示すフレーム数未満でなければならない。lSubFrameの値は、<A HREF="#MIDIData_TimeBase">タイムベース</A>に関係なく1/100フレーム単位である。<SPAN CLASS="RED">既にSMPTEオフセットをもつMIDIトラックに対して、この関数を使ってはならない。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertTimeSignature <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lnn, <SPAN CLASS="KEYWORD">long</SPAN> ldd, <SPAN CLASS="KEYWORD">long</SPAN> lcc, <SPAN CLASS="KEYWORD">long</SPAN> lbb);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lnn:分子<BR>ldd:分母の2の指数<BR>lcc:1拍あたりのMIDIクロック数<BR>lbb:1拍あたりの32分音符の数</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、pMIDITrackは最初のトラックでなければならない。</SPAN>lnnは拍子記号の分子を指定する。lddは拍子記号の分母が2の何乗にであるかを指定する。lccは1拍あたりのMIDIクロック数(通常24)を指定する。lbbは1拍の当たりの32分音符の数(通常8)を指定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertKeySignature <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lsf, <SPAN CLASS="KEYWORD">long</SPAN> lmi);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lsf:#又は♭の数(-7〜+7)<BR>lmi:長調・短調を示す値(0〜1)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、pMIDITrackは最初のトラックでなければならない。</SPAN>。lsfは正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。lmiはMIDIEVENT_KEYMAJOR(=0)かMIDIEVENT_KEYMINOR(=1)のいずれかでなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertSequencerSpecific"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertSequencerSpecific <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, char* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pBuf:データ部へのポインタ<BR>lLen:データ部の長さ[バイト]</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_SequencerSpecific">シーケンサー独自のイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。データ部の1バイト目はメーカー名を表す識別番号でなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertNoteOff"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertNoteOff <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVel:ベロシティ(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。ノートオンイベントとノートオフイベントの両方を生成する場合は、<A HREF="#MIDITrack_InsertNote">MIDITrack_InsertNote</A>を使うべきである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertNoteOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertNoteOn <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVel:ベロシティ(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。ベロシティが0のノートオンイベントはノートオフイベントの代用にできる。ノートオンイベントとノートオフイベントの両方を生成する場合は、<A HREF="#MIDITrack_InsertNote">MIDITrack_InsertNote</A>を使うべきである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertKeyAftertouch"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertKeyAftertouch <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertControlChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertControlChange <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lNum, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lNum:コントロールナンバー(0〜127)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertProgramChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertProgramChange <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lNum:プログラムナンバー(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ProgramChange">プログラムチェンジイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertChannelAftertouch"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertChannelAftertouch <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertPitchBend"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertPitchBend <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lVal:値(0〜16383)</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_PitchBend">ピッチベンドイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。値は8192が中央であることに注意。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertSysExEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertSysExEvent <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">unsigned char</SPAN>* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>pBuf:データ部へのポインタ<BR>lLen:データ部の長さ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A>を生成し、指定トラックに挿入する。挿入位置は時刻により自動決定する。データ部は通常、0xF0で始まり、0xF7で終わらなければならないが、長いシステムエクスクルーシブデータを複数のイベントに分割する場合はこの限りでない。<A HREF="#MIDIEvent_SysExTable">SysExイベントの種類</A>が0xF0になるか0xF7になるかは、データ部の先頭バイトの値によって自動的に判別される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertNote"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertNote <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel, <SPAN CLASS="KEYWORD">long</SPAN> lDur);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー番号(0〜127)<BR>lVel:ノートオンイベントのベロシティ<BR>lDur:長さ</TD>
  <TD>正常終了：2<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>、<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>の2つのイベントを生成し、指定トラックに挿入する。生成された2つのイベントは自動的に<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>になる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertPatchChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertPatchChange <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC0, <SPAN CLASS="KEYWORD">long</SPAN> lCC32, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A><BR>(※非推奨)</TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC0:CC#0(Bank Select MSB)の値(0〜127)<BR>lCC32:CC#32(Bank Select LSB)の値(0〜127)<BR>lNum:パッチ番号(0〜127)</TD>
  <TD>正常終了：3又は4<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#0(Bank Select MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#32(Bank Select LSB)</A>、<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>の3つのイベントを生成し、指定トラックに挿入する。生成された3つのイベントは自動的に<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>になる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertRPNChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertRPNChange <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC101, <SPAN CLASS="KEYWORD">long</SPAN> lCC100, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A><BR>(※非推奨)</TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC101:CC#101(RPN MSB)の値(0〜127)<BR>lCC100:CC#100(RPN LSB)の値(0〜127)<BR>lVal:設定値(0〜127)</TD>
  <TD>正常終了：3又は4<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#101(RPN MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#100(RPN LSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#6(Data Entry)</A>の3つのイベントを生成し、指定トラックに挿入する。生成された3つのイベント自動的に<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>になる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_InsertNRPNChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_InsertNRPNChange <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC99, <SPAN CLASS="KEYWORD">long</SPAN> lCC98, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A><BR>(※非推奨)</TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC99:CC#99(NRPN MSB)の値(0〜127)<BR>lCC98:CC#98(NRPN LSB)の値(0〜127)<BR>lVal:設定値(0〜127)</TD>
  <TD>正常終了：3又は4<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#99(NRPN MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#98(NRPN LSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#6(Data Entry)</A>の3つのイベントを生成し、指定トラックに挿入する。生成された3つのイベント自動的に<A HREF="#MIDIEvent_CombinedEvent">結合状態</A>になる。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_RemoveEventFunction">3-6.MIDIトラックからイベントの除去</A></H3>

<P>　MIDIトラックからイベントを除去するには、MIDITrack_RemoveEvent系関数を使う。この関数は、イベントをMIDIトラックから除外するだけであり、イベント自体の削除は行わない。イベント自体をメモリ上から削除するには、<A HREF="#MIDIEvent_DeleteFunction">MIDIEvent_Delete系関数</A>を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDIData_RemoveTrackFunctionList">▼List3-6.MIDITrack_RemoveEvent系関数の使い方</A></DIV>
<PRE>
	<SPAN CLASS="COMMENT">/* トラック内の最初のイベントを除去 */</SPAN>
	MIDITrack_RemoveEvent (pMIDIData, pMIDITrack-&gt;m_pFirstEvent);
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_RemoveFunctionTable">▼Table3-6.MIDITrack_RemoveEvent系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_RemoveEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_RemoveEvent <BR>(MIDITrack* pMIDITrack, MIDIEvent* pMIDIEvent);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pMIDIEvent:トラックから除去するMIDIイベントへのポインタ</TD>
  <TD>正常終了：除外したイベントの数(1以上)<BR>異常終了：0</TD>
  <TD>MIDIトラックから指定のMIDIイベントを除外する。<SPAN CLASS="RED">指定MIDIイベントが他のMIDIイベントと結合している場合、結合しているMIDIイベントも同時に除外する。すなわち、2つ以上のMIDIイベントが除外されることがある。</SPAN>また、前後のMIDIイベントのポインタをつなぎ替え、MIDIトラック内の双方向リンクリストを正常に保つ。この関数は、MIDIイベント自体の削除は行わない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_RemoveSingleEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_RemoveSingleEvent <BR>(MIDITrack* pMIDITrack, MIDIEvent* pMIDIEvent);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pMIDIEvent:トラックから除去するMIDIイベントへのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>MIDIトラックから指定のMIDIイベントを除外する。<SPAN CLASS="RED">指定MIDIイベントが他のMIDIイベントと結合している場合、結合を切り離し、指定したMIDIイベントのみを除外する。すなわち、2つ以上のMIDIイベントが除外されることはない。</SPAN>また、前後のMIDIイベントのポインタをつなぎ替え、MIDIトラック内の双方向リンクリストを正常に保つ。この関数は、MIDIイベント自体の削除は行わない。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_IsFunction">3-7.MIDIトラックの状況取得</A></H3>

<P>　MIDIトラックの状態や種類を調べるには、MIDITrack_Is系関数を使う。MIDITrack_Is系関数は、「はい」のとき1を、「いいえ」とき0を返す。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_IsFunctionTable">▼Table3-7.MIDITrack_Is系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR CLASS="TITLE">
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_IsFloating"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_IsFloating <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>はい:1<BR>いいえ:0</TD>
  <TD>MIDIトラックが<A HREF="#MIDITrack_FloatTrack">浮遊トラック</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_CheckSetupTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_CheckSetupTrack <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>正しい:1<BR>正しくない:0</TD>
  <TD>MIDIトラックが<A HREF="#MIDITrack_SetupTrack">コンダクタートラック</A>として正しいことを確認する。コンダクタートラックの条件は、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>(イベントの種類で0x80〜0xEF)を含まないこと。<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータの最初のトラックは、コンダクタートラックでなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_CheckNonSetupTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_CheckNonSetupTrack <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>正しい:1<BR>正しくない:0</TD>
  <TD>MIDIトラックが<A HREF="#MIDITrack_NonSetupTrack">非コンダクタートラック</A>として正しいことを確認する。非コンダクタートラックの条件は、イベントの種類で0x50台のイベント(<A HREF="#MIDIEvent_Tempo">テンポ</A>・<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>・<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>・<A HREF="#MIDIEvent_KeySignature">調性記号</A>など)を含まないこと。<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータの2番目以降のトラックは、非コンダクタートラックでなければならない。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDITrack_GetFunction">3-8.MIDIトラックの情報取得</A></H3>

<P>　MIDIトラックの各種情報(プロパティ)を安全に取得するには、MIDITrack_Get系関数を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_GetFunctionTable">▼Table3-8.MIDITrack_Get系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetFirstEvent">MIDIEvent* MIDITrack_GetFirstEvent <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>最初のイベントへのポインタ</TD>
  <TD>最初のイベントへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetLastEvent">MIDIEvent* MIDITrack_GetLastEvent <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>最後のイベントへのポインタ</TD>
  <TD>最後のイベントへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetFirstKindEvent">MIDIEvent* MIDITrack_GetFirstKindEvent <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lKind);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lKind:イベントの種類を示す識別子</TD>
  <TD>トラック内にある最初の指定種類のイベントへのポインタ</TD>
  <TD>トラック内にある最初の指定種類のイベントへのポインタを返す。なければNULLを返す。例えば、lKindにMIDIEVENT_TEMPOを指定すれば、該当トラック内の最初のテンポイベントへのポインタが得られる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetLastKindEvent">MIDIEvent* MIDITrack_GetLastKindEvent <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lKind);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lKind:イベントの種類を示す識別子</TD>
  <TD>トラック内にある最後の指定種類のイベントへのポインタ</TD>
  <TD>トラック内にある最後の指定種類のイベントへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetPrevTrack">MIDITrack* MIDITrack_GetPrevTrack <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>前のトラックへのポインタ</TD>
  <TD>前のトラックへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetNextTrack">MIDITrack* MIDITrack_GetNextTrack <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>次のトラックへのポインタ</TD>
  <TD>次のトラックへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetParent">MIDIData* MIDITrack_GetParent <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>親MIDIデータへのポインタ</TD>
  <TD>親MIDIデータへのポインタを返す。なければNULLを返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetBeginTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetBeginTime <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>開始時刻</TD>
  <TD>指定トラックの開始時刻を返す。開始時刻とは、最初のイベントの時刻である。イベントが何もない場合、0を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetEndTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetEndTime <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>終了時刻</TD>
  <TD>指定トラックの終了時刻を返す。終了時刻とは、最後のイベントの時刻である。イベントが何もない場合、0を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetName">TCHAR* MIDITrack_GetName <BR>(MIDITrack* pMIDITrack, TCHAR* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pBuf:テキストを取り込むバッファへのポインタ<BR>lLen:取り込む最大文字数[文字]</TD>
  <TD>トラック名へのポインタ</TD>
  <TD>これは簡易にトラック名を取得するための関数である。トラック名をpBufに最大lLen文字格納し、その先頭ポインタを返す。取得されるのは、指定トラック内の最初の<A HREF="#MIDIEvent_TrackName">トラック名</A>イベントのテキストである。指定トラック内にトラック名イベントが無い場合、NULL文字を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetInputOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetInputOn <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>入力(0=OFF, 1=ON)</TD>
  <TD>入力(m_lInputOnの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetInputPort"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetInputPort <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>入力ポート(0〜255)</TD>
  <TD>入力ポート(m_lInputPortの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetInputChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetInputChannel <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>入力チャンネル(-1=n/a, 0〜15)</TD>
  <TD>入力チャンネル(m_lInputChannelの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetOutputOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetOutputOn <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>出力(0=OFF, 1=ON)</TD>
  <TD>出力(m_lOutputOnの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetOutputPort"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetOutputPort <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>出力ポート(0〜255)</TD>
  <TD>出力ポート(m_lOutputPortの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetOutputChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetOutputChannel <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>出力チャンネル(-1=n/a, 0〜15)</TD>
  <TD>出力チャンネル(m_lOutputChannelの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetTimePlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetTimePlus <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>タイム+</TD>
  <TD>タイム+(m_lTimePlusの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetKeyPlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetKeyPlus <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>キー+</TD>
  <TD>キー+(m_lKeyPlusの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetVelocityPlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetVelocityPlus <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>ベロシティ+</TD>
  <TD>ベロシティ+(m_lVelocityPlusの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetViewMode"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetViewMode <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>表示モード(0=通常, 1=ドラム)</TD>
  <TD>表示モード(m_lViewModeの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetForeColor"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetForeColor <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>前景色</TD>
  <TD>前景色(m_lForeColorの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetBackColor"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetBackColor <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>背景色</TD>
  <TD>背景色(m_lBackColorの値)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_GetXFVersion"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_GetXFVersion <BR>(MIDITrack* pMIDITrack);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ</TD>
  <TD>XFデータ(YAMAHAの拡張形式)のヴァージョン。XFデータでない場合は0。</TD>
  <TD>このMIDIトラックにXFデータ(YAMAHAの拡張形式)であることを示すシーケンサ独自のイベントが含まれている場合、XFのヴァージョンを取得する。具体的には、シーケンサ固有のイベントで、{43 7B 00 58 46 Mj Mn S1 S0} を探し、(Mj | (Mn &lt;&lt; 8) | (S1 &lt;&lt; 16) | (S0 &lt;&lt; 24)) を返す。XFデータでない場合は0を返す。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_SetFunction">3-9.MIDIトラックの情報設定</A></H3>

<P>　MIDIトラックの各種情報(プロパティ)を安全に設定するには、MIDITrack_Set系関数を使う。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_SetFunctionTable">▼Table3-9.MIDITrack_Set系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR CLASS="TITLE">
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetName"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetName <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>pszText:トラック名へのポインタ</TD>
  <TD>未定義</TD>
  <TD>これは簡易にトラック名を設定するための関数である。設定されるのは、指定トラック内の最初の<A HREF="#MIDIEvent_TrackName">トラック名</A>イベントである。トラック名イベントが無い場合は、時刻0の位置に自動的にトラック名イベントが追加される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetInputOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetInputOn <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lInputOn);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lInputOn:入力(0=OFF, 1=ON)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>入力(m_lInputOnの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetInputPort"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetInputPort <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lInputPort);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lInputPort:入力ポート(0〜255)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>入力ポート(m_lInputPortの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetInputChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetInputChannel <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lInputChannel);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lInputChannel:入力チャンネル(-1=n/a, 0〜15)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>入力チャンネル(m_lInputChannelの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetOutputOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetOutputOn <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lOutputOn);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lOutputOn:出力(0=OFF, 1=ON)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>出力(m_lInputOnの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetOutputPort"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetOutputPort <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lOutputPort);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lOutputPort:出力ポート(0〜255)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>出力ポート(m_lOutputPortの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetOutputChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetOutputChannel <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lOutputChannel);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lOutputChannel:出力チャンネル(-1=n/a, 0〜15)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>出力チャンネル(m_lOutputChannelの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetTimePlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetTimePlus <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTimePlus);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTimePlus:タイム+</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>タイム+(m_lTimePlusの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetKeyPlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetKeyPlus <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lKeyPlus);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lKeyPlus:キー+</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>キー+(m_lKeyPlusの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetVelocityPlus"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetVelocityPlus <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lVelocityPlus);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lVelocityPlus:ベロシティ+</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>ベロシティ+(m_lVelocityPlusの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetViewMode"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetViewMode <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lViewMode);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lViewMode:表示モード(0=通常, 1=ドラム)</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>表示モード(m_lViewModeの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetForeColor"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetForeColor <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lForeColor);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lForeColor:前景色</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>前景色(m_lForeColorの値)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_SetBackColor"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_SetBackColor <BR>(MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lBackColor);</A> </TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lBackColor:背景色</TD>
  <TD>正常終了:1, 異常終了:0</TD>
  <TD>背景色(m_lBackColorの値)を設定する。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDITrack_OtherFunction">3-10.MIDIトラックのその他の関数</A></H3>

<DIV CLASS="TITLE"><A NAME="MIDITrack_OtherFunctionTable">▼Table3-10.MIDITrack_その他の関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR CLASS="TITLE">
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_CountEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_CountEvent (MIDITrack* pMIDITrack);</A></TD>
  <TD>pMIDIData:MIDIトラックへのポインタ</TD>
  <TD>MIDIイベント数</TD>
  <TD>指定したMIDIトラックに含まれるMIDIイベントの数を数える。また、<A HREF="#MIDITrack_FieldTable">m_lNumEvent</A>の値を更新する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_TimeToMillisec"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_TimeToMillisec (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:時刻</TD>
  <TD>ミリ秒単位の時刻</TD>
  <TD>lTimeで示される時刻から、ミリ秒単位の時刻を計算して取得する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を使って計算する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は最初のトラック(コンダクタートラック)に対して使われるべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_MillisecToTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_MillisecToTime (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lMillisec);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lMillisec:ミリ秒単位の時刻</TD>
  <TD>ティック単位の時刻(TPQNベースの場合)<BR>サブフレーム単位の時刻(SMPTEベースの場合)</TD>
  <TD>lMillisecで示されるミリ秒単位の時刻から、ティック単位の時刻(TPQNベースの場合)又はサブフレーム単位の時刻(SMPTEベースの場合)を取得する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を使って計算する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は最初のトラック(コンダクタートラック)に対して使われるべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_MakeTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_MakeTime (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lMeasure, <SPAN CLASS="KEYWORD">long</SPAN> lBeat, <SPAN CLASS="KEYWORD">long</SPAN> lTick, <SPAN CLASS="KEYWORD">long</SPAN>* pTime);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lMeasure:小節番号(0オリジン)<BR>lBeat:拍番号(0オリジン)<BR>lTick:ティック番号(0オリジン)<BR>pTime:累積ティック単位のタイムを格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>MIDIデータのタイムモードがTPQNベースの場合、小節：拍：ティックで表されるタイムから、累積ティック単位のタイムを計算してバッファに格納する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索して計算する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は拍子記号が含まれているトラック(セットアップトラック)に対して使われるべきである。</SPAN>MIDIデータのタイムモードがSMPTEベースの場合、フレーム：サブフレームで表されるタイムから、累積サブフレーム単位のタイムを計算してバッファに格納する。lMeasureにはフレーム番号を、lTickにはサブフレーム番号を指定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_MakeTimeEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_MakeTimeEx (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lMeasure, <SPAN CLASS="KEYWORD">long</SPAN> lBeat, <SPAN CLASS="KEYWORD">long</SPAN> lTick, <SPAN CLASS="KEYWORD">long</SPAN>* pTime, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lMeasure:小節番号(0オリジン)<BR>lBeat:拍番号(0オリジン)<BR>lTick:ティック番号(0オリジン)<BR>pTime:累積ティック単位のタイムを格納するバッファ<BR>pnn：最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分子を格納するバッファ<BR>pdd:最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分母の指数部分を格納するバッファ<BR>pcc:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照<BR>pbb:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>この関数は<A HREF="#MIDITrack_MakeTime">MIDITrack_MakeTime</A>と変わらないが、同時に指定時刻における拍子記号情報を得ることができる。それに伴うオーバーヘッドは無視できるほど小さい。タイムモードがSMPTEベースの場合、拍子記号情報を得ることはできない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_BreakTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_BreakTime (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pMeasure, <SPAN CLASS="KEYWORD">long</SPAN>* pBeat, <SPAN CLASS="KEYWORD">long</SPAN>* pTick);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:分解すべき累積タイム<BR>pMeasure:小節番号(0オリジン)を格納するバッファ<BR>pBeat:拍番号(0オリジン)を格納するバッファ<BR>pTick:ティック番号(0オリジン)を格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>MIDIデータのタイムモードがTPQNベースの場合、指定した累積ティック単位のタイムから、小節：拍：ティックで表されるタイムを計算してバッファに格納する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索して計算する。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は拍子記号が含まれているトラック(セットアップトラック)に対して使われるべきである。</SPAN>MIDIデータのタイムモードがSMPTEベースの場合、指定したタイムから、フレーム番号とサブフレーム番号(0以上(分解能-1)以下)を計算してバッファに格納する。フレーム番号はpMeasureに、サブフレーム番号はpTickに格納され、pBeatは常に0となる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_BreakTimeEx"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_BreakTimeEx (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pMeasure, <SPAN CLASS="KEYWORD">long</SPAN>* pBeat, <SPAN CLASS="KEYWORD">long</SPAN>* pTick, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:分解すべき累積タイム<BR>pMeasure:小節番号(0オリジン)を格納するバッファ<BR>pBeat:拍番号(0オリジン)を格納するバッファ<BR>pTick:ティック番号(0オリジン)を格納するバッファ<BR>pnn：最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分子を格納するバッファ<BR>pdd:最新<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>の分母の指数部分を格納するバッファ<BR>pcc:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照<BR>pbb:<A HREF="#MIDIEvent_TimeSignature">拍子記号</A>参照</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>この関数は<A HREF="#MIDITrack_BreakTime">MIDITrack_BreakTime</A>と変わらないが、同時に指定時刻における拍子記号情報を得ることができる。それに伴うオーバーヘッドは無視できるほど小さい。タイムモードがSMPTEベースの場合、拍子記号情報は得られない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_FindTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_FindTempo (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pTempo);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:時刻<BR>pTempo:テンポを格納するバッファ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおけるテンポ(lTimeにテンポイベントがない場合は直前のテンポ)を調べ、バッファに格納する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_Tempo">テンポイベント</A>を探索する。<SPAN CLASS="RED">テンポの単位は4分音符あたりのマイクロ秒[μ秒／4分音符]である。</SPAN>テンポイベントが指定時刻までに存在しない場合は、デフォルト値として、500000[μ秒／4分音符]が返される。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は最初のトラック(コンダクタートラック)に対して使われるべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_FindTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_FindTimeSignature (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:時刻<BR>pnn:分子を格納するバッファへのポインタ<BR>pdd:分母を格納するバッファへのポインタ<BR>pcc:1拍あたりのMIDIクロック数を格納するバッファへのポインタ<BR>pbb:1拍当たりの32分音符の数を格納するバッファへのポインタ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおける拍子記号(lTimeに拍子記号イベントがない場合は直前の拍子記号)を調べ、バッファに格納する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を探索する。pnnの指す値は拍子記号の分子を表す。pddの指す値は拍子記号の分母が2の何乗にであるかを表す。pccの指す値は1拍あたりのMIDIクロック数を表す。pbbの指す値は1拍の長さを32分音符の数で表す。拍子記号イベントが指定時刻までに存在しない場合は、デフォルト値として、4分の4拍子・24クロック・8個とみなされる。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は最初のトラック(コンダクタートラック)に対して使われるべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDITrack_FindKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDITrack_FindKeySignature (MIDITrack* pMIDITrack, <SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN>* psf, <SPAN CLASS="KEYWORD">long</SPAN>* pmi);</A></TD>
  <TD>pMIDITrack:MIDIトラックへのポインタ<BR>lTime:時刻<BR>psf:#又は♭の数を格納するバッファへのポインタ<BR>pmi:長調か短調かを格納するバッファへのポインタ</TD>
  <TD>正常終了：0以外<BR>異常終了：0</TD>
  <TD>lTimeにおける調性記号(lTimeに調性記号イベントがない場合は直前の調性記号)を調べ、バッファに格納する。この関数は、指定したMIDIトラックのみに含まれる<A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>を探索する。psfの指す値は正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。pmiの指す値はMIDIEVENT_KEYMAJOR(0)かMIDIEVENT_KEYMINOR(1)のいずれかである。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>の場合、この関数は最初のトラック(コンダクタートラック)に対して使われるべきである。</SPAN></TD>
 </TR>
</TABLE>


<H3><A NAME="MIDITrack_forEachEvent">3-11.MIDIトラック内の各イベントへのアクセス</A></H3>

<P>　MIDIトラック内の各イベントへアクセスする方法として、便利なforEachEventマクロとforEachEventInverseマクロを用意している。これらのマクロは、MIDIトラック内の全イベントを順番に評価するforループの一種である。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_forEachEventList1">▼List3-11-1.forEachEvent系マクロの使い方</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDITrack* pMIDITrack;
	MIDIEvent* pMIDIEvent;
	...
	<SPAN CLASS="COMMENT">/* MIDIトラック内の各イベントを順次出力 */</SPAN>
	forEachEvent (pMIDITrack, pMIDIEvent) {
		printf (<SPAN CLASS="STRING">"%s\n"</SPAN>, MIDIEvent_ToString (pMIDIEvent, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
	}
</PRE>

<P>　上のプログラムは、次のwhileループを使ったプログラムと等価である。</P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_forEachEventList2">▼List3-11-2.forEachEventに等価なプログラム</A></DIV>
<PRE>
	<SPAN CLASS="KEYWORD">char</SPAN> szBuf[1024];
	MIDITrack* pMIDITrack;
	MIDIEvent* pMIDIEvent;
	...
	<SPAN CLASS="COMMENT">/* MIDIトラック内の各イベントを順次出力 */</SPAN>
	pMIDIEvent = pMIDITrack-&gt;m_pFirstEvent;
	<SPAN CLASS="KEYWORD">while</SPAN> (pMIDIEvent) {
		printf (<SPAN CLASS="STRING">"%s\n"</SPAN>, MIDIEvent_ToString (pMIDIEvent, szBuf, <SPAN CLASS="KEYWORD">sizeof</SPAN>(szBuf)));
		pMIDIEvent = pMIDIEvent-&gt;m_pNextEvent;
	}
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_forEachEventTable">▼Table3-11.forEachEvent系マクロ</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="40%">マクロ</TH>
  <TH WIDTH="60%">意味</TH>
 </TR>
 <TR>
  <TD><A NAME="forEachEvent"></A>forEachEvent (pMIDITrack, pMIDIEvent) {<BR> ...<BR>}</TD>
  <TD>pMIDITrack内のイベントを最初から順番に評価する。pMIDIEventには最初のイベントへのポインタ、その次のイベントへのポインタ、その次のイベントへのポインタ……といった具合に代入される。</TD>
 </TR>
 <TR>
  <TD><A NAME="forEachEventInverse"></A>forEachEventInverse (pMIDITrack, pMIDIEvent) {<BR> ...<BR>}</TD>
  <TD>pMIDITrack内のイベントを最後から順番に評価する。pMIDIEventには最後のイベントへのポインタ、その前のイベントへのポインタ、その前のイベントへのポインタ……といった具合に代入される。</TD>
 </TR>
</TABLE>

<P>　<SPAN CLASS="RED">forEachEvent内でイベントの追加をしてはならない。forEachEvent内でをイベントを追加した場合、次のイベントへのポインタ描き変わってしまい、ループを脱出できなくなることがある。必要であれば、まず最初にローカル配列にすべてのイベントへのポインタをコピーし、ローカル配列のポインタに対して追加を行うべきである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_forEachEventList3">▼List3-11-3.forEachEvent内でイベントを追加(悪い例)</A></DIV>
<PRE>
	...
	forEachEvent (pMIDIData, pMIDITrack) {
		pNewEvent = MIDIEvent_Create (pMIDIData-&gt;m_lTime, MIDIEVENT_TEXTEVENT, "a", 1);
		MIDITrack_InsertEvent (pMIDITrack, pNewEvent);
	}
</PRE>

<P>　<SPAN CLASS="RED">　一方、forEachEvent内でイベントを除外又は削除してはならない。イベントの消滅により次のイベントが探索できなくなるからだ。必要であれば、まず最初にローカル配列にすべてのイベントへのポインタをコピーし、ローカル配列のポインタに対して除外又は削除を行うべきである。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDITrack_forEachEventList6">▼List3-11-6.forEachEvent内でイベントを削除(悪い例)</A></DIV>
<PRE>
	...
	forEachEvent (pMIDITrack, pMIDIEvent) {
		<SPAN CLASS="KEYWORD">if</SPAN> (pMIDITrack-&gt;m_lUserFlag & SELECTED) {
			MIDIEvent_DeleteSingle (pMIDIEvent);
		}
	}
</PRE>

<P></P>

<P>　<SPAN CLASS="RED"><A HREF="#MIDIEvent_Delete">MIDIEvent_Delete</A>と<A HREF="#MIDIEvent_DeleteSingle">MIDIEvent_DeleteSingle</A>は適切に使い分けられなければならない。<A HREF="#MIDIEvent_Delete">MIDIEvent_Delete</A>は、対象イベントが他のイベントに結合している場合、結合しているMIDIイベントも同時に削除するため、MIDIデータの整合性は保たれるが、2つ以上のMIDIイベントを同時に削除することがあることに注意しなければならない。一方、<A HREF="#MIDIEvent_DeleteSingle">MIDIEvent_DeleteSingle</A>は、対象イベントが他のイベントに結合している場合、自動的に結合を切り離し、引数で指定した単一のイベントを削除する。ただし、ノートオンだけ削除してノートオフを削除しなかった場合、MIDIデータは不正な状態になってしまうので、このようなことのないよう、注意深く使うべきである。</SPAN></P>

<P>　<SPAN CLASS="RED"><A HREF="#MIDIEvent_SetTime">MIDIEvent_SetTime</A>又は<A HREF="#MIDIEvent_SetTimeSingle">MIDIEvent_SetTimeSingle</A>をforEachEvent内又はforEachEventInverse内で使ってはならない。なぜなら、イベントの順序がforループ中で変化してしまうと、正しい順序で評価することが不可能になるからである。必要であれば、まず最初にローカル配列にすべてのイベントへのポインタをコピーし、ローカル配列のポインタに対して時刻移動を行うべきである。</SPAN></P>






<H2><A NAME="MIDIEvent">第4章：MIDIイベント</A></H2>

<H3><A NAME="MIDIEvent_Struct">4-1.MIDIイベントの構造</A></H3>

<P>　MIDIイベントは、そのイベントの置かれている時刻と、そこで発生するイベントの種類、及びイベントの内容を表すデータ部から構成されている。また、MIDIイベントは双方向リンクリストの要素であり、次のイベントへと前のイベントへのポインタを保持している。</P>

<P>　次にMIDIEvent構造体のメンバ変数を示す。これらのメンバ変数を直接参照することは安全であるが、直接操作することは整合性やメモリ管理の点において大変危険である。従って、特殊な理由がない限り<A HREF="#MIDIEvent_GetFunction">MIDIEvent_Get系関数</A>と<A HREF="#MIDIEvent_SetFunction">MIDIEvent_Set系関数</A>を介してアクセスすることを推奨する。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_FieldTable">▼Table4-1.MIDIEvent構造体のメンバ変数と使い方</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">メンバ変数</TH>
  <TH WIDTH="75%">使い方</TH>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lTime</TD>
  <TD>このMIDIイベントの置かれている時刻を表す。MIDIトラック内のMIDIイベントは、この時刻の順に従って常にソートされる。時刻の単位は、<A HREF="#MIDIData">MIDIデータ</A>の<A HREF="#MIDIData_TimeBase">タイムモード</A>が<A HREF="#MIDIDATA_TPQNBASE">TPQNベース</A>の場合[ティック]であり、<A HREF="#MIDIDATA_SMPTEBASE">SMPTEベース</A>の場合[サブフレーム]である。スタンダードMIDIファイル(*.mid)内では時刻を前のイベントから相対時刻として記録しているが、MIDIDataライブラリにおいてはMIDIイベントの挿入や削除に対応するため、相対時刻ではなく0からの絶対時刻で保持している。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lKind</TD>
  <TD><A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A>を表す識別番号(<A HREF="#MIDIEvent_SequenceNumber">MIDIEVENT_SEQUENCENUMBER</A>(0x00)〜<A HREF="#MIDIEvent_SysExStart">MIDIEVENT_SYSEXCONTINUE</A>(0xF7)の値)。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lLen</TD>
  <TD>データ部の長さ[バイト]を表す。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">unsigned char</SPAN>* m_pData</TD>
  <TD>データ部へのポインタ。データ部分はイベントの種類によって長さが異なり、ほとんどのイベントは4バイト以内であるが、テキスト関係のイベントでは極端に長いものもある。<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>及び<A HREF="#MIDIEvent_SysExEvent">SysExイベント</A>の場合は、別途確保されたバッファへの先頭ポインタを保持している。<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>の場合は、m_lDataの先頭ポインタすなわち(unsigned char*)(&amp;m_lData)を保持している。いずれの場合も、このポインタを用いてバッファにアクセスできる。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">unsigned long</SPAN> m_lData</TD>
  <TD>データ部(4バイト)。このバッファは<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>の場合のみ使われる。他の種類のイベントの場合はこのバッファは使用せず、別途バッファを確保する。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pNextEvent</TD>
  <TD>次のMIDIイベントへのポインタ。次のMIDIイベントがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pPrevEvent</TD>
  <TD>前のMIDIイベントへのポインタ。前のMIDIイベントがなければNULL。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">void</SPAN>* m_pParent</TD>
  <TD>親のMIDIトラックへのポインタ。親のMIDIトラックがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pNextSameKindEvent</TD>
  <TD>次の同じ種類のMIDIイベントへのポインタ。次の同じ種類のMIDIイベントがなければNULL。</TD>
 </TR>
 <TR>
  <TD>MIDIEvent* m_pPrevSameKindEvent</TD>
  <TD>前の同じ種類のMIDIイベントへのポインタ。前の同じ種類のMIDIイベントがなければNULL。</TD>
 </TR>


 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser1</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その1。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser2</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その2。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUser3</TD>
  <TD>ユーザーが自由に使うことのできる拡張領域その3。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
 <TR>
  <TD><SPAN CLASS="KEYWORD">long</SPAN> m_lUserFlag</TD>
  <TD>ユーザーが自由に使うことのできるフラグのための拡張領域。例えば、選択/非選択・可視/不可視・フィルタリング中・編集ロック中などの状態を保持する。これはMIDIDataライブラリ独自のメンバ変数であり、スタンダードMIDIファイル(*.mid)には保存されない。</TD>
 </TR>
</TABLE>  

<H3><A NAME="MIDIEvent_Kind">4-2.MIDIイベントの種類</A></H3>

<P>　MIDIイベントには、大きく分けて、<A HREF="#MIDIEvent_MetaEvent">メタイベント</A>、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>、<A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A>の3種類がある。</P>

<H4><A NAME="MIDIEvent_MetaEvent">メタイベント</A></H4>
<P>　メタイベントは、タイトル・コメントテキスト・楽譜表記などの補足的な情報を記述する場合に使うイベントであり、MIDIデバイスに送信するべきMIDIメッセージはない。メタイベントはあくまで補足的なものなので、たとえすべてのメタイベント(<A HREF="#MIDIEvent_Tempo">テンポ</A>を除く)を無視したとしても、MIDIデータを正しく演奏することが可能である。</P>

<P>　メタイベントには、次の表に示す17種類が存在する。将来はさらに拡張されることがある。あなたのシステムは、未知のメタイベントを発見した場合、それを正しく無視できなければならない。</P>

<P>　イベントがメタイベントであるかどうかを調べるには、<A HREF="#MIDIEvent_IsMetaEvent">MIDIEvent_IsMetaEvent</A>関数を使う。</P>


<DIV CLASS="TITLE"><A NAME="MIDIEvent_MetaTable">▼Table4-2-1.メタイベントの種類</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="20%">識別番号</TH>
  <TH WIDTH="10%">名前</TH>
  <TH WIDTH="5%">データの長さ</TH>
  <TH WIDTH="5%">データ部</TH>
  <TH WIDTH="50%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SequenceNumber">MIDIEVENT_SEQUENCENUMBER</A><BR>(0x00)</TD>
  <TD>シーケンス番号</TD>
  <TD>2バイト</TD>
  <TD>MSB, LSB</TD>
  <TD>シーケンス番号イベントは、0〜65535の識別番号を表すイベントである。<A HREF="#MIDIData_Format1">フォーマット1</A>のMIDIデータの場合、このイベントはコンダクタートラックの随所に配置することができ、他の機材からソングポジションセレクタで位置移動する際のインデックスとなる。<A HREF="#MIDIData_Format2">フォーマット2</A>のMIDIデータの場合、このイベントは全てのトラックにおいて冒頭にのみ配置され、他の機材からトラックを選択する際のインデックスとなる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_TextEvent">MIDIEVENT_TEXTEVENT</A><BR>(0x01)</TD>
  <TD>テキストイベント</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>テキストイベントは、コメントなどを記述するために設置される任意の文字列である。ヌル文字は含まない。このイベントはあらゆるトラックのあらゆる場所に入れることが許されている。2バイト文字の途中で途切れている場合でも、「データ部の長さ」で示す値が優先される(以下同様)。また、128バイト以上の文字列は互換性の面であまり推奨しない。データ部が"{@LATIN}"で始まる場合は、テキストは8バイト目からで、その文字コードはLATIN(Windowsコードページ1252)である。データ部が"{@JP}"で始まる場合は、テキストは5バイト目からで、その文字コードはShift-JIS(Windowsコードページ932)である。データ部が{0xFF, 0xFE}で始まる場合は、テキストは3バイト目からで、その文字コードはUTF16-LEである。データ部が{0xFE, 0xFF}で始まる場合は、テキストは3バイト目からで、その文字コードはUTF16-BEである。上記4種類以外の文字コードは許されていない。いずれの文字コードも指定されていない場合は、同一トラックの直近の同種イベントの文字コードであるものとみなす。文字コードが見つからない場合は、MIDIDataLib_SetDefaultCharCodeで指定した値に基づく。なお、この文字コード判別指針は、スタンダードMIDIファイル仕様書のRP-026に基づき、本来であれば歌詞イベントのみに適用されるが、MIDIDataライブラリにおいては、すべてのテキスト系イベントにおいてこの規則を適用するものとする。なお、Unicodeのテキストイベントは、Unicodeに対応したMIDIプレイヤー/シーケンサーでなければ正常に表示できないので、使用には注意を要する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CopyrightNotice">MIDIEVENT_COPYRIGHTNOTICE</A><BR>(0x02)</TD>
  <TD>著作権</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>著作権に関する情報を文字列で表す。<A HREF="#MIDIData_Format1">フォーマット1</A>の場合、このイベントを最初のトラック以外のトラックに入れてはならない。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_TrackName">MIDIEVENT_TRACKNAME</A><BR>(0x03)</TD>
  <TD>シーケンス名／トラック名</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>フォーマット0の場合、このイベントは曲の題名を表す。<A HREF="#MIDIData_Format1">フォーマット1</A>の場合、最初のトラックにあるこのイベントは曲の題名を表し、それ以降のトラックにあるこのイベントは各トラックの名前を表す。このイベントはなるべく全トラックの冒頭に入れることを推奨する。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_InstrumentName">MIDIEVENT_INSTRUMENTNAME</A><BR>(0x04)</TD>
  <TD>インストゥルメント名</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>機器の名称を文字列で表す。例えば、「Poland SC-88Ero」や「YANAHA MV-1000」など、使用した音源を記述しておく。これはMIDIデータのエンドユーザーが何の音源で作ったかを知るために役に立つ。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Lyric">MIDIEVENT_LYRIC</A><BR>(0x05)</TD>
  <TD>歌詞</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>歌詞を文字列で表す。通常このイベントは、ボーカルトラックの音符(ノートイベント)ごとに付加する。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Marker">MIDIEVENT_MARKER</A><BR>(0x06)</TD>
  <TD>マーカー</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>その位置の名称を文字列で表す。例えば「Aセクション」「Bメロ」といった具合に名付ける。<A HREF="#MIDIData_Format1">フォーマット1</A>の場合、このイベントは最初のトラックに入れることを推奨する。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CuePoint">MIDIEVENT_CUEPOINT</A><BR>(0x07)</TD>
  <TD>キューポイント</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>MIDIに関係ない他の出来事を文字列で表す。例えば「画面が暗くなる」「主人公が左に進む」といった具合に記述する。フォーマット1の場合、このイベントは最初のトラックに入れることを推奨する。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_ProgramName">MIDIEVENT_PROGRAMNAME</A><BR>(0x08)</TD>
  <TD>プログラム名</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>音色の名称を文字列で表す。例えば「Ground Piano1」「Strings1」と記述する。実際の音色の選択は<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジイベント</A>によって行われる。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_DeviceName">MIDIEVENT_DEVICENAME</A><BR>(0x09)</TD>
  <TD>デバイス名</TD>
  <TD>任意</TD>
  <TD>任意長文字列</TD>
  <TD>ポートの名称を文字列で表す。例えば「ADSP24 MPU401 Port1 (1)」や「Out-A USB MidiSport 8x8」と記述する。実際のポート番号は<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックスイベント</A>で指定する。仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_ChannelPrefix">MIDIEVENT_CHANNELPREFIX</A><BR>(0x20)</TD>
  <TD>チャンネルプリフィックス</TD>
  <TD>1バイト</TD>
  <TD>チャンネル番号(0〜15)</TD>
  <TD>このイベントは、チャンネル情報をもたないイベント(MIDIイベント以外のもの)に対して、チャンネル情報が必要な場合に用いられる。又は、このイベントがあるトラックを特定のチャンネルに強制的に結びつけるために用いられる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_PortPrefix">MIDIEVENT_PORTPREFIX</A><BR>(0x21)</TD>
  <TD>ポートプリフィックス</TD>
  <TD>1バイト</TD>
  <TD>ポート番号(0〜255)</TD>
  <TD>このイベントは、複数のMIDI音源を使って演奏するMIDIデータの場合に、出力先のポート番号を指定するために用いられる。このイベントは非公式なものであるが、多くのシーケンサが認識できるようになっている。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_EndofTrack">MIDIEVENT_ENDOFTRACK</A><BR>(0x2F)</TD>
  <TD>エンドオブトラック</TD>
  <TD>0バイト</TD>
  <TD>なし</TD>
  <TD>このイベントは、各トラックの最後に設置するものである。<SPAN CLASS="RED">スタンダードMIDIファイル(*.mid)においては、このイベントを省略することは許されていない。</SPAN>MIDIデータライブラリでは、このイベントはトラックの生成時に自動的に追加されないので、このイベントを挿入するのはプログラマの責任である。また、このイベントより後部に新しいイベントを挿入しようとすると、このイベントは自動的に最後に移動される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Tempo">MIDIEVENT_TEMPO</A><BR>(0x51)</TD>
  <TD>テンポ設定</TD>
  <TD>3バイト</TD>
  <TD>tt tt tt</TD>
  <TD>このイベントは、テンポを設定するために使う。いったん設定されたテンポは次のテンポ設定が現れるまで有効である。テンポは24ビットの整数で表現され、<SPAN CLASS="RED">テンポの単位は4分音符あたりのマイクロ秒[μs/4分音符]で表す。</SPAN>通常表記で使われるの1分あたりの拍数(BPM)[beat/minute]形式との関係は、(Tempo = 60000000 / BPM)となる。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>のとき、このイベントを最初のトラック以外に入れてはならない。</SPAN><A HREF="#MIDIData_Format2">フォーマット2</A>のとき、各トラックは別々のテンポを持つことができる。このイベントが冒頭にない場合、デフォルトのテンポは500000[μs/tick](120[BPM])であるものとみなす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SMPTEOffset">MIDIEVENT_SMPTEOFFSET</A><BR>(0x54)</TD>
  <TD>SMPTEオフセット</TD>
  <TD>5バイト</TD>
  <TD>hr mn se fr ff</TD>
  <TD>このイベントは、SMPTEオフセットを定義するために、常に時刻0の位置に置かれる。hrはSMPTEフレームモードと時間(0〜23)を、mnは分(0〜59)を、seは秒(0〜59)を、frはフレーム(0〜25,29,30)を、ffはサブフレーム(0〜99)を表す。hrは、上1ビットは常に0であり、次の2ビットはSMPTEのフレームモードを、下5ビットは0〜23の時間を表す。SMPTEフレームモードは、MIDIEVENT_SMPTE24(0)の時24フレーム/秒、MIDIEVENT_SMPTE25(1)の時25フレーム/秒、MIDIEVENT_SMPTE30D(2)の時30フレームドロップ/秒、MIDIEVENT_SMPTE30N(3)の時30フレームノンドロップ/秒を意味する。ffは<A HREF="#MIDIData_TimeBase">タイムベース</A>の値にかかわらず、1/100フレーム単位を表す。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>のとき、このイベントを最初のトラック以外のトラックに入れてはならない。</SPAN><!--このイベントが冒頭にない場合、デフォルトのSMPTEオフセットは0{0x00, 0x00, 0x00, 0x00, 0x00}であるものとみなす。--></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_TimeSignature">MIDIEVENT_TIMESIGNATURE</A><BR>(0x58)</TD>
  <TD>拍子記号</TD>
  <TD>4バイト</TD>
  <TD>nn bb cc dd</TD>
  <TD>このイベントは、拍子記号を設定するのに使う。このイベントは表記上のものだけであり、演奏内容にはなんら影響を与えない。nnは拍子記号の分子を表す。bbは拍子記号の分母が2の何乗にであるかを表す。ccは1拍あたりのMIDIクロック数を表す。一般的には、24MIDIクロックで4分音符を表すため、24となる。bbは1拍の長さを32分音符の数で表す。一般的には8となる。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>のとき、このイベントを最初のトラック以外のトラックに入れてはならない。</SPAN>このイベントが冒頭にない場合、デフォルトの拍子記号は4分の4拍子{0x02, 0x02, 0x18, 0x08}であるものとみなす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_KeySignature">MIDIEVENT_KEYSIGNATURE</A><BR>(0x59)</TD>
  <TD>調性記号</TD>
  <TD>2バイト</TD>
  <TD>sf mi</TD>
  <TD>このイベントは、調合を設定するのに使う。sfは正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。miは0のとき長調を、1のとき短調であることを意味する。なお、このイベントは表記上のものだけであり、演奏内容にはなんら影響を与えない。<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>のとき、このイベントを最初のトラック以外のトラックに入れてはならない。</SPAN>このイベントが冒頭にない場合、デフォルトの調性記号は{0x00, 0x00}であるものとみなす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SequencerSpecific">MIDIEVENT_SEQUENCERSPECIFIC</A><BR>(0x7F)</TD>
  <TD>シーケンサー独自のイベント</TD>
  <TD>任意</TD>
  <TD>任意長バイト列</TD>
  <TD>このイベントは、シーケンサー独自のイベントを保持するために使う。このイベントはシーケンサー同士で互換性がないため、あまり用いられない。データ部の1バイト目は、シーケンサーのメーカー名を表す識別番号である。自分のメーカーでないシーケンサー独自のイベントが現れた場合は、正常に無視しなければならない。</TD>
 </TR>
</TABLE>

<H4><A NAME="MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A></H4>

<P>　MIDIチャンネルイベントは、MIDIデバイスにチャンネル別に出力される、2〜3バイトのMIDIメッセージをもつイベントである。MIDIチャンネルイベントは、下の表に示す7種類があるが、いずれも重要なイベントばかりで、鍵盤の押し離し、音色の選択、コントロールチェンジの調整など、演奏に不可欠なイベントである。MIDIチャンネルイベントのデータ部には、送信すべきMIDIメッセージがそのまま格納されており、データ部の有効長さはlLenに格納されている値である。</P>

<P>　スタンダードMIDIファイル(*.mid)においては、データ部の1バイト目が前回と同じである場合、しばしば1バイト目が省略され2バイト目から始まる。しかし、MIDIデータライブラリとしては、イベントの独立性を高め、イベントの挿入や削除を効率的に行うため、1バイト目を省略することはない。1バイト目が省略されたスタンダードMIDIファイル(*.mid)から読み込んだMIDIデータでも、1バイト目は自動的に補完される。</P>

<P>　<SPAN CLASS="RED"><A HREF="#MIDIData_Format1">フォーマット1</A>のとき、MIDIチャンネルイベントを最初のトラックに入れてはならない。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_MIDIChannelEventTable">▼Table4-2-2.MIDIチャンネルイベントの種類</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="20%">識別番号</TH>
  <TH WIDTH="10%">名前</TH>
  <TH WIDTH="5%">データの長さ</TH>
  <TH WIDTH="5%">データ部</TH>
  <TH WIDTH="50%">解説</TH>
 </TR>

 <TR>
  <TD><A NAME="MIDIEvent_NoteOff">MIDIEVENT_NOTEOFF</A><BR>(0x8n)</TD>
  <TD>ノートオフ</TD>
  <TD>3バイト</TD>
  <TD>0x8n<BR> key<BR> vel</TD>
  <TD>ノートオフはノートオンに対応するもので、押した鍵盤を離すイベントである。nはチャンネル番号(0〜15)、keyは鍵盤番号(0〜127)、velは離鍵速度(0〜127)を表す。velはあまり用いられない。<BR>★参考資料：<A HREF="#APPENDIX_B">付録B</A></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_NoteOn">MIDIEVENT_NOTEON</A><BR>(0x9n)</TD>
  <TD>ノートオン</TD>
  <TD>3バイト</TD>
  <TD>0x9n<BR> key<BR> vel</TD>
  <TD>ノートオンは鍵盤を押すイベントである。nはチャンネル番号(0〜15)、keyは鍵盤番号(0〜127)、velは打鍵速度(0〜127)を表す。velは通常強弱の度合いを表すのに使うが、音源によっては強弱を感知して音色やエンベロープを切り替えるものもある。<SPAN CLASS="RED">velが0の場合、ノートオフイベントであるものとみなす。</SPAN><BR>★参考資料：<A HREF="#APPENDIX_B">付録B</A></TD>
 </TR>

 <TR>
  <TD><A NAME="MIDIEvent_KeyAftertouch">MIDIEVENT_KEYAFTERTOUCH</A><BR>(0xAn)</TD>
  <TD>キーアフタータッチ</TD>
  <TD>3バイト</TD>
  <TD>0xAn<BR> Key<BR> Val</TD>
  <TD>キーアフタータッチはいったん鍵盤が押されたあと、鍵盤を押す圧力が変化したことを示すイベントである。n(0〜15)はチャンネル番号を、Key(0〜127)は鍵盤番号を、Valは設定値を表す。鍵盤を押す圧力が変化すると、音源によっては、そのキーの音色やエンベロープが変化する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_ControlChange">MIDIEVENT_CONTROLCHANGE</A><BR>(0xBn)</TD>
  <TD>コントロールチェンジ</TD>
  <TD>3バイト</TD>
  <TD>0xBn<BR> Num<BR> Val</TD>
  <TD>コントロールチェンジは、モジュレーション・ボリューム・パン・エクスプレッション・ホールドペダル・リバーブ・コーラス・ディレイなどの設定をするためのイベントである。n(0〜15)はチャンネルを、Num(0〜127)はコントロールチェンジナンバーを、Val(0〜127)は設定値を表す。コントロールチェンジナンバーの割り当ては音源によって異なるが、GM/GS/XGに対応したものは規格化されている。コントロールチェンジの中には、複数のコントロールチェンジイベントを組み合わせてひとつの値を設定するものもある。具体的には、RPNチェンジ(CC#101とCC#100とCC#6)、及び、NRPNチェンジ(CC#99とCC#98とCC#6)が挙げられる。<BR>★参考資料：<A HREF="#APPENDIX_B">付録B</A></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_ProgramChange">MIDIEVENT_PROGRAMCHANGE</A><BR>(0xCn)</TD>
  <TD>プログラムチェンジ</TD>
  <TD>2バイト</TD>
  <TD>0xCn<BR> Num</TD>
  <TD>プログラムチェンジは、音色を設定するためのイベントである。曲の途中でプログラムチェンジを使うこともできる。n(0〜15)はチャンネルを、Num(0〜127)はプログラム番号を表す。プログラム番号と楽器の対応は音源によって異なるが、GM/GS/XG/GM2に対応したものは規格化されている。128種類を超える音色選択をする場合は、コントロールチェンジ(CC#0)とコントロールチェンジ(CC#32)でバンクを選択してから、プログラムチェンジを使う。これにより、理論上は2097152種類の音色選択が可能となる。<BR>★参考資料：<A HREF="#APPENDIX_B">付録B</A></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_ChannelAftertouch">MIDIEVENT_CHANNELAFTERTOUCH</A><BR>(0xDn)</TD>
  <TD>チャンネルアフタータッチ</TD>
  <TD>2バイト</TD>
  <TD>0xDn<BR> Val</TD>
  <TD>チャンネルアフタータッチは、いったん鍵盤が押されたあと、鍵盤を押す圧力が変化したことを示すイベントである。n(0〜15)はチャンネル番号を、Valは設定値を表す。鍵盤を押す圧力が変化すると、音源によっては、そのチャンネル全体の音色やエンベロープが変化する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_PitchBend">MIDIEVENT_PITCHBEND</A><BR>(0xEn)</TD>
  <TD>ピッチベンド</TD>
  <TD>3バイト</TD>
  <TD>0xEn<BR> LSB<BR> MSB</TD>
  <TD>　ピッチベンドは、該当チャンネルの音程を上下に(連続的に)変化させるためのイベントである。ピッチベンドの値は0〜16383であり、中央値(デフォルト)は8192である。音程の変化範囲は、ピッチベンドセンシティビティが12のとき±1オクターブ(±12半音)である。ピッチベンドセンシティビティは、RPNチェンジ(CC#101とCC#100とCC#6)を使って設定することができる。</TD>
 </TR>
</TABLE>


<H4><A NAME="MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A></H4>

<P>　システムエクスクルーシブイベントは、MIDIデバイス特有のコマンドを送信するためのイベントであり、データ部には送信用データが格納され、有効長さはlLenに格納される。このイベントは、主に音源にリセットをかけたり、マスターボリュームやマスターエフェクトの設定をするのに使われる。例えば、GMリセットの送信データは{0xF0, 0x7E, 0x7F, 0x09, 0x01, 0xF7}であり、しばしば曲の冒頭に挿入される。GM/GS/XG/GM2では、システムエクスクルーシブデータはある程度規格化されている。</P>

<P>　システムエクスクルーシブイベントは、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>とは違って、一般的に容量が大きく、送信に時間がかかる。そのため、このイベントのある位置から50ミリ秒程度は次のイベント(メタイベントを除く)を置くべきではない。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_SysExTable">▼Table4-2-3.システムエクスクルーシブイベントの種類</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="20%">識別番号</TH>
  <TH WIDTH="10%">名前</TH>
  <TH WIDTH="5%">データの長さ</TH>
  <TH WIDTH="5%">データ部</TH>
  <TH WIDTH="50%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SysExStart">MIDIEVENT_SYSEXSTART</A><BR>(0xF0)</TD>
  <TD>通常システムエクスクルーシブイベント</TD>
  <TD>任意</TD>
  <TD>任意長バイト列</TD>
  <TD>データ部には、送信するシステムエクスクルーシブデータをそのまま記述する。システムエクスクルーシブデータは通常、0xF0で始まり、0xF7で終わる。しかしながら、128バイト以上の長いデータに対しては、128バイトごとのデータに分割して、時間差を設けて送信されることがある。0xF0で始まらないデータに対しては、継続システムエクスクルーシヴイベントを用いる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SysExContinue">MIDIEVENT_SYSEXCONTINUE</A><BR>(0xF7)</TD>
  <TD>継続システムエクスクルーシブイベント</TD>
  <TD>任意</TD>
  <TD>任意長バイト列</TD>
  <TD>データ部には、送信するシステムエクスクルーシブデータをそのまま記述する。システムエクスクルーシブデータは通常、0xF0で始まり、0xF7で終わるが、このイベントはF0では始まらないシステムエクスクルーシブデータを送信するのに使う。長いシステムエクスクルーシブデータを区切って送信する場合の、2つ目以降のブロックを送信するときに用いられる。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDIEvent_Status">4-3.MIDIイベントの状態</A></H3>

<H4><A NAME="MIDIEvent_FloatingEvent">浮遊イベント</A></H4>
<P>　浮遊イベントとは、どのMIDIトラックにも属していないMIDIイベントである。浮遊イベントは、m_pParent=NULL、m_pNextEvent=NULL、m_pPrevEvent=NULL、m_pNextSameKindEvent=NULL、m_pPrevSameKind=NULLとなっている。MIDIイベントが浮遊状態になるのは、主にMIDIイベントを生成した直後、又はMIDIイベントをひとつのトラックから別のトラックへ移動する処理の途中である。</P>

<P>　イベントが浮遊イベントであるかどうかを調べるには、<A HREF="#MIDIEvent_IsFloating">MIDIEvent_IsFloating</A>を使う。浮遊イベントは、<A HREF="#MIDITrack_InsertEvent">MIDITrack_InsertEvent</A>を使って、特定のMIDIトラックに挿入することができる。また、MIDIトラック内のイベントに対して<A HREF="#MIDITrack_RemoveEvent">MIDITrack_RemoveEvent</A>を使うことにより、トラックから除去し、浮遊イベントとすることができる。</P>

<H4><A NAME="MIDIEvent_CombinedEvent">結合イベント</A></H4>

<P>　結合イベントは、複数(主に2つか3つ)のMIDIイベントをポインタで接続し、セットで扱えるようにしたものである。SMFにおいては結合イベントという概念は存在しないが、MIDIDataライブラリでは編集のしやすさを考えて、5種類の結合イベントを定義した。</P>

<P>　イベントが他のイベントと結合しているかどうかを調べるには、<A HREF="#MIDIEvent_IsCombined">MIDIEvent_IsCombined</A>を使う。また、結合イベントの種類は、<A HREF="#MIDIEvent_IsNoteOnNoteOff">MIDIEvent_IsNoteOnNoteOff</A>・<A HREF="#MIDIEvent_IsNoteOnNoteOn0">MIDIEvent_IsNoteOnNoteOn0</A>・<A HREF="#MIDIEvent_IsPatchChange">MIDIEvent_IsPatchChange</A>・<A HREF="#MIDIEvent_IsRPNChange">MIDIEvent_IsRPNChange</A>・<A HREF="#MIDIEvent_IsNRPNChange">MIDIEvent_IsNRPNChange</A>で調べられる。これらの関数は、結合している2又は3つのMIDIイベントのうちどれに対して使用してもよい。また、結合イベントでないものを結合するには、<A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>関数を、結合イベントを切り離すには、<A HREF="#MIDIEvent_Chop">MIDIEvent_Chop</A>関数を使う。</P>

<P>　結合イベントに対して使われた操作系の関数は、結合されているすべてのMIDIイベントに影響を与える。例えばMIDIEvent_Delete関数を使ってひとつのMIDIイベントを削除すると、それに結合しているイベントも一緒に削除される。また、MIDIEvent_SetTime関数を使ってひとつのMIDIイベントの時刻を動かすと、それに結合しているイベントも一緒に時刻が移動する。</P
>
<DIV CLASS="TITLE"><A NAME="MIDIEvent_CombineTable">▼Table4-3.結合イベントの種類</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="20%">名前</TH>
  <TH WIDTH="5%">結合するMIDIイベントの数</TH>
  <TH WIDTH="25%">MIDIデータの構造</TH>
  <TH WIDTH="50%">解説</TH>
 </TR>

 <TR>
  <TD><A NAME="MIDIEvent_NoteOnNoteOff">ノートオン+ノートオフ</A></TD>
  <TD>2個</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオン</A>+<A HREF="#MIDIEvent_NoteOff">ノートオフ</A></TD>
  <TD>ノートオン+ノートオフイベントで構成される結合イベントは、「ノートイベント」と呼ばれ、ベロシティ1以上のノートオンイベント(0x9n)とノートオフイベント(0x8n)をポインタで接続したものである。ノートオフイベントはノートオンイベントより後に位置し、互いのMIDIチャンネル番号とキー値は一致していなければならない。2つのイベントを結合することによって、ノートイベントの長さ(Dur)が定義でき、<A HREF="#MIDIEvent_GetDuration">MIDIEvent_GetDuration</A>や<A HREF="#MIDIEvent_SetDuration">MIDIEvent_SetDuration</A>関数が使えるようになる。この結合は単純なノートイベントに最適である。しかし最近ではノートオン+ノートオン0を使う方が主流である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_NoteOnNoteOn0">ノートオン+ノートオン0</A></TD>
  <TD>2個</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオン</A>+<A HREF="#MIDIEvent_NoteOn">ノートオン</A>でベロシティが0のもの</TD>
  <TD>ノートオン+ノートオン0で構成される結合イベントは、「ノートイベント」と呼ばれ、ベロシティ1以上のノートオンイベント(0x9n)とベロシティ0のノートオンイベント(0x9n)をポインタで接続したものである。ベロシティ0のノートオンはノートオフと同じ意味である。ベロシティ0のノートオンはベロシティ1以上のノートオンイベントより後に位置し、互いのMIDIチャンネル番号とキー値は一致していなければならない。2つのイベントを結合することによって、ノートイベントの長さ(Dur)が定義でき、<A HREF="#MIDIEvent_GetDuration">MIDIEvent_GetDuration</A>や<A HREF="#MIDIEvent_SetDuration">MIDIEvent_SetDuration</A>関数が使えるようになる。この結合は単純なノートイベントに最適である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_PatchChange">パッチチェンジ</A><BR>(※非推奨)</TD>
  <TD>3個</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#0(Bank Select MSB)+<BR><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#32(Bank Select LSB)+<BR><A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A><BR>(ただし、これらのイベントは、この順序で同時刻になければならない)</TD>
  <TD>パッチチェンジイベントは、128音色をこえる音色切り替えを可能にするために、コントロールチェンジイベント(CC#0)とコントロールチェンジイベント(CC#32)とプログラムチェンジイベントをこの順序でポインタで接続したものである。バンクセレクトMSB(CC#0)は0〜127、バンクセレクトLSB(CC#32)は0〜127、プログラムチェンジは0〜127の値が指定でき、理論上最大2097152音色が選択可能となる。音色の配列は、GM/GS/XG/GM2対応音源ではある程度規格化されているが、その他の音源では機種により異なる。<BR>※パッチチェンジは、結合イベントとして設置するのではなく、独立した3つのイベントを設置することを推奨する。そして、順序を明確にするために、CC#0, CC#32, プログラムチェンジを少しづつ時刻をずらして配置することを推奨する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_RPNChange">RPNチェンジ</A><BR>(※非推奨)</TD>
  <TD>3個</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#101(RPN Select MSB)+<BR><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#100(RPN Select LSB)+<BR><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#6(Data Entry MSB)<BR>(ただし、これらのイベントは、この順序で同時刻になければならない)</TD>
  <TD>RPNチェンジイベントは、コントロールチェンジイベント(CC#101)とコントロールチェンジイベント(CC#100)とコントロールチェンジイベント(CC#6)をこの順序でポインタで接続したものである。RPNはレジスタードパラメータ領域と呼ばれるもので、普通のコントロールチェンジでは操作できない拡張情報をCC#6(データエントリー)で操作するものである。RPNは理論上16384種類が使用可能であり、操作項目はCC#101とCC#100の組み合わせによって選択する。RPNの割り当てはGM/GS/XG/GM2ではある程度規格化されている。代表的なものとして、モジュレーションセンシティビティ、ピッチベンドセンシティビティなどがある。<BR>※RPNチェンジは、結合イベントとして設置するのではなく、独立した3つのイベントを設置することを推奨する。そして、順序を明確にするために、CC#101, CC#100, CC#6を少しづつ時刻をずらして配置することを推奨する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_NRPNChange">NRPNチェンジ</A><BR>(※非推奨)</TD>
  <TD>3個</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#99(NRPN Select MSB)+<BR><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#98(NRPN Select LSB)+<BR><A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>CC#6(Data Entry MSB)<BR>(ただし、これらのイベントは、この順序で同時刻になければならない)</TD>
  <TD>NRPNチェンジイベントは、コントロールチェンジイベント(CC#99)とコントロールチェンジイベント(CC#98)とコントロールチェンジイベント(CC#6)をこの順序でポインタで接続したものである。NRPNはノンレジスタードパラメータ領域と呼ばれるもので、普通のコントロールチェンジでは操作できない拡張情報をCC#6(データエントリー)で操作するものである。NRPNは理論上16384種類が使用可能であり、操作項目はCC#99とCC#98の組み合わせによって選択する。NRPNに共通の規格はなく、音源同士の互換性はない。代表的なものとして、アタック・リリースなどのエンベロープ設定や、カットオフ・レゾナンスなどのフィルタ設定がある。<BR>※NRPNチェンジは、結合イベントとして設置するのではなく、独立した3つのイベントを設置することを推奨する。そして、順序を明確にするために、CC#99, CC#98, CC#6を少しづつ時刻をずらして配置することを推奨する。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDIEvent_CreateFunction">4-4.MIDIイベントの生成</A></H3>

<P>　MIDIイベントを新規にメモリ上に生成するには、MIDIEvent_Create系関数を使う。生成直後はどのトラックにも属していない、いわゆる<A HREF="#MIDIEvent_FloatingEvent">浮遊イベント</A>である。生成後は、<A HREF="#MIDITrack_InsertEvent">MIDITrack_InsertEvent</A>関数を使って手動でイベントをトラックに追加しなければならない。</P>

<P>　MIDIEvent_Create系関数は、戻り値として正常終了時に生成したMIDIイベントへのポインタを、異常終了時にNULLを返すべきである。異常終了は、メモリの割り当てに失敗した場合、及び引数の指定が不正だった場合におこりうる。戻り値は必ずチェックし、異常終了時の回避処理をしておかなければ、ヌルポインターエラーになるであろう。</P>

<P>　次に2つのサンプルプログラム(抜粋)を示す。これらのプログラム同じ働きをするものであり、「タイム480、チャンネル0のCC#11(Expression)=127」というイベントを生成している。List4-3-1は直接バイナリデータを指定する方法で、List4-3-2はコントロールチェンジ専用の便利な生成関数を使った方法である。</P>


<DIV CLASS="TITLE"><A NAME="MIDIEvent_CreateFunctionList">▼List4-3-1.MIDIEvent_Create系関数の使い方(1)</A></DIV>
<PRE>
	MIDIEvent* pMIDIEvent;
	<SPAN CLASS="KEYWORD">char</SPAN> data[] = {0xB0, 11, 127};
	<SPAN CLASS="COMMENT">/* MIDIイベント(タイム480, Ch=0, CC#11(Expression)=127)の生成 */</SPAN>
	pMIDIEvent = MIDIEvent_Create (480, 0xB0, data, 3);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIEvent == NULL) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIイベントの生成に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_CreateFunctionList2">▼List4-3-2.MIDIEvent_Create系関数の使い方(2)</A></DIV>
<PRE>
	MIDIEvent* pMIDIEvent;
	<SPAN CLASS="COMMENT">/* MIDIイベント(タイム480、Ch=0, CC#11(Expression)=127)の生成 */</SPAN>
	pMIDIEvent = MIDIEvent_CreateControlChange (480, 0, 11, 127);
	<SPAN CLASS="KEYWORD">if</SPAN> (pMIDIEvent == NULL) {
		<SPAN CLASS="COMMENT">/* 異常終了時の処理 */</SPAN>
		printf (<SPAN CLASS="STRING">"MIDIイベントの生成に失敗しました。\n"</SPAN>);
		<SPAN CLASS="KEYWORD">return</SPAN> 0;
	}
	<SPAN CLASS="COMMENT">/* 正常終了時の処理 */</SPAN>
	...
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_CreateFunctionTable">▼Table4-4.MIDIEvent_Create系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A Name="MIDIEvent_Create">MIDIEvent* MIDIEvent_Create <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lKind, <SPAN CLASS="KEYWORD">unsigned char</SPAN>* pData, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>lTime:絶対時刻<BR>lKind:イベントの種類を表す識別番号(0x00〜0xFE)<BR>pData:データ部へのポインタ<BR>lLen:データの長さ[バイト]</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>任意の<A HREF="#MIDIEvent">MIDIイベント</A>を生成する。イベント種類を表す識別番号、データ部、データ部の長さは自由に指定できるが、データの整合性についてはチェックしない。なお、イベントの種類にMIDIチャンネルイベント(0x80〜0xEF)を指定した場合、データ部の1バイト目を省略して指定することができる。その場合、本来あるべき1バイト目は自動的に付加され、有効長さは自動的にlLenより1バイト長くなる。</TD>
 </TR>
 <TR>
  <TD><A Name="MIDIEvent_CreateClone">MIDIEvent* MIDIEvent_CreateClone <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:コピー元となる任意のMIDIイベント</TD>
  <TD>正常終了：新たに生成したMIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>指定引数と全く同じ<A HREF="#MIDIEvent">MIDIイベント</A>を生成する。引数のMIDIイベントが既にトラック内に属している場合でも、新しいイベントは浮遊状態(いずれのトラックにも属していない状態)となる。<SPAN CLASS="RED">なお、指定引数のMIDIイベントが結合イベントである場合、結合しているすべてのイベントのコピーを生成し、引数で指定したイベントに対応する複製イベントへのポインタを返す。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateSequenceNumber">MIDIEvent* MIDIEvent_CreateSequenceNumber <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>lTime:絶対時刻<BR>lNum:シーケンス番号(0〜65535)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_SequenceNumber">シーケンス番号イベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTextEvent">MIDIEvent* MIDIEvent_CreateTextEvent <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_TextEvent">テキストイベント</A>を生成する。これはMIDIEvent_CreateTextEventExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTextEventEx">MIDIEvent* MIDIEvent_CreateTextEventEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE, MIDIEVENT_UTF8)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_TextEvent">テキストイベント</A>を生成する。文字コードを指定した場合は必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子({@LATIN}又は{@JP}又は{0xFF, 0xFE}又は{0xFE, 0xFF}又は{0xEF, 0xBB, 0xBF})が付与される。MIDIEVENT_NOCHARCODEが指定された場合でも、pszTextの先頭が{@LATIN}又は{@JP}又は{@UTF-16LE}又は{@UTF-16BE}又は{@UTF-8}で始まる場合は、それに従って、必要に応じてテキストエンコードされ、データ部の先頭に対応する識別子({@UTF-16LE}と{@UTF-16BE}と{@UTF-8}はそれぞれ{0xFF, 0xFE}と{0xFE, 0xFF}と{0xEF, 0xBB, 0xBF}に変換)が付与される。MIDIEVENT_NOCHARCODEが指定されpszTextの先頭に識別子がない場合、MIDIDataLib_SetDefaultCharCodeで設定した値に基づき必要に応じてテキストエンコードされ、データ部の先頭に識別子は付与されない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateCopyrightNotice">MIDIEvent* MIDIEvent_CreateCopyrightNotice <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>を生成する。これはMIDIEvent_CreateCopyrightExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateCopyrightNoticeEx">MIDIEvent* MIDIEvent_CreateCopyrightNoticeEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTrackName">MIDIEvent* MIDIEvent_CreateTrackName <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_TrackName">シーケンス名・トラック名イベント</A>を生成する。これはMIDIEvent_CreateTrackNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTrackNameEx">MIDIEvent* MIDIEvent_CreateTrackNameEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_TrackName">シーケンス名・トラック名イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateInstrumentName">MIDIEvent* MIDIEvent_CreateInstrumentName <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>を生成する。これはMIDIEvent_CreateInstrumentNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateInstrumentNameEx">MIDIEvent* MIDIEvent_CreateInstrumentNameEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateLyric">MIDIEvent* MIDIEvent_CreateLyric <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_Lyric">歌詞イベント</A>を生成する。これはMIDIEvent_CreateLyricExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateLyricEx">MIDIEvent* MIDIEvent_CreateLyricEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_Lyric">歌詞イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateMarker">MIDIEvent* MIDIEvent_CreateMarker <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_Marker">マーカーイベント</A>を生成する。これはMIDIEvent_CreateMarkerExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateMarkerEx">MIDIEvent* MIDIEvent_CreateMarkerEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_Marker">マーカーイベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateCuePoint">MIDIEvent* MIDIEvent_CreateCuePoint <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_CuePoint">キューポイントイベント</A>を生成する。これはMIDIEvent_CreateCuePointExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateCuePointEx">MIDIEvent* MIDIEvent_CreateCuePointEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_CuePoint">キューポイントイベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateProgramName">MIDIEvent* MIDIEvent_CreateProgramName <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ProgramName">プログラム名イベント</A>を生成する。これはMIDIEvent_CreateProgramNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateProgramNameEx">MIDIEvent* MIDIEvent_CreateProgramNameEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_ProgramName">プログラム名イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateDeviceName">MIDIEvent* MIDIEvent_CreateDeviceName <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>を生成する。これはMIDIEvent_CreateDeviceNameExで文字コードにMIDIEVENT_NOCHARCODEを指定したのと等価である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateDeviceNameEx">MIDIEvent* MIDIEvent_CreateDeviceNameEx <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>lTime:絶対時刻<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE)<BR>pszText:ヌル終了文字列へのポインタ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>文字コードを指定して<A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>を生成する。動作仕様はテキストイベントと同じである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateChannelPrefix">MIDIEvent* MIDIEvent_CreateChannelPrefix <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>lTime:絶対時刻<BR>lNum:チャンネル番号(0〜15)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックスイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreatePortPrefix">MIDIEvent* MIDIEvent_CreatePortPrefix <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>lTime:絶対時刻<BR>lNum:ポート番号(0〜255)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_PortPrefix">ポートプリフィックスイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateEndofTrack">MIDIEvent* MIDIEvent_CreateEndofTrack <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>lTime:絶対時刻</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTempo">MIDIEvent* MIDIEvent_CreateTempo <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lTempo);</A></TD>
  <TD>lTime:絶対時刻<BR>lTempo:テンポ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_Tempo">テンポイベント</A>を生成する。<SPAN CLASS="RED">lTempoの単位は4分音符あたりのマイクロ秒[μ秒／4分音符]である。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateSMPTEOffset">MIDIEvent* MIDIEvent_CreateSMPTEOffset <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lMode, <SPAN CLASS="KEYWORD">long</SPAN> lHour, <SPAN CLASS="KEYWORD">long</SPAN> lMin, <SPAN CLASS="KEYWORD">long</SPAN> lSec, <SPAN CLASS="KEYWORD">long</SPAN> lFrame, <SPAN CLASS="KEYWORD">long</SPAN> lSubFrame);</A></TD>
  <TD>lTime:絶対時刻<BR>lMode:モード(0〜3)<BR>lHour:時間(0〜23)<BR>lMin:分(0〜59)<BR>lSec:秒(0〜59)<BR>lFrame:フレーム(0〜30※)<BR>lSubFrame:サブフレーム(0〜99)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセットイベント</A>を生成する。lModeは、MIDIEVENT_SMPTE24(0)・MIDIEVENT_SMPTE25(1)・MIDIEVENT_SMPTE30D(2)・MIDIEVENT_SMPTE30N(3)のいずれかでなければならない。lFrameの値は、lModeが示すフレーム数未満でなければならない。lSubFrameの値は、<A HREF="#MIDIData_TimeBase">タイムベース</A>に関係なく1/100フレーム単位である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateTimeSignature">MIDIEvent* MIDIEvent_CreateTimeSignature <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lnn, <SPAN CLASS="KEYWORD">long</SPAN> ldd, <SPAN CLASS="KEYWORD">long</SPAN> lcc, <SPAN CLASS="KEYWORD">long</SPAN> lbb);</A></TD>
  <TD>lTime:絶対時刻<BR>lnn:分子<BR>ldd:分母<BR>lcc:1拍あたりのMIDIクロック数<BR>lbb:1拍あたりの32分音符の数</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>を生成する。lnnは拍子記号の分子を指定する。lddは拍子記号の分母が2の何乗であるかを指定する。lccは1拍あたりのMIDIクロック数を指定する。lbbは1拍の長さを32分音符の数で指定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateKeySignature">MIDIEvent* MIDIEvent_CreateKeySignature <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lsf, <SPAN CLASS="KEYWORD">long</SPAN> lmi);</A></TD>
  <TD>lTime:絶対時刻<BR>lsf:#又は♭の数(-7〜+7)<BR>lmi:長調・短調を示す値(0〜1)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>を生成する。lsfは正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。lmiはMIDIEVENT_KEYMAJOR(0)かMIDIEVENT_KEYMINOR(1)のいずれかでなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateSequencerSpecific">MIDIEvent* MIDIEvent_CreateSequencerSpecific <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, char* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>lTime:絶対時刻<BR>pBuf:データ部へのポインタ<BR>lLen:データ部の長さ[バイト]</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_SequencerSpecific">シーケンサー独自のイベント</A>を生成する。データ部の1バイト目はメーカー名を表す識別番号である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNoteOff">MIDIEvent* MIDIEvent_CreateNoteOff <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVel:ベロシティ(離鍵速度)(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>を生成する。この関数は、<A HREF="#MIDIEvent_CreateNoteOn">MIDIEvent_CreateNoteOn</A>と対に使わなければならない。ノートオンイベントとノートオフイベントの両方を生成する場合は、<A HREF="#MIDIEvent_CreateNote">MIDIEvent_CreateNote</A>を使うべきである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNoteOn">MIDIEvent* MIDIEvent_CreateNoteOn <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVel:ベロシティ(打鍵速度)(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>を生成する。ベロシティが0のノートオンイベントは、ノートオフイベントとして機能する。この関数は、<A HREF="#MIDIEvent_CreateNoteOff">MIDIEvent_CreateNoteOff</A>と対に使われなければならない。ノートオンイベントとノートオフイベントの両方を生成する場合は、<A HREF="#MIDIEvent_CreateNote">MIDIEvent_CreateNote</A>を使うべきである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateKeyAftertouch">MIDIEvent* MIDIEvent_CreateKeyAftertouch <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー値(0〜127)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateControlChange">MIDIEvent* MIDIEvent_CreateControlChange <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lNum, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lNum:コントロールナンバー(0〜127)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateProgramChange">MIDIEvent* MIDIEvent_CreateProgramChange <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lNum:プログラムナンバー(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ProgramChange">プログラムチェンジイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateChannelAftertouch">MIDIEvent* MIDIEvent_CreateChannelAftertouch <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lVal:値(0〜127)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチイベント</A>を生成する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreatePitchBend">MIDIEvent* MIDIEvent_CreatePitchBend <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lVal:値(0〜16383)</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_PitchBend">ピッチベンドイベント</A>を生成する。値は8192が中央(デフォルト)であることに注意。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateSysExEvent">MIDIEvent* MIDIEvent_CreateSysExEvent <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">unsigned char</SPAN>* pBuf, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>lTime:絶対時刻<BR>unsigned char* pBuf:データ部へのポインタ<BR>lLen:データ部の長さ</TD>
  <TD>正常終了：MIDIイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A>を生成する。データ部は通常、0xF0で始まり、0xF7で終わらなければならないが、長いシステムエクスクルーシブデータを複数のイベントに分割する場合はこの限りでない。<A HREF="#MIDIEvent_SysExTable">SysExイベントの種類</A>が0xF0になるか0xF7になるかは、データ部の先頭バイトの値によって自動的に判別される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNoteOnNoteOff">MIDIEvent* MIDIEvent_CreateNoteOnNoteOff <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel1, <SPAN CLASS="KEYWORD">long</SPAN> lVel2, <SPAN CLASS="KEYWORD">long</SPAN> lDur);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー番号(0〜127)<BR>lVel1:ノートオンイベントのベロシティ(打鍵速度)(1〜127)<BR>lVel2:ノートオフイベントのベロシティ(離鍵速度)(0〜127)<BR>lDur:長さ(1〜)</TD>
  <TD>正常終了：ノートオンイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>ベロシティ(打鍵速度)が1以上の<A HREF="#MIDIEvent_NoteOn">ノートオン</A>、及びベロシティ(離鍵速度)が0以上の<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>の2つのイベントを生成し、ノートオンイベントへのポインタを返す。生成された2つのイベントはポインタで接続されており、<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>として扱える。生成されるノートオフイベントは、イベントの種類が0x80台のノートオフである。ノートオンとノートオフのベロシティは、それぞれlVel1,lVel2となる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNoteOnNoteOn0">MIDIEvent* MIDIEvent_CreateNoteOnNoteOn0 <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel, <SPAN CLASS="KEYWORD">long</SPAN> lDur);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー番号(0〜127)<BR>lVel:ノートオンイベントのベロシティ(打鍵速度)(1〜127)<BR>lDur:長さ(1〜)</TD>
  <TD>正常終了：ノートオンイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>ベロシティ(打鍵速度)が1以上の<A HREF="#MIDIEvent_NoteOn">ノートオン</A>、及びベロシティ(打鍵速度)が0の<A HREF="#MIDIEvent_NoteOn">ノートオン</A>の2つのイベントを生成し、ノートオンイベントへのポインタを返す。生成された2つのイベントはポインタで接続されており、<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>として扱える。ベロシティが0のノートオンは、ノートオフと同じ意味である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNote">MIDIEvent* MIDIEvent_CreateNote <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lKey, <SPAN CLASS="KEYWORD">long</SPAN> lVel, <SPAN CLASS="KEYWORD">long</SPAN> lDur);</A></TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lKey:キー番号(0〜127)<BR>lVel:ノートオンイベントのベロシティ(1〜127)<BR>lDur:長さ(1〜)</TD>
  <TD>正常終了：ノートオンイベントへのポインタ<BR>異常終了：NULL</TD>
  <TD>MIDIEvent_CreateNoteOnNoteOn0と同じ。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreatePatchChange">MIDIEvent* MIDIEvent_CreatePatchChange <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC0, <SPAN CLASS="KEYWORD">long</SPAN> lCC32, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A><BR>(※非推奨)</TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC0:CC#0(Bank Select MSB)の値(0〜127)<BR>lCC32:CC#32(Bank Select LSB)の値(0〜127)lNum:パッチ番号(0〜127)</TD>
  <TD>正常終了：CC#0へのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#0(Bank Select MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#32(Bank Select LSB)</A>、<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>の3つのイベントを生成し、コントロールチェンジCC#0(Bank Select MSB)へのポインタを返す。生成された3つのイベントはポインタで接続されており、<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>として扱える。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateRPNChange">MIDIEvent* MIDIEvent_CreateRPNChange <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC101, <SPAN CLASS="KEYWORD">long</SPAN> lCC100, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A><BR>(※非推奨)</TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC101:CC#101(RPN MSB)の値(0〜127)<BR>lCC100:CC#100(RPN LSB)の値(0〜127)<BR>lVal:設定値(0〜127)</TD>
  <TD>正常終了：CC#101へのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#101(RPN MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#100(RPN LSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#6(Data Entry)</A>の3つのイベントを生成し、コントロールチェンジCC#101へのポインタを返す。生成された3つのイベントはポインタで接続されており、<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>として扱える。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_CreateNRPNChange">MIDIEvent* MIDIEvent_CreateNRPNChange <BR>(<SPAN CLASS="KEYWORD">long</SPAN> lTime, <SPAN CLASS="KEYWORD">long</SPAN> lCh, <SPAN CLASS="KEYWORD">long</SPAN> lCC99, <SPAN CLASS="KEYWORD">long</SPAN> lCC98, <SPAN CLASS="KEYWORD">long</SPAN> lVal);</A><BR>(※非推奨)</TD>
  <TD>lTime:絶対時刻<BR>lCh:チャンネル番号(0〜15)<BR>lCC98:CC#99(NRPN MSB)の値<BR>lCC98:CC#98(NRPN LSB)の値<BR>lVal:設定値(0〜127)</TD>
  <TD>正常終了：CC#99へのポインタ<BR>異常終了：NULL</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#99(NRPN MSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#98(NRPN LSB)</A>、<A HREF="#MIDIEvent_ControlChange">コントロールチェンジCC#6(Data Entry)</A>の3つのイベントを生成し、コントロールチェンジCC#99へのポインタを返す。生成された3つのイベントはポインタで接続されており、<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>として扱える。</TD>
 </TR>
</TABLE>




<H3><A NAME="MIDIEvent_DeleteFunction">4-5.MIDIイベントの削除</A></H3>

<P>　MIDIイベントをメモリ上から削除するには、MIDIEvent_Delete系関数を使う。</P>

<P>　<SPAN CLASS="RED"><A HREF="#MIDIEvent_CreateFunction">MIDIEvent_Create系関数</A>で生成したイベントは、使い終わったら必ずMIDIEvent_Delete系関数で削除しなければならない。ただし、親のMIDIトラックが削除された場合、またはその親のMIDIデータが削除された場合は、この限りでない。</SPAN></P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_DeleteFunctionList">▼List4-5.MIDIEvent_Delete系関数の使い方</A></DIV>
<PRE>
	...
	<SPAN CLASS="COMMENT">/* MIDIイベントの削除 */</SPAN>
	MIDIEvent_Delete (pMIDIEvent);
	pMIDIEvent = NULL;
</PRE>

<P></P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_DeleteFunctionTable">▼Table4-5.MIDIEvent_Delete系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Delete"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_Delete <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>正常終了：削除したMIDIイベントの数(1以上)<BR>異常終了：0</TD>
  <TD>指定したMIDIイベントを削除する。<SPAN CLASS="RED">指定MIDIイベントが他のMIDIイベントと結合している場合、結合しているMIDIイベントも同時に削除する。すなわち、2つ以上のMIDIイベントが削除されることがある。</SPAN>また、前後のMIDIイベントのポインタをつなぎ替え、MIDIトラック内の双方向リンクリストを正常に保つ。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_DeleteSingle"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_DeleteSingle <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD>指定したMIDIイベントを削除する。<SPAN CLASS="RED">指定MIDIイベントが他のMIDIイベントと結合している場合、結合を切り離し、指定したイベントのみを削除する。すなわち、2つ以上のMIDIイベントが削除されることはない。</SPAN>また、前後のMIDIイベントのポインタをつなぎ替え、MIDIトラック内の双方向リンクリストを正常に保つ。</TD>
 </TR>
</TABLE>



<H3><A NAME="MIDIEvent_IsFunction">4-6.MIDIイベントの状態検査</A></H3>

<P>　MIDIイベントの種類や状態を調べるには、MIDIEvent_Is系関数が便利である。MIDIEvent_Is系関数は、あらゆる種類のMIDIイベントに対して使用することができる。これらの関数は、「はい」のとき1を、「いいえ」のとき0を返す。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_IsFunctionTable">▼Table4-6.Is系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsMetaEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsMetaEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_MetaEvent">メタイベント</A>(0x00〜0x7F)であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsSequenceNumber"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsSequenceNumber <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_SequenceNumber">シーケンス番号イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsTextEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsTextEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TextEvent">テキストイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsCopyrightNotice"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsCopyrightNotice <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsTrackName"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsTrackName <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TrackName">シーケンス名／トラック名イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsInstrumentName"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsInstrumentName <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsLyric"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsLyric <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_Lyric">歌詞イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsMarker"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsMarker <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_Marker">マーカーイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsCuePoint"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsCuePoint <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TrackName">キューポイントイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsProgramName"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsProgramName <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TrackName">プログラム名イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsDeviceName"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsDeviceName <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsChannelPrefix"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsChannelPrefix <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックスイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsPortPrefix"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsPortPrefix <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_PortPrefix">ポートプリフィックスイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsEndofTrack"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsEndofTrack <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TrackName">エンドオブトラックイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsTempo <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_Tempo">テンポ設定イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsSMPTEOffset"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsSMPTEOffset <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセットイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsTimeSignature <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsKeySignature <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsSequencerSpecific"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsSequencerSpecific <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_SequencerSpecific">シーケンサー独自のイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsMIDIEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsMIDIEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsNoteOff"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNoteOff <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>であるかどうか調べる。ノートオンイベントでもベロシティが0のものはノートオフイベントであるとみなす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsNoteOn"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNoteOn <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>であるかどうか調べる。ノートオンイベントでもベロシティが0のものはノートオフイベントであるとみなす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsKeyAftertouch"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsKeyAftertouch <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsProgramChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsProgramChange <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_ProgramChange">プログラムチェンジイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsControlChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsControlChange <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_ControlChange">コントロールチェンジイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsChannelAftertouch"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsChannelAftertouch <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsPitchBend"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsPitchBend <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_PitchBend">ピッチベンドイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsSysExEvent"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsSysExEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD><A HREF="#MIDIEvent_SysExEvent">システムエクスクルーシブイベント</A>であるかどうか調べる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsFloating"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsFloating <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>MIDIイベントが<A HREF="#MIDIEvent_FloatingEvent">浮遊</A>しているかどうか調べる。この関数はあらゆるイベントに対して使うことができる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsCombined"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsCombined <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>MIDIイベントが他のMIDIイベントに<A HREF="#MIDIEvent_CombinedEvent">結合</A>しているかどうか調べる。この関数はあらゆるイベントに対して使うことができる。</TD>
 </TR>

 <TR>
  <TD><A NAME="MIDIEvent_IsNoteOnNoteOff"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNoteOnNoteOff <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_NoteOnNoteOff">ノートオン+ノートオフ</A>イベントであるかどうか調べる。ノートオンイベント・ノートオフイベントのどちらに対して使ってもよい。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsNoteOnNoteOn0"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNoteOnNoteOn0 <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_NoteOnNoteOn0">ノートオン+ノートオン0</A>イベントであるかどうか調べる。ノートオンイベント・ノートオン0のどちらに対して使ってもよい。</TD>
 </TR>

 <TR>
  <TD><A NAME="MIDIEvent_IsNote"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNote <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_NoteOnNoteOff">ノートオン+ノートオフ</A>又は結合された<A HREF="#MIDIEvent_NoteOnNoteOn0">ノートオン+ノートオン0</A>であるかどうか調べる。すなわち、結合されたノートイベントであればいずれにしても1を返し、そうでなければ0を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsPatchChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsPatchChange <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_PatchChange">パッチチェンジイベント</A>であるかどうか調べる。CC#0,CC#32,プログラムチェンジイベントのいずれに対して使ってもよい。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsRPNChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsRPNChange <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_RPNChange">RPNチェンジイベント</A>であるかどうか調べる。CC#101,CC#100,CC#6イベントのいずれに対して使ってもよい。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_IsNRPNChange"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_IsNRPNChange <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>はい=1<BR>いいえ=0</TD>
  <TD>結合された<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジイベント</A>であるかどうか調べる。CC#99,CC#98,CC#6イベントのいずれに対して使ってもよい。</TD>
 </TR>
</TABLE>

<H3><A NAME="MIDIEvent_GetFunction">4-7.MIDIイベントの情報取得</A></H3>

<P>　MIDIイベントの各種情報(プロパティ)を安全に取得するには、MIDIEvent_Get系関数を使う。<SPAN CLASS="RED">一部のGet系関数は、特定の種類のMIDIイベントに対してしか適用できない。</SPAN>このような関数の場合は、先に<A HREF="#MIDIEvent_GetKind">MIDIEvent_GetKind</A>で種類を調べる必要がある。誤った種類のMIDIイベントに対して使用した場合の結果は未定義である。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_GetFunctionTable">▼Talbe4-7.Get系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetTime <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>イベントの時刻</TD>
  <TD>MIDIイベントの<A HREF="#MIDIEvent_FieldTable">時刻</A>を返す。この値は前のイベントからの差分ではなく、絶対時刻である。時刻の単位はTPQNベースの場合[ティック]、SMPTEベースの場合[サブフレーム]である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetKind"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetKind <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD><A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A>を示す識別番号(0x00〜0xFF)</TD>
  <TD><A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A>を示す識別番号を返す。識別番号は、MIDIEVENT_SEQUENCENUMBER(0x00)〜MIDIEVENT_SYSEXSTART(0xF7)である。読み込んだMIDIデータによっては、<A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A>で定義されていない識別番号を返す場合もあるが、あなたのプログラムはこのイベントを無視するか、適切な処置をしなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetLen"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetLen <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>データ部の長さ[バイト]</TD>
  <TD>データ部の長さを返す。実際にはこの関数が返す値以上の長いメモリが確保されている場合もあるが、データ部として扱ってよいのはこの関数が返す長さまでである。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetData"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetData <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">unsigned char</SPAN>* pData, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pData:取り込み用バッファへのポインタ<BR>lLen:取り込む最大長さ[バイト]</TD>
  <TD>取り込んだバイト数</TD>
  <TD>イベントのデータ部を取り込む。この関数は、生のデータ部をそのままpDataへコピーする。MIDIイベントのデータ部がlLenより短い場合、pDataが示すバッファの余った部分の値は未定義であるが、正常に終了する。MIDIイベントのデータ部がlLenより長い場合、lLen分だけ取り込まれ、残りは捨てられる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetCharCode"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetCharCode <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_NOCHARCODELATIN, MIDIEVENT_NOCHARCODEJP, MIDIEVENT_NOCHARCODEUTF16LE, MIDIEVENT_NOCHARCODEUTF16BE, MIDIEVENT_NOCHARCODEUTF8, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE, MIDIEVENT_UTF8)</TD>
  <TD>イベントの文字コードを取得する。この関数は、<A HREF="#MIDIEvent_TextEvent">テキスト</A>・<A HREF="#MIDIEvent_CopyrightNotice">著作権</A>・<A HREF="#MIDIEvent_TrackName">シーケンス名／トラック名</A>・<A HREF="#MIDIEvent_InstrumentName">インストゥルメント名</A>・<A HREF="#MIDIEvent_Lyric">歌詞</A>・<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_DeviceName">デバイス名</A>・<A HREF="#MIDIEvent_ProgramName">プログラム名</A>に対してのみ適用できる。文字列の先頭に{@LATIN}又は{@JP}又は{0xFF, 0xFE}又は{0xFE, 0xFF}又は{0xEF, 0xBB, 0xBF}(以下識別子と呼ぶ)が付与されている場合、識別子に基づき文字コードが判別される。文字列の先頭に識別子が付与されていない場合、直近の同種のイベントの識別子に基づき判別され、MIDIEVENT_NOCHARCODELATIN又はMIDIEVENT_NOCHARCODEJP又はMIDIEVENT_NOCHARCODEUTF16LE又はMIDIEVENT_NOCHARCODEUTF16BE又はMIDIEVENT_NOCHARCODEUTF8が返される。それもない場合はMIDIEVENT_NOCHARCODEが返される。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetText">TCHAR* MIDIEvent_GetText <BR>(MIDIEvent* pMIDIEvent, TCHAR* pData, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pData:取り込み用バッファへのポインタ<BR>lLen:取り込む最大長さ[文字]</TD>
  <TD>pBuf</TD>
  <TD>イベントの文字列を取り込む。この関数は、<A HREF="#MIDIEvent_TextEvent">テキスト</A>・<A HREF="#MIDIEvent_CopyrightNotice">著作権</A>・<A HREF="#MIDIEvent_TrackName">シーケンス名／トラック名</A>・<A HREF="#MIDIEvent_InstrumentName">インストゥルメント名</A>・<A HREF="#MIDIEvent_Lyric">歌詞</A>・<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_DeviceName">デバイス名</A>・<A HREF="#MIDIEvent_ProgramName">プログラム名</A>に対してのみ適用できる。データ部の先頭に{@LATIN}又は{@JP}又は{0xFF, 0xFE}又は{0xFE, 0xFF}(以下識別子と呼ぶ)が付与されている場合、識別子に基づき文字コードが判断され、必要に応じてテキストエンコードして取得する。データ部の先頭に識別子が付与されていない場合、直近の同種のイベントの識別子に基づき、それもない場合はMIDIDataLib_SetDefaultCharCodeで指定した値に基づき、必要に応じてテキストエンコードして取得する。取得した文字列には、識別子がついていた場合、識別子が含まれる。ただし、{0xFF, 0xFE}と{0xFE, 0xFF}と{0xEF, 0xBB, 0xBF}の識別子はそれぞれ{@UTF-16LE}と{@UTF-16BE}と{@UTF-8}に変換される。その他の場合は識別子は含まれない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetTempo <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>テンポ</TD>
  <TD>テンポイベントのテンポ値を返す。<SPAN CLASS="RED">テンポの単位は4分音符当たりのマイクロ秒[μ秒/4分音符]である。</SPAN>この関数は、<A HREF="#MIDIEvent_Tempo">テンポ設定イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetSMPTEOffset"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetSMPTEOffset <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN>* pMode, <SPAN CLASS="KEYWORD">long</SPAN>* pHour, <SPAN CLASS="KEYWORD">long</SPAN>* pMin, <SPAN CLASS="KEYWORD">long</SPAN>* pSec, <SPAN CLASS="KEYWORD">long</SPAN>* pFrame, <SPAN CLASS="KEYWORD">long</SPAN>* pSubFrame);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pMode:モード(0〜3)を格納するバッファへのポインタ<BR>pHour:時間(0〜23)を格納するバッファへのポインタ<BR>pMin:分(0〜59)を格納するバッファへのポインタ<BR>pSec:秒(0〜59)を格納するバッファへのポインタ<BR>pFrame:フレーム(0〜30※)を格納するバッファへのポインタ<BR>pSubFrame:サブフレーム(0〜99)を格納するバッファへのポインタ</TD>
  <TD>正常終了：1<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>を調べ、各バッファに格納する。pModeの指す値は、MIDIEVENT_SMPTE24(0)・MIDIEVENT_SMPTE25(1)・MIDIEVENT_SMPTE30D(2)・MIDIEVENT_SMPTE30N(3)のいずれかとなる。pSubFrameの指す値は、<A HREF="#MIDIData_TimeBase">タイムベース</A>に関係なく1/100フレーム単位である。この関数は、<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセットイベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetTimeSignature <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN>* pnn, <SPAN CLASS="KEYWORD">long</SPAN>* pdd, <SPAN CLASS="KEYWORD">long</SPAN>* pcc, <SPAN CLASS="KEYWORD">long</SPAN>* pbb);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pnn:分子を格納するバッファへのポインタ<BR>pdd:分母を格納するバッファへのポインタ<BR>pcc:1拍あたりのMIDIクロック数を格納するバッファへのポインタ<BR>pbb:1拍当たりの32分音符の数を格納するバッファへのポインタ</TD>
  <TD>正常終了:0以外<BR>異常終了:0</TD>
  <TD>拍子記号イベントの拍子記号を調べ、各バッファに格納する。pnnの指す値は拍子記号の分子を表す。pddの指す値は拍子記号の分母が2の何乗にであるかを表す。pccの指す値は1拍あたりのMIDIクロック数を表す。pbbの指す値は1拍の長さを32分音符の数で表す。この関数は、<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetKeySignature <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN>* psf, <SPAN CLASS="KEYWORD">long</SPAN>* pmi);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>psf:#又は♭の数を格納するバッファへのポインタ<BR>pmi:長調か短調かを格納するバッファへのポインタ</TD>
  <TD>正常終了:0以外<BR>異常終了:0</TD>
  <TD>調性記号イベントの調性記号を調べ、各バッファに格納する。psfの指す値は正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。pmiの指す値はMIDIEVENT_KEYMAJOR(0)かMIDIEVENT_KEYMINOR(1)のいずれとなる。この関数は、<A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetMIDIMessage"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetMIDIMessage <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">char</SPAN>* pMessage, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pMessage:取り込み用バッファへのポインタ<BR>lLen:取り込む最大長さ[バイト]</TD>
  <TD>取り込んだバイト数</TD>
  <TD>イベントのMIDIメッセージを取り込む。この関数は、MIDIチャンネルイベントとシステムエクスクルーシヴイベントに対してのみ使えるという点を除いては、<A HREF="#MIDIEvent_GetData">MIDIEvent_GetData</A>と全く同じ働きをする。MIDIイベントのデータ部がlLenより短い場合、pMessageが示すバッファの余った部分の値は未定義であるが、正常に終了する。MIDIイベントのデータ部がlLenより長い場合、lLen分だけ取り込まれ、残りは捨てられる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetChannel <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>チャンネル(0〜15)</TD>
  <TD>イベントのチャンネル(0〜15)返す。この関数は、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>(=<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>・<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>・<A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチ</A>・<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>)に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetKey"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetKey <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>キー(0〜127)</TD>
  <TD>イベントのキー(0〜127)を返す。この関数は、<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetVelocity"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetVelocity <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>ベロシティ(0〜127)</TD>
  <TD>イベントのベロシティ(0〜127)を返す。この関数は、<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>に対してのみ使用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetDuration"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetDuration <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>音長さ[ティック]又は[サブフレーム]</TD>
  <TD>イベントの音長さを返す。音長さの単位は<A HREF="#MIDIData_TimeBase">タイムモード</A>により[ティック]又は[サブフレーム]となる。この関数は、結合されている<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>又は結合されている<A HREF="#MIDIEvent_NoteOn">ノートオン</A>に対してのみ適用できる。結合されている<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>に対しては、戻り値は正の値である。結合されている<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>に対しては、戻り値は負の値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetNumber"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetNumber <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>イベントのナンバー (0〜15, 0〜127, 0〜255, 0〜16383, 0〜65535)</TD>
  <TD><A HREF="#MIDIEvent_SequenceNumber">シーケンス番号</A>に対して使われた場合、シーケンス番号(0〜65535)を返す。<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックス</A>に対して使われた場合、チャンネル番号(0〜15)を返す。<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>に対して使われた場合、ポート番号(0〜255)を返す。<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>に対して使われた場合、コントロールナンバー(0〜127)を返す。<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>に対して使われた場合、プログラムナンバー(0〜127)を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetValue"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetValue <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>イベントの設定値 (0〜15, 0〜127, 0〜255, 0〜16383, 0〜65535)</TD>
  <TD>イベントの設定値を返す。この関数は、<A HREF="#MIDIEvent_SequenceNumber">シーケンス番号</A>・<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックス</A>・<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>・<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>・<A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチ</A>・<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>に対して適用できる。<A HREF="#MIDIEvent_SequenceNumber">シーケンス番号</A>・<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックス</A>・<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>の場合の戻り値は、<A HREF="#MIDIEvent_GetNumber">MIDIEvent_GetNumber</A>と同じである。<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>の場合の戻り値は0〜16383であり、中央値が8192である。その他の種類のイベントでは戻り値は0〜127である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetBank"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetBank <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>バンク(0〜16383)</TD>
  <TD>結合イベントのバンクを返す。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンクとは、(CC#0の設定値×128+CC#32の設定値)である。RPNのバンクとは、(CC#101の設定値×128+CC#100の設定値)である。NRPNのバンクとは、(CC#99の設定値×128+CC#98の設定値)である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetBankMSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetBankMSB <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>バンク上位(MSB)(0〜127)</TD>
  <TD>結合イベントのバンク上位(MSB)を返す。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンク上位(MSB)とは、CC#0の設定値である。RPNのバンク上位(MSB)とは、CC#101の設定値である。NRPNのバンク上位(MSB)とは、CC#99の設定値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetBankLSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetBankLSB <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>バンク下位(LSB)(0〜127)</TD>
  <TD>結合イベントのバンク下位(LSB)を返す。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンク下位(LSB)とは、CC#32の設定値である。RPNのバンク下位(LSB)とは、CC#100の設定値である。NRPNのバンク下位(LSB)とは、CC#98の設定値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetDataEntryMSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetDataEntryMSB <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>データエントリーMSB(CC#6の値)(0〜127)</TD>
  <TD>RPNチェンジイベント・NRPNチェンジイベントのデータエントリーMSB(CC#6の値)を返す。この関数は、<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetPatchNum"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_GetPatchNum <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>プログラムナンバーの値(0〜127)</TD>
  <TD>パッチチェンジチェンジイベントのプログラムナンバーを返す。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetNextEvent">MIDIEvent* MIDIEvent_GetNextEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>次のMIDIイベントへのポインタ</TD>
  <TD>次のMIDIイベントへのポインタを返す。次のMIDIイベントがなければNULLを返す。次のイベントがないということは、このイベントがトラック内の最後のイベントであるか、このイベントがどのトラックにも属していないことを意味する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetPrevEvent">MIDIEvent* MIDIEvent_GetPrevEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>前のMIDIイベントへのポインタ</TD>
  <TD>前のMIDIイベントへのポインタを返す。前のMIDIイベントがなければNULLを返す。前のイベントがないということは、このイベントがトラック内の最初のイベントであるか、このイベントがどのトラックにも属していないことを意味する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetNextSameKindEvent">MIDIEvent* MIDIEvent_GetNextSameKindEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>次の同種のMIDIイベントへのポインタ</TD>
  <TD>次の同種のMIDIイベントへのポインタを返す。「同種」とは、イベントの種類が同じであること、具体的には、<A HREF="#MIDIEvent_Kind">「MIDIイベントの種類」</A>で定義する識別番号が一致していることを意味する。MIDIチャンネルイベントの場合、チャンネル番号が異なれば異種である。次の同種のMIDIイベントがなければNULLを返す。この関数は、MIDIEvent_GetNextEventで次の同種のイベントを探すより高速である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetPrevSameKindEvent">MIDIEvent* MIDIEvent_GetPrevSameKindEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>前の同種のMIDIイベントへのポインタ</TD>
  <TD>前の同種のMIDIイベントへのポインタを返す。「同種」とは、イベントの種類が同じであること、具体的には、<A HREF="#MIDIEvent_Kind">「MIDIイベントの種類」</A>で定義する識別番号が一致していることを意味する。MIDIチャンネルイベントの場合、チャンネル番号が異なれば異種である。前の同種のMIDIイベントがなければNULLを返す。この関数は、MIDIEvent_GetPrevEventで前の同種のイベントを探すより高速である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetFirstCombinedEvent">MIDIEvent* MIDIEvent_GetFirstCombinedEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>結合イベントの最初のイベントへのポインタ</TD>
  <TD>pMIDIEventが<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>の場合、結合している最初のイベントへのポインタを返す。pMIDIEventが結合イベントでない場合、pMIDIEvent自身を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetLastCombinedEvent">MIDIEvent* MIDIEvent_GetLastCombinedEvent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>結合イベントの最後のイベントへのポインタ</TD>
  <TD>pMIDIEventが<A HREF="#MIDIEvent_CombinedEvent">結合イベント</A>の場合、結合している最後のイベントへのポインタを返す。pMIDIEventが結合イベントでない場合、pMIDIEvent自身を返す。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_GetParent">MIDITrack* MIDIEvent_GetParent <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>親のMIDIトラックへのポインタ</TD>
  <TD>このMIDIイベントが含まれる<A HREF="#MIDITrack">MIDIトラック</A>へのポインタを返す。なければNULLを返す。NULLを返すということは、このイベントがどのトラックにも属していないことを意味する。</TD>
 </TR>
</TABLE>


<H3><A NAME="MIDIEvent_SetFunction">4-8.MIDIイベントの情報設定</A></H3>

<P>　MIDIイベントの各種情報(プロパティ)を安全に設定するには、MIDIEvent_Set系関数を使う。<SPAN CLASS="RED">一部のSet系関数は、特定の種類のMIDIイベントに対してしか適用できない。</SPAN>このような関数の場合は、先に<A HREF="#MIDIEvent_GetKind">MIDIEvent_GetKind</A>で種類を調べる必要がある。誤った種類のMIDIイベントに対して使用した場合の結果は未定義である。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_SetFunctionTable">▼Table4-8.Set系関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetTime"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetTime <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lTime:設定する時刻(0〜0x7FFFFFFF)</TD>
  <TD>正常終了:時刻を設定したMIDIイベントの数(1以上)<BR>異常終了：0</TD>
  <TD>MIDIイベントの<A HREF="#MIDIEvent_FieldTable">時刻</A>を設定する。時刻の計測単位はTPQNベースの場合[ティック]、SMPTEベースの場合[サブフレーム]である。<SPAN CLASS="RED">イベントがトラックに含まれている場合、時間順になるように自動的に双方向リンクリストを更新する。他に同時刻のMIDIイベントがあった場合、同時刻のMIDIイベントの最後に挿入される。指定時刻が<A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>よりも後だった場合、エンドオブトラックイベントは自動的に後方へ移動する。pMIDIEventが他のMIDIイベントに結合している場合、結合しているMIDIイベントの時刻も相対的に設定される。例えば、ノートオフに結合しているノートオンイベントに適用した場合、ノートオフの時刻も音長さを維持して変更される。このため、ノートオフのみの時刻を設定したい場合は、<A HREF="#MIDIEvent_SetDuration">MIDIEvent_SetDuration</A>を使う。すなわち、結合しているMIDIイベントに対しては、結合しているMIDIイベントの先頭のひとつだけに対して適用すれば十分であり、残りMIDIイベントに対してこの関数を使う必要はないし、むしろ、この関数をイベント時刻の移動のために使っている場合は、過剰に移動させてしまう結果をもたらす。この関数を<A HREF="#MIDITrack_forEachEvent">forEachEvent</A>内又は<A HREF="#MIDITrack_forEachEvent">forEachEventInverse</A>内で使うのは危険である。なぜなら、イベントの順序がforループ中で変化してしまうと、正しい順序で評価することが不可能になるからである。必要であれば、まず最初にすべてのイベントへのポインタをローカル配列にコピーし、ローカル配列のポインタに対してこの関数を適用するべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetTimeSingle"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetTimeSingle <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lTime);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lTime:設定する時刻(0〜0x7FFFFFFF)</TD>
  <TD>正常終了:1<BR>異常終了：0</TD>
  <TD>MIDIイベントの<A HREF="#MIDIEvent_FieldTable">時刻</A>を設定する。時刻の単位はTPQNベースの場合[ティック]、SMPTEベースの場合[サブフレーム]である。<SPAN CLASS="RED">イベントがトラックに含まれている場合、時間順になるように自動的に双方向リンクリストを更新する。他に同時刻のMIDIイベントがあった場合、同時刻のMIDIイベントの最後に挿入される。指定時刻が<A HREF="#MIDIEvent_EndofTrack">エンドオブトラックイベント</A>よりも後だった場合、エンドオブトラックイベントは自動的に後方へ移動する。pMIDIEventが他のMIDIイベントに結合している場合、結合している他のMIDIイベントの時刻は操作されない。例えば、ノートオフに結合しているノートオンイベントに適用した場合、ノートオフの時刻は変更されない。このため、この関数は、結合イベントの順序が正しくなるように、注意深く扱わなければならない。特に、ノートイベントを扱う場合は、先にノートオンイベントを移動し、次にノートオンイベントより後方にノートオフイベントを移動しなければならない。この関数を<A HREF="#MIDITrack_forEachEvent">forEachEvent</A>内又は<A HREF="#MIDITrack_forEachEvent">forEachEventInverse</A>内で使うのは危険である。なぜなら、イベントの順序がforループ中で変化してしまうと、正しい順序で評価することが不可能になるからである。必要であれば、まず最初にすべてのイベントへのポインタをローカル配列にコピーし、ローカル配列のポインタに対してこの関数を適用するべきである。</SPAN></TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetKind"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetKind <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lKind);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lKind:MIDIイベントの種類を表す識別番号</TD>
  <TD><A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A></TD>
  <TD><A HREF="#MIDIEvent_Kind">MIDIイベントの種類</A>を任意に設定する。識別番号は、MIDIEVENT_SEQUENCENUMBER(0x00)〜MIDIEVENT_SYSEXSTART(0xF7)である。<SPAN CLASS="RED">いったんイベントの種類を設定するとデータ部は自動的に破壊されることがある。データ部の整合性のチェックはしない。</SPAN>この関数使用直後は、直ちにデータ部に公正な値をセットするべきである。  
  </TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetData"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetData <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">char</SPAN>* pData, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pData:設定データを含むバッファへのポインタ<BR>lLen:設定する長さ[バイト]</TD>
  <TD>設定したバイト数</TD>
  <TD>イベントのデータ部を任意に設定する。この関数は、そのままpDataをそのままデータ部にコピーする。MIDIイベントのデータ部がlLenより短い場合、自動的にメモリ領域を拡張する。この関数は、データ部の整合性のチェックはしない。この関数は大変危険であるので、ほとんど使ってはならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetCharCode"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetCharCode <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lCharCode);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lCharCode:文字コード(MIDIEVENT_NOCHARCODE, MIDIEVENT_LATIN, MIDIEVENT_JP, MIDIEVENT_UTF16LE, MIDIEVENT_UTF16BE, MIDIEVENT_UTF8)</TD>
  <TD>正常終了:0以外<BR>異常終了:0</TD>
  <TD>イベントの文字コードを変更する。この関数は、<A HREF="#MIDIEvent_TextEvent">テキスト</A>・<A HREF="#MIDIEvent_CopyrightNotice">著作権</A>・<A HREF="#MIDIEvent_TrackName">シーケンス名／トラック名</A>・<A HREF="#MIDIEvent_InstrumentName">インストゥルメント名</A>・<A HREF="#MIDIEvent_Lyric">歌詞</A>・<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_DeviceName">デバイス名</A>・<A HREF="#MIDIEvent_ProgramName">プログラム名</A>に対してのみ適用できる。lCharCodeがMIDIEVENT_NOCHARCODE以外の場合、既存の識別子は削除され、新しい識別子が付与され、それに従って必要に応じて再エンコードされる。lCharCodeがMIDIEVENT_NOCHARCODEの場合、既存の識別子は削除され、直近の同種のイベントの識別子に従って、必要に応じてテキストエンコードされる。文字コードが変更された場合、後続の同種のイベントのテキストエンコード方法にも影響を及ぼす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetText"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetText <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">const</SPAN> TCHAR* pszText);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pszText:ヌル終了文字列へのポインタ<BR></TD>
  <TD>正常終了:0以外<BR>異常終了:0</TD>
  <TD>イベントの文字列を設定する。この関数は、<A HREF="#MIDIEvent_TextEvent">テキスト</A>・<A HREF="#MIDIEvent_CopyrightNotice">著作権</A>・<A HREF="#MIDIEvent_TrackName">シーケンス名／トラック名</A>・<A HREF="#MIDIEvent_InstrumentName">インストゥルメント名</A>・<A HREF="#MIDIEvent_Lyric">歌詞</A>・<A HREF="#MIDIEvent_Marker">マーカー</A>・<A HREF="#MIDIEvent_CuePoint">キューポイント</A>・<A HREF="#MIDIEvent_DeviceName">デバイス名</A>・<A HREF="#MIDIEvent_ProgramName">プログラム名</A>に対してのみ適用できる。指定文字列の先頭が{@LATIN}又は{@JP}又は{@UTF-16LE}又は{@UTF-16BE}又は{@UTF-8}で始まる場合は、それに基づき文字コードが決定され、必要に応じてテキストエンコーディングされ、データ部の先頭に識別子が付与される({@UTF16-LE}と{@UTF-16BE}はそれぞれ{0xFF, 0xFE}と{0xFE, 0xFF}と{0xEF, 0xBB, 0xBF}に変換される)。指定文字列の先頭に識別子がない場合、直近の同種のイベントの識別子に従って、必要に応じてテキストエンコードされる。それもない場合、MIDIDataLib_SetDefaultCharCodeで指定した値に基づき、必要に応じてテキストエンコードされる。文字コードが変更された場合、後続の同種のイベントのテキストエンコード方法にも影響を及ぼす。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetTempo"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetTempo <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lTempo);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントのテンポ値を設定する。<SPAN CLASS="RED">テンポの単位は4分音符当たりのマイクロ秒[μ秒/4分音符]である。</SPAN>この関数は、<A HREF="#MIDIEvent_Tempo">テンポ設定イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetSMPTEOffset">MIDIEvent* MIDIEvent_SetSMPTEOffset <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN>* pMode, <SPAN CLASS="KEYWORD">long</SPAN> lHour, <SPAN CLASS="KEYWORD">long</SPAN> lMin, <SPAN CLASS="KEYWORD">long</SPAN> lSec, <SPAN CLASS="KEYWORD">long</SPAN> lFrame, <SPAN CLASS="KEYWORD">long</SPAN> lff);</A></TD>
  <TD>lTime:絶対時刻<BR>lMode:モード(0〜3)<BR>lHour:時間(0〜23)<BR>lMin:分(0〜59)<BR>lSec:秒(0〜59)<BR>lFrame:フレーム(0〜30※)<BR>lff:サブフレーム(0〜99)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD><A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセット</A>を設定する。lModeは、MIDIEVENT_SMPTE24(=0)・MIDIEVENT_SMPTE25(=1)・MIDIEVENT_SMPTE30D(=2)・MIDIEVENT_SMPTE30N(=3)のいずれかでなければならない。lFrameは、lModeで示すフレーム数未満でなければならない。lffは、<A HREF="#MIDIData_TimeBase">タイムベース</A>に関係なく1/100フレーム単位である。この関数は、<A HREF="#MIDIEvent_SMPTEOffset">SMPTEオフセットイベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetTimeSignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetTimeSignature <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lnn, <SPAN CLASS="KEYWORD">long</SPAN> ldd, <SPAN CLASS="KEYWORD">long</SPAN> lcc, <SPAN CLASS="KEYWORD">long</SPAN> lbb);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lnn:分子<BR>ldd:分母<BR>lcc:1拍あたりのMIDIクロック数<BR>ldd:1拍あたりの32分音符の数</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントの拍子記号を設定する。lnnは拍子記号の分子を指定する。lddは拍子記号の分母が2の何乗にであるかを指定する。lccは1拍あたりのMIDIクロック数(通常は24)を指定する。lbbは1拍あたりの32分音符の数(通常は8)を指定する。この関数は、<A HREF="#MIDIEvent_TimeSignature">拍子記号イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetKeySignature"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetKeySignature <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lsf, <SPAN CLASS="KEYWORD">long</SPAN> lmi);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lsf:#又は♭の数(-7〜+7)<BR>lmi:長調・短調を示す値(0〜1)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントの調性記号を設定する。lsfは正の値の時シャープの数を、負の値の時はフラットの数を、0のときはシャープもフラットもつかないことを意味する。lmiはMIDIEVENT_KEYMAJOR(=0)かMIDIEVENT_KEYMINOR(=1)のいずれかでなければならない。この関数は、<A HREF="#MIDIEvent_KeySignature">調性記号イベント</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetMIDIMessage"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetMIDIMessage <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">char</SPAN>* pMessage, <SPAN CLASS="KEYWORD">long</SPAN> lLen);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>pData:設定データを含むバッファへのポインタ<BR>lLen:設定する長さ[バイト]</TD>
  <TD>設定したバイト数</TD>
  <TD>イベントのMIDIメッセージを任意に設定する。この関数は、MIDIチャンネルイベントとシステムエクスクルーシヴイベントに対してのみ有効であるという点を除いては、MIDIEvent_SetDataと同じ働きをする。MIDIイベントのデータ部がlLenより短い場合、自動的にメモリ領域を拡張する。この関数は、MIDIメッセージの正当性のチェックはしない。この関数は大変危険であるので、ほとんど使ってはならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetChannel"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetChannel <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lChannel);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lChannel:チャンネル(0〜15)</TD>
  <TD>正常終了:1〜3<BR>異常終了:0</TD>
  <TD>MIDIイベントのチャンネルを設定する。この関数は、<A HREF="#MIDIEvent_MIDIChannelEvent">MIDIチャンネルイベント</A>(=<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>・<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>・<A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチ</A>・<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>)に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetKey"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetKey <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lKey);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lKey:キー(0〜127)</TD>
  <TD>正常終了:1〜3<BR>異常終了:0</TD>
  <TD>MIDIイベントのキー(0〜127)を設定する。この関数は、<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetVelocity"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetVelocity <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lVelocity);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lVelocity:ベロシティ(0〜127)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントのベロシティ(0〜127)を設定する。この関数は、<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>・<A HREF="#MIDIEvent_NoteOn">ノートオン</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetDuration"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetDuration <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lDuration);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lDuration:音長さ</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントの音長さを設定する。音長さの単位は<A HREF="#MIDIData_TimeBase">タイムベース</A>により[ティック]又は[フレーム]となる。この関数は、結合されている<A HREF="#MIDIEvent_NoteOff">ノートオフ</A>または結合されている<A HREF="#MIDIEvent_NoteOn">ノートオン</A>に対してのみ適用できる。結合されている<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>に対しては、音長さは正の値でなければならない。結合されている<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>に対しては、音長さは負の値でなければならない。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetNumber"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetNumber <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lNumber);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lNumber:ナンバー (0〜15, 0〜127, 0〜255, 0〜16383, 0〜65535)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD><A HREF="#MIDIEvent_SequenceNumber">シーケンス番号イベント</A>に対して使われた場合、シーケンス番号(0〜65535)を設定する。<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックスイベント</A>に対して使われた場合、チャンネル番号(0〜15)を設定する。<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックスイベント</A>に対して使われた場合、ポート番号(0〜255)を設定する。<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>に対して使われた場合、コントロールナンバー(0〜127)を設定する。<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>に対して使われた場合、プログラムナンバー(0〜127)を設定する。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetValue"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetValue <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lValue);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lValue:設定値 (0〜15, 0〜127, 0〜255, 0〜16383, 0〜65535)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>MIDIイベントの設定値を返す。この関数は、<A HREF="#MIDIEvent_SequenceNumber">シーケンス番号</A>・<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックス</A>・<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>・<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>・<A HREF="#MIDIEvent_ChannelAftertouch">チャンネルアフタータッチ</A>・<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>に対して適用できる。<A HREF="#MIDIEvent_SequenceNumber">シーケンス番号</A>・<A HREF="#MIDIEvent_ChannelPrefix">チャンネルプリフィックス</A>・<A HREF="#MIDIEvent_PortPrefix">ポートプリフィックス</A>・<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>の場合の設定値は、<A HREF="#MIDIEvent_SetNumber">MIDIEvent_SetNumber</A>と同じである。<A HREF="#MIDIEvent_PitchBend">ピッチベンド</A>の場合の設定値は0〜16383であり、中央値が8192である。その他の種類のイベントでは設定値は0〜127である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetBank"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetBank <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lBank);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lBank:バンク番号(0〜16383)</TD>
  <TD>正常終了:2<BR>異常終了:0</TD>
  <TD>結合イベントのバンクを設定する。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンクとは、(CC#0の設定値×128+CC#32の設定値)である。RPNのバンクとは、(CC#101の設定値×128+CC#100の設定値)である。NRPNのバンクとは、(CC#99の設定値×128+CC#98の設定値)である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetBankMSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetBankMSB <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lBankMSB);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lBankMSB:バンク上位(0〜127)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>結合イベントのバンク上位(MSB)を設定する。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンク上位(MSB)とは、CC#0の設定値である。RPNのバンク上位(MSB)とは、CC#101の設定値である。NRPNのバンク上位(MSB)とは、CC#99の設定値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetBankLSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetBankLSB <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lBankLSB);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lBankLSB:バンク下位(0〜127)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>結合イベントのバンク下位(LSB)を設定する。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。パッチチェンジのバンク下位(LSB)とは、CC#32の設定値である。RPNのバンク下位(LSB)とは、CC#100の設定値である。NRPNのバンク下位(LSB)とは、CC#98の設定値である。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetDataEntryMSB"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetDataEntryMSB <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lDataEntryMSB);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lDataEntryMSB:値上位(0〜127)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>RPNチェンジ・NRPNチェンジイベントのデータエントリーMSB(CC#6の値)を設定する。この関数は、<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>に対してのみ適用できる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_SetPatchNum"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_SetPatchNum <BR>(MIDIEvent* pMIDIEvent, <SPAN CLASS="KEYWORD">long</SPAN> lNum);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ<BR>lNum:プログラムナンバー(0〜127)</TD>
  <TD>正常終了:1<BR>異常終了:0</TD>
  <TD>パッチチェンジイベントのプログラムナンバーを設定する。この関数は、<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>に対してのみ適用できる。</TD>
 </TR>
</TABLE>



<H3><A NAME="MIDIEvent_OtherFunction">4-9.MIDIEventのその他の関数</A></H3>

<P>　MIDIイベントに対するその他の関数をここに示す。</P>

<DIV CLASS="TITLE"><A NAME="MIDIEvent_SetFunctionTable">▼Table4-9.その他の関数一覧</A></DIV>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH WIDTH="25%">関数定義</TH>
  <TH WIDTH="25%">引数</TH>
  <TH WIDTH="10%">戻り値</TH>
  <TH WIDTH="40%">解説</TH>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Combine"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_Combine <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>正常終了：結合したイベントの数(1又は2)<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_CombinedEvent">結合</A>されていないMIDIイベントで、結合できるものがある場合は結合する。この関数は、結合されていない<A HREF="#MIDIEvent_NoteOn">ノートオン</A>イベント、結合されていない<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>イベント、結合されてない<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>イベントのCC#6(Data Entry MSB)に対してのみ使用できる。結合できるイベントがなかった場合は、何もせず0を返す。結合後は、<A HREF="#MIDIEvent_NoteOnNoteOff">ノートオン+ノートオフ</A>・<A HREF="#MIDIEvent_NoteOnNoteOn0">ノートオン+ノートオン0</A>・<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>のいずれかとして扱うことができる。なお、イベントが結合されているかどうかは、<A HREF="#MIDIEvent_IsCombined">MIDIEvent_IsCombined</A>関数で調べることができる。</TD>
 </TR>
 <TR>
  <TD><A NAME="MIDIEvent_Chop"><SPAN CLASS="KEYWORD">long</SPAN> MIDIEvent_Chop <BR>(MIDIEvent* pMIDIEvent);</A></TD>
  <TD>pMIDIEvent:MIDIイベントへのポインタ</TD>
  <TD>正常終了：切り離した回数(1又は2)<BR>異常終了：0</TD>
  <TD><A HREF="#MIDIEvent_CombinedEvent">結合</A>されているMIDIイベントを、バラバラに切り離す。この関数は、結合されているMIDIイベント、すなわち<A HREF="#MIDIEvent_NoteOnNoteOff">ノートオン+ノートオフ</A>・<A HREF="#MIDIEvent_NoteOnNoteOn0">ノートオン+ノートオン0</A>・<A HREF="#MIDIEvent_PatchChange">パッチチェンジ</A>・<A HREF="#MIDIEvent_RPNChange">RPNチェンジ</A>・<A HREF="#MIDIEvent_NRPNChange">NRPNチェンジ</A>のいずれかに対してのみ使用することができる。なお、イベントが結合されているかどうかは、<A HREF="#MIDIEvent_IsCombined">MIDIEvent_IsCombined</A>関数で調べることができる。</TD>
 </TR>
</TABLE>











<H2><A NAME="APPENDIX_A">付録A　よくある質問(F.A.Q)</A></H2>

<P>この項目は非常に古くなったので廃止します。</P>

<H2><A NAME="APPENDIX_B">付録B　キー・ナンバー対応表</A></H2>

<P>ノートキー：<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>・<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>の2バイト目(key)の値。チャンネル10以外(n!=9)の場合。</P>

<P>ドラムキー：<A HREF="#MIDIEvent_NoteOn">ノートオンイベント</A>・<A HREF="#MIDIEvent_NoteOff">ノートオフイベント</A>・<A HREF="#MIDIEvent_KeyAftertouch">キーアフタータッチ</A>の2バイト目(key)の値。チャンネル10(n=9)の場合。ただし、音源によってはチャンネル10以外もドラムにできるものがある。</P>

<P>コントロールチェンジ：<A HREF="#MIDIEvent_ControlChange">コントロールチェンジ</A>の2バイト目(num)の値。</P>

<P>プログラムチェンジ：<A HREF="#MIDIEvent_ProgramChange">プログラムチェンジ</A>の2バイト目(num)の値。</P>

<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH>値</TH>
  <TH>16進</TH>
  <TH>ノートキー</TH>
  <TH>ドラムキー</TH>
  <TH>コントロールチェンジ</TH>
  <TH>プログラムチェンジ</TH>
 </TR>
 <TR>
  <TD>0</TD>
  <TD>0x00</TD>
  <TD>C0</TD>
  <TD>-</TD>
  <TD>Bank Select MSB</TD>
  <TD>Acoustic Grand Piano</TD>
 </TR>
 <TR>
  <TD>1</TD>
  <TD>0x01</TD>
  <TD>C#0=Db0</TD>
  <TD>-</TD>
  <TD>Modulation MSB</TD>
  <TD>Bright Acoustic Piano</TD>
 </TR>
 <TR>
  <TD>2</TD>
  <TD>0x02</TD>
  <TD>D0</TD>
  <TD>-</TD>
  <TD>Breath Controller MSB</TD>
  <TD>Electric Grand Piano</TD>
 </TR>
 <TR>
  <TD>3</TD>
  <TD>0x03</TD>
  <TD>D#0=Eb0</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Honky-tonk Piano</TD>
 </TR>
 <TR>
  <TD>4</TD>
  <TD>0x04</TD>
  <TD>E0</TD>
  <TD>-</TD>
  <TD>Foot Controller MSB</TD>
  <TD>Electric Piano 1</TD>
 </TR>
 <TR>
  <TD>5</TD>
  <TD>0x05</TD>
  <TD>F0</TD>
  <TD>-</TD>
  <TD>Portamento Time MSB</TD>
  <TD>Electric Piano 2</TD>
 </TR>
 <TR>
  <TD>6</TD>
  <TD>0x06</TD>
  <TD>F#0=Gb0</TD>
  <TD>-</TD>
  <TD>Data Entry MSB</TD>
  <TD>Harpsichord</TD>
 </TR>
 <TR>
  <TD>7</TD>
  <TD>0x07</TD>
  <TD>G0</TD>
  <TD>-</TD>
  <TD>Channel Volume MSB</TD>
  <TD>Clavi</TD>
 </TR>
 <TR>
  <TD>8</TD>
  <TD>0x08</TD>
  <TD>G#0=Ab0</TD>
  <TD>-</TD>
  <TD>Balance MSB</TD>
  <TD>Celesta</TD>
 </TR>
 <TR>
  <TD>9</TD>
  <TD>0x09</TD>
  <TD>A0</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Glockenspiel</TD>
 </TR>
 <TR>
  <TD>10</TD>
  <TD>0x0A</TD>
  <TD>A#0=Bb0</TD>
  <TD>-</TD>
  <TD>Pan MSB</TD>
  <TD>Music Box</TD>
 </TR>
 <TR>
  <TD>11</TD>
  <TD>0x0B</TD>
  <TD>B0</TD>
  <TD>-</TD>
  <TD>Expression MSB</TD>
  <TD>Vibraphone</TD>
 </TR>
 <TR>
  <TD>12</TD>
  <TD>0x0C</TD>
  <TD>C1</TD>
  <TD>-</TD>
  <TD>Effect Control 1 MSB</TD>
  <TD>Marimba</TD>
 </TR>
 <TR>
  <TD>13</TD>
  <TD>0x0D</TD>
  <TD>C#1=Db1</TD>
  <TD>-</TD>
  <TD>Effect Control 2 MSB</TD>
  <TD>Xylophone</TD>
 </TR>
 <TR>
  <TD>14</TD>
  <TD>0x0E</TD>
  <TD>D1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Tubular Bells</TD>
 </TR>
 <TR>
  <TD>15</TD>
  <TD>0x0F</TD>
  <TD>D#1=Eb1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Dulcimer</TD>
 </TR>
 <TR>
  <TD>16</TD>
  <TD>0x10</TD>
  <TD>E1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Drawbar Organ</TD>
 </TR>
 <TR>
  <TD>17</TD>
  <TD>0x11</TD>
  <TD>F1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Percussive Organ</TD>
 </TR>
 <TR>
  <TD>18</TD>
  <TD>0x12</TD>
  <TD>F#1=Gb1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Rock Organ</TD>
 </TR>
 <TR>
  <TD>19</TD>
  <TD>0x13</TD>
  <TD>G1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Church Organ</TD>
 </TR>
 <TR>
  <TD>20</TD>
  <TD>0x14</TD>
  <TD>G#1=Ab1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Reed Organ</TD>
 </TR>
 <TR>
  <TD>21</TD>
  <TD>0x15</TD>
  <TD>A1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Accordion</TD>
 </TR>
 <TR>
  <TD>22</TD>
  <TD>0x16</TD>
  <TD>A#1=Bb1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Harmonica</TD>
 </TR>
 <TR>
  <TD>23</TD>
  <TD>0x17</TD>
  <TD>B1</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Tango Accordion</TD>
 </TR>
 <TR>
  <TD>24</TD>
  <TD>0x18</TD>
  <TD>C2</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Acoustic Guitar (nylon)</TD>
 </TR>
 <TR>
  <TD>25</TD>
  <TD>0x19</TD>
  <TD>C#2=Db2</TD>
  <TD>Snare Roll</TD>
  <TD>-</TD>
  <TD>Acoustic Guitar (steel)</TD>
 </TR>
 <TR>
  <TD>26</TD>
  <TD>0x1A</TD>
  <TD>D2</TD>
  <TD>Finger Snap</TD>
  <TD>-</TD>
  <TD>Electric Guitar (jazz)</TD>
 </TR>
 <TR>
  <TD>27</TD>
  <TD>0x1B</TD>
  <TD>D#2=Eb2</TD>
  <TD>High Q</TD>
  <TD>-</TD>
  <TD>Electric Guitar (clean)</TD>
 </TR>
 <TR>
  <TD>28</TD>
  <TD>0x1C</TD>
  <TD>E2</TD>
  <TD>Slap</TD>
  <TD>-</TD>
  <TD>Electric Guitar (muted)</TD>
 </TR>
 <TR>
  <TD>29</TD>
  <TD>0x1D</TD>
  <TD>F2</TD>
  <TD>Scratch Push</TD>
  <TD>-</TD>
  <TD>Overdriven Guitar</TD>
 </TR>
 <TR>
  <TD>30</TD>
  <TD>0x1E</TD>
  <TD>F#2=Gb2</TD>
  <TD>Scratch Pull</TD>
  <TD>-</TD>
  <TD>Distortion Guitar</TD>
 </TR>
 <TR>
  <TD>31</TD>
  <TD>0x1F</TD>
  <TD>G2</TD>
  <TD>Sticks</TD>
  <TD>-</TD>
  <TD>Guitar Harmonics</TD>
 </TR>
 <TR>
  <TD>32</TD>
  <TD>0x20</TD>
  <TD>G#2=Ab2</TD>
  <TD>Square Click</TD>
  <TD>Bank Select LSB</TD>
  <TD>Acoustic Bass</TD>
 </TR>
 <TR>
  <TD>33</TD>
  <TD>0x21</TD>
  <TD>A2</TD>
  <TD>Metronome Click</TD>
  <TD>Modulation LSB</TD>
  <TD>Electric Bass (finger)</TD>
 </TR>
 <TR>
  <TD>34</TD>
  <TD>0x22</TD>
  <TD>A#2=Bb2</TD>
  <TD>Metronome Bell</TD>
  <TD>Breath Controller LSB</TD>
  <TD>Electric Bass (pick)</TD>
 </TR>
 <TR>
  <TD>35</TD>
  <TD>0x23</TD>
  <TD>B2</TD>
  <TD>Standard Kick 2</TD>
  <TD>-</TD>
  <TD>Fretless Bass</TD>
 </TR>
 <TR>
  <TD>36</TD>
  <TD>0x24</TD>
  <TD>C3</TD>
  <TD>Standard Kick 1</TD>
  <TD>Foot Controller LSB</TD>
  <TD>Slap Bass 1</TD>
 </TR>
 <TR>
  <TD>37</TD>
  <TD>0x25</TD>
  <TD>C#3=Db3</TD>
  <TD>Side Stick</TD>
  <TD>Portamento Time LSB</TD>
  <TD>Slap Bass 2</TD>
 </TR>
 <TR>
  <TD>38</TD>
  <TD>0x26</TD>
  <TD>D3</TD>
  <TD>Standard Snare 1</TD>
  <TD>Data Entry LSB</TD>
  <TD>Synth Bass 1</TD>
 </TR>
 <TR>
  <TD>39</TD>
  <TD>0x27</TD>
  <TD>D#3=Eb3</TD>
  <TD>Hand Clap</TD>
  <TD>Channel Volume LSB</TD>
  <TD>Synth Bass 2</TD>
 </TR>
 <TR>
  <TD>40</TD>
  <TD>0x28</TD>
  <TD>E3</TD>
  <TD>Standard Snare 2</TD>
  <TD>Balance LSB</TD>
  <TD>Violin</TD>
 </TR>
 <TR>
  <TD>41</TD>
  <TD>0x29</TD>
  <TD>F3</TD>
  <TD>Low Tom 2</TD>
  <TD>-</TD>
  <TD>Viola</TD>
 </TR>
 <TR>
  <TD>42</TD>
  <TD>0x2A</TD>
  <TD>F#3=Gb3</TD>
  <TD>Closed Hi-hat</TD>
  <TD>Pan LSB</TD>
  <TD>Cello</TD>
 </TR>
 <TR>
  <TD>43</TD>
  <TD>0x2B</TD>
  <TD>G3</TD>
  <TD>Low Tom 1</TD>
  <TD>Expression LSB</TD>
  <TD>Contrabass</TD>
 </TR>
 <TR>
  <TD>44</TD>
  <TD>0x2C</TD>
  <TD>G#3=Ab3</TD>
  <TD>Pedal Hi-hat</TD>
  <TD>Effect Control 1 LSB</TD>
  <TD>Tremolo Strings</TD>
 </TR>
 <TR>
  <TD>45</TD>
  <TD>0x2D</TD>
  <TD>A3</TD>
  <TD>Mid Tom 2</TD>
  <TD>Effect Control 2 LSB</TD>
  <TD>Pizzicato Strings</TD>
 </TR>
 <TR>
  <TD>46</TD>
  <TD>0x2E</TD>
  <TD>A#3=Bb3</TD>
  <TD>Open Hi-hat</TD>
  <TD>-</TD>
  <TD>Orchestral Harp</TD>
 </TR>
 <TR>
  <TD>47</TD>
  <TD>0x2F</TD>
  <TD>B3</TD>
  <TD>Mid Tom 1</TD>
  <TD>-</TD>
  <TD>Timpani</TD>
 </TR>
 <TR>
  <TD>48</TD>
  <TD>0x30</TD>
  <TD>C4</TD>
  <TD>High Tom 2</TD>
  <TD>-</TD>
  <TD>String Ensemble 1</TD>
 </TR>
 <TR>
  <TD>49</TD>
  <TD>0x31</TD>
  <TD>C#4=Db4</TD>
  <TD>Crash Cymbal 1</TD>
  <TD>-</TD>
  <TD>String Ensemble 2</TD>
 </TR>
 <TR>
  <TD>50</TD>
  <TD>0x32</TD>
  <TD>D4</TD>
  <TD>High Tom 1</TD>
  <TD>-</TD>
  <TD>SynthStrings 1</TD>
 </TR>
 <TR>
  <TD>51</TD>
  <TD>0x33</TD>
  <TD>D#4=Eb4</TD>
  <TD>Ride Cymbal 1</TD>
  <TD>-</TD>
  <TD>SynthStrings 2</TD>
 </TR>
 <TR>
  <TD>52</TD>
  <TD>0x34</TD>
  <TD>E4</TD>
  <TD>Chinese Cymbal</TD>
  <TD>-</TD>
  <TD>Choir Aahs</TD>
 </TR>
 <TR>
  <TD>53</TD>
  <TD>0x35</TD>
  <TD>F4</TD>
  <TD>Ride Bell</TD>
  <TD>-</TD>
  <TD>Voice Oohs</TD>
 </TR>
 <TR>
  <TD>54</TD>
  <TD>0x36</TD>
  <TD>F#4=Gb4</TD>
  <TD>Tambourine</TD>
  <TD>-</TD>
  <TD>Synth Vox</TD>
 </TR>
 <TR>
  <TD>55</TD>
  <TD>0x37</TD>
  <TD>G4</TD>
  <TD>Splash Cymbal</TD>
  <TD>-</TD>
  <TD>Orchestra Hit</TD>
 </TR>
 <TR>
  <TD>56</TD>
  <TD>0x38</TD>
  <TD>G#4=Ab4</TD>
  <TD>Cowbell</TD>
  <TD>-</TD>
  <TD>Trumpet</TD>
 </TR>
 <TR>
  <TD>57</TD>
  <TD>0x39</TD>
  <TD>A4</TD>
  <TD>Crash Cymbal 2</TD>
  <TD>-</TD>
  <TD>Trombone</TD>
 </TR>
 <TR>
  <TD>58</TD>
  <TD>0x3A</TD>
  <TD>A#4=Bb4</TD>
  <TD>Vibra-slap</TD>
  <TD>-</TD>
  <TD>Tuba</TD>
 </TR>
 <TR>
  <TD>59</TD>
  <TD>0x3B</TD>
  <TD>B4</TD>
  <TD>Ride Cymbal 2</TD>
  <TD>-</TD>
  <TD>Muted Trumpet</TD>
 </TR>
 <TR>
  <TD>60</TD>
  <TD>0x3C</TD>
  <TD>C5</TD>
  <TD>High Bongo</TD>
  <TD>-</TD>
  <TD>French Horn</TD>
 </TR>
 <TR>
  <TD>61</TD>
  <TD>0x3D</TD>
  <TD>C#5=Db5</TD>
  <TD>Low Bongo</TD>
  <TD>-</TD>
  <TD>Brass Section</TD>
 </TR>
 <TR>
  <TD>62</TD>
  <TD>0x3E</TD>
  <TD>D5</TD>
  <TD>Mute High Conga</TD>
  <TD>-</TD>
  <TD>Synth Brass 1</TD>
 </TR>
 <TR>
  <TD>63</TD>
  <TD>0x3F</TD>
  <TD>D#5=Eb5</TD>
  <TD>Open High Conga</TD>
  <TD>-</TD>
  <TD>Synth Brass 2</TD>
 </TR>
 <TR>
  <TD>64</TD>
  <TD>0x40</TD>
  <TD>E5</TD>
  <TD>Low Conga</TD>
  <TD>Hold Pedal 1</TD>
  <TD>Soprano Sax</TD>
 </TR>
 <TR>
  <TD>65</TD>
  <TD>0x41</TD>
  <TD>F5</TD>
  <TD>High Timbale</TD>
  <TD>Portament Pedal</TD>
  <TD>Alto Sax</TD>
 </TR>
 <TR>
  <TD>66</TD>
  <TD>0x42</TD>
  <TD>F#5=Gb5</TD>
  <TD>Low Timbale</TD>
  <TD>Sostenuto Pedal</TD>
  <TD>Tenor Sax</TD>
 </TR>
 <TR>
  <TD>67</TD>
  <TD>0x43</TD>
  <TD>G5</TD>
  <TD>High Agogo</TD>
  <TD>Soft Pedal</TD>
  <TD>Baritone Sax</TD>
 </TR>
 <TR>
  <TD>68</TD>
  <TD>0x44</TD>
  <TD>G#5=Ab5</TD>
  <TD>Low Agogo</TD>
  <TD>Legato Pedal</TD>
  <TD>Oboe</TD>
 </TR>
 <TR>
  <TD>69</TD>
  <TD>0x45</TD>
  <TD>A5</TD>
  <TD>Cabasa</TD>
  <TD>Hold Pedal 2</TD>
  <TD>English Horn</TD>
 </TR>
 <TR>
  <TD>70</TD>
  <TD>0x46</TD>
  <TD>A#5=Bb5</TD>
  <TD>Maracas</TD>
  <TD>Sound Variation</TD>
  <TD>Bassoon</TD>
 </TR>
 <TR>
  <TD>71</TD>
  <TD>0x47</TD>
  <TD>B5</TD>
  <TD>Short Hi Whistle</TD>
  <TD>Harmonic Contents</TD>
  <TD>Clarinet</TD>
 </TR>
 <TR>
  <TD>72</TD>
  <TD>0x48</TD>
  <TD>C6</TD>
  <TD>Long Low Whistle</TD>
  <TD>Release Time</TD>
  <TD>Piccolo</TD>
 </TR>
 <TR>
  <TD>73</TD>
  <TD>0x49</TD>
  <TD>C#6=Db6</TD>
  <TD>Short Gurio</TD>
  <TD>Attack Time</TD>
  <TD>Flute</TD>
 </TR>
 <TR>
  <TD>74</TD>
  <TD>0x4A</TD>
  <TD>D6</TD>
  <TD>Long Gurio</TD>
  <TD>Brightness</TD>
  <TD>Recorder</TD>
 </TR>
 <TR>
  <TD>75</TD>
  <TD>0x4B</TD>
  <TD>D#6=Eb6</TD>
  <TD>Claves</TD>
  <TD>Decay Time</TD>
  <TD>Pan Flute</TD>
 </TR>
 <TR>
  <TD>76</TD>
  <TD>0x4C</TD>
  <TD>E6</TD>
  <TD>High Wood Block</TD>
  <TD>Vibrato rate</TD>
  <TD>Blown Bottle</TD>
 </TR>
 <TR>
  <TD>77</TD>
  <TD>0x4D</TD>
  <TD>F6</TD>
  <TD>Low Wood Block</TD>
  <TD>Vibrato deapth</TD>
  <TD>Shakuhachi</TD>
 </TR>
 <TR>
  <TD>78</TD>
  <TD>0x4E</TD>
  <TD>F#6=Gb6</TD>
  <TD>Mute Cuica</TD>
  <TD>Vibrato deray</TD>
  <TD>Whistle</TD>
 </TR>
 <TR>
  <TD>79</TD>
  <TD>0x4F</TD>
  <TD>G6</TD>
  <TD>Open Cuica</TD>
  <TD>Sound Controller 10</TD>
  <TD>Ocarina</TD>
 </TR>
 <TR>
  <TD>80</TD>
  <TD>0x50</TD>
  <TD>G#6=Ab6</TD>
  <TD>Mute Triangle</TD>
  <TD>-</TD>
  <TD>Lead 1 (square)</TD>
 </TR>
 <TR>
  <TD>81</TD>
  <TD>0x51</TD>
  <TD>A6</TD>
  <TD>Open Triangle</TD>
  <TD>-</TD>
  <TD>Lead 2 (sawtooth)</TD>
 </TR>
 <TR>
  <TD>82</TD>
  <TD>0x52</TD>
  <TD>A#6=Bb6</TD>
  <TD>Shaker</TD>
  <TD>-</TD>
  <TD>Lead 3 (calliope)</TD>
 </TR>
 <TR>
  <TD>83</TD>
  <TD>0x53</TD>
  <TD>B6</TD>
  <TD>Jingle Bell</TD>
  <TD>-</TD>
  <TD>Lead 4 (chiff)</TD>
 </TR>
 <TR>
  <TD>84</TD>
  <TD>0x54</TD>
  <TD>C7</TD>
  <TD>Bell Tree</TD>
  <TD>Portament Control</TD>
  <TD>Lead 5 (charang)</TD>
 </TR>
 <TR>
  <TD>85</TD>
  <TD>0x55</TD>
  <TD>C#7=Db7</TD>
  <TD>Castanets</TD>
  <TD>-</TD>
  <TD>Lead 6 (voice)</TD>
 </TR>
 <TR>
  <TD>86</TD>
  <TD>0x56</TD>
  <TD>D7</TD>
  <TD>Mute Surdo</TD>
  <TD>-</TD>
  <TD>Lead 7 (fifths)</TD>
 </TR>
 <TR>
  <TD>87</TD>
  <TD>0x57</TD>
  <TD>D#7=Eb7</TD>
  <TD>Open Surdo</TD>
  <TD>-</TD>
  <TD>Lead 8 (bass + lead)</TD>
 </TR>
 <TR>
  <TD>88</TD>
  <TD>0x58</TD>
  <TD>E7</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Pad 1 (new age)</TD>
 </TR>
 <TR>
  <TD>89</TD>
  <TD>0x59</TD>
  <TD>F7</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Pad 2 (warm)</TD>
 </TR>
 <TR>
  <TD>90</TD>
  <TD>0x5A</TD>
  <TD>F#7=Gb7</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Pad 3 (polysynth)</TD>
 </TR>
 <TR>
  <TD>91</TD>
  <TD>0x5B</TD>
  <TD>G7</TD>
  <TD>-</TD>
  <TD>Reverb</TD>
  <TD>Pad 4 (choir)</TD>
 </TR>
 <TR>
  <TD>92</TD>
  <TD>0x5C</TD>
  <TD>G#7=Ab7</TD>
  <TD>-</TD>
  <TD>Effect 2 Depth</TD>
  <TD>Pad 5 (bowed)</TD>
 </TR>
 <TR>
  <TD>93</TD>
  <TD>0x5D</TD>
  <TD>A7</TD>
  <TD>-</TD>
  <TD>Chorus</TD>
  <TD>Pad 6 (metallic)</TD>
 </TR>
 <TR>
  <TD>94</TD>
  <TD>0x5E</TD>
  <TD>A#7=Bb7</TD>
  <TD>-</TD>
  <TD>Effect 4 Depth</TD>
  <TD>Pad 7 (halo)</TD>
 </TR>
 <TR>
  <TD>95</TD>
  <TD>0x5F</TD>
  <TD>B7</TD>
  <TD>-</TD>
  <TD>Effect 5 Depth</TD>
  <TD>Pad 8 (sweep)</TD>
 </TR>
 <TR>
  <TD>96</TD>
  <TD>0x60</TD>
  <TD>C8</TD>
  <TD>-</TD>
  <TD>Data Increment</TD>
  <TD>FX 1 (rain)</TD>
 </TR>
 <TR>
  <TD>97</TD>
  <TD>0x61</TD>
  <TD>C#8=Db8</TD>
  <TD>-</TD>
  <TD>Data Decrement</TD>
  <TD>FX 2 (soundtrack)</TD>
 </TR>
 <TR>
  <TD>98</TD>
  <TD>0x62</TD>
  <TD>D8</TD>
  <TD>-</TD>
  <TD>NRPN LSB</TD>
  <TD>FX 3 (crystal)</TD>
 </TR>
 <TR>
  <TD>99</TD>
  <TD>0x63</TD>
  <TD>D#8=Eb8</TD>
  <TD>-</TD>
  <TD>NRPN MSB</TD>
  <TD>FX 4 (atmosphere)</TD>
 </TR>
 <TR>
  <TD>100</TD>
  <TD>0x64</TD>
  <TD>E8</TD>
  <TD>-</TD>
  <TD>RPN LSB</TD>
  <TD>FX 5 (brightness)</TD>
 </TR>
 <TR>
  <TD>101</TD>
  <TD>0x65</TD>
  <TD>F8</TD>
  <TD>-</TD>
  <TD>RPN MSB</TD>
  <TD>FX 6 (goblins)</TD>
 </TR>
 <TR>
  <TD>102</TD>
  <TD>0x66</TD>
  <TD>F#8=Gb8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>FX 7 (echoes)</TD>
 </TR>
 <TR>
  <TD>103</TD>
  <TD>0x67</TD>
  <TD>G8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>FX 8 (sci-fi)</TD>
 </TR>
 <TR>
  <TD>104</TD>
  <TD>0x68</TD>
  <TD>G#8=Ab8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Sitar</TD>
 </TR>
 <TR>
  <TD>105</TD>
  <TD>0x69</TD>
  <TD>A8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Banjo</TD>
 </TR>
 <TR>
  <TD>106</TD>
  <TD>0x6A</TD>
  <TD>A#8=Bb8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Shamisen</TD>
 </TR>
 <TR>
  <TD>107</TD>
  <TD>0x6B</TD>
  <TD>B8</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Koto</TD>
 </TR>
 <TR>
  <TD>108</TD>
  <TD>0x6C</TD>
  <TD>C9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Kalimba</TD>
 </TR>
 <TR>
  <TD>109</TD>
  <TD>0x6D</TD>
  <TD>C#9=Db9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Bag pipe</TD>
 </TR>
 <TR>
  <TD>110</TD>
  <TD>0x6E</TD>
  <TD>D9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Fiddle</TD>
 </TR>
 <TR>
  <TD>111</TD>
  <TD>0x6F</TD>
  <TD>D#9=Eb9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Shanai</TD>
 </TR>
 <TR>
  <TD>112</TD>
  <TD>0x70</TD>
  <TD>E9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Tinkle Bell</TD>
 </TR>
 <TR>
  <TD>113</TD>
  <TD>0x71</TD>
  <TD>F9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Agogo</TD>
 </TR>
 <TR>
  <TD>114</TD>
  <TD>0x72</TD>
  <TD>F#9=Gb9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Steel Drums</TD>
 </TR>
 <TR>
  <TD>115</TD>
  <TD>0x73</TD>
  <TD>G9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Woodblock</TD>
 </TR>
 <TR>
  <TD>116</TD>
  <TD>0x74</TD>
  <TD>G#9=Ab9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Taiko</TD>
 </TR>
 <TR>
  <TD>117</TD>
  <TD>0x75</TD>
  <TD>A9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Melodic Tom</TD>
 </TR>
 <TR>
  <TD>118</TD>
  <TD>0x76</TD>
  <TD>A#9=Bb9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Synth Drum</TD>
 </TR>
 <TR>
  <TD>119</TD>
  <TD>0x77</TD>
  <TD>B9</TD>
  <TD>-</TD>
  <TD>-</TD>
  <TD>Reverse Cymbal</TD>
 </TR>
 <TR>
  <TD>120</TD>
  <TD>0x78</TD>
  <TD>C10</TD>
  <TD>-</TD>
  <TD>All Sound Off</TD>
  <TD>Guitar Fret Noise</TD>
 </TR>
 <TR>
  <TD>121</TD>
  <TD>0x79</TD>
  <TD>C#10=Db10</TD>
  <TD>-</TD>
  <TD>Reset All Controller</TD>
  <TD>Breath Noise</TD>
 </TR>
 <TR>
  <TD>122</TD>
  <TD>0x7A</TD>
  <TD>D10</TD>
  <TD>-</TD>
  <TD>Local Control</TD>
  <TD>Seashore</TD>
 </TR>
 <TR>
  <TD>123</TD>
  <TD>0x7B</TD>
  <TD>D#10=Eb10</TD>
  <TD>-</TD>
  <TD>All Note Off</TD>
  <TD>Bird Tweet</TD>
 </TR>
 <TR>
  <TD>124</TD>
  <TD>0x7C</TD>
  
  <TD>E10</TD>
  <TD>-</TD>
  <TD>Omni Mode Off</TD>
  <TD>Telephone Ring</TD>
 </TR>
 <TR>
  <TD>125</TD>
  <TD>0x7D</TD>
  <TD>F10</TD>
  <TD>-</TD>
  <TD>Omni Mode On</TD>
  <TD>Helicopter</TD>
 </TR>
 <TR>
  <TD>126</TD>
  <TD>0x7E</TD>
  <TD>F#10=Gb10</TD>
  <TD>-</TD>
  <TD>Mono Mode On</TD>
  <TD>Applause</TD>
 </TR>
 <TR>
  <TD>127</TD>
  <TD>0x7F</TD>
  <TD>G10</TD>
  <TD>-</TD>
  <TD>Poly Mode On</TD>
  <TD>Gunshot</TD>
 </TR>
</TABLE>

<H2><A NAME="APPENDIX_C">付録C　MIDIイベント取得・設定関数対応表</A></H2>
<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH ROWSPAN=2>関数名<BR>(接頭のMIDIEvent_は省略)</TH>
  <TH COLSPAN=18>メタイベント</TH>
  <TH COLSPAN=7>MIDIチャンネルイベント</TH>
  <TH ROWSPAN=2>システムエクスクルーシヴイベント</TH>
  <TH COLSPAN=4>(結合イベント)</TH>
 </TR>
 <TR>
  <TH>シーケンス番号</TH>
  <TH>テキストイベント</TH>
  <TH>著作権</TH>
  <TH>シーケンス名・トラック名</TH>
  <TH>インストゥルメント名</TH>
  <TH>歌詞</TH>
  <TH>マーカー</TH>
  <TH>キューポイント</TH>
  <TH>プログラム名</TH>
  <TH>デバイス名</TH>
  <TH>チャンネルプリフィックス</TH>
  <TH>ポートプリフィックス</TH>
  <TH>エンドオブトラック</TH>
  <TH>テンポ設定</TH>
  <TH>ＳＭＰＴＥオフセット</TH>
  <TH>拍子記号</TH>
  <TH>調性記号</TH>
  <TH>シーケンサー独自のイベント</TH>
  <TH>ノートオフ</TH>
  <TH>ノートオン</TH>
  <TH>キーアフタータッチ</TH>
  <TH>コントロールチェンジ</TH>
  <TH>プログラムチェンジ</TH>
  <TH>チャンネルアフタータッチ</TH>
  <TH>ピッチベンド</TH>
  <TH>ノート</TH>
  <TH>パッチチェンジ</TH>
  <TH>ＲＰＮチェンジ</TH>
  <TH>ＮＲＰＮチェンジ</TH>
 </TR>
 <TR>
  <TD>GetTime<BR>SetTime</TD>
  <TD>○<BR>1</TD>
  <TD>○</TD>
  <TD>○<BR>1</TD>
  <TD>○<BR>1</TD>
  <TD>○<BR>1</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>2</TD>
  <TD>○</TD>
  <TD>○<BR>1</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>3</TD>
  <TD>○<BR>4</TD>
  <TD>○<BR>4</TD>
  <TD>○<BR>4</TD>
 </TR>
 <TR>
  <TD>GetKind<BR>SetKind</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>5</TD>
  <TD>○<BR>5</TD>
  <TD>○<BR>5</TD>
  <TD>○<BR>5</TD>
 </TR>
 <TR>
  <TD>GetLen</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
 </TR>
 <TR>
  <TD>GetData<BR>SetData</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
 </TR>
 <TR>
  <TD>GetText<BR>SetText</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetTempo<BR>SetTempo</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetSMPTEOffset<BR>SetSMPTEOffset</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetTimeSignature<BR>SetTimeSignature</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetKeySignature<BR>SetKeySignature</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetMIDIMessage<BR>SetMIDIMessage</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
  <TD>○<BR>6</TD>
 </TR>
 <TR>
  <TD>GetChannel<BR>SetChannel</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
 </TR>
 <TR>
  <TD>GetKey<BR>SetKey</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetVelocity<BR>SetVelocity</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetDuration<BR>SetDuration</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○7</TD>
  <TD>○7</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetNumber<BR>SetNumber</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
 </TR>
 <TR>
  <TD>GetValue<BR>SetValue</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
 </TR>
 <TR>
  <TD>GetBank<BR>SetBank</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
 </TR>
 <TR>
  <TD>GetBankMSB<BR>SetBankMSB</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
 </TR>
 <TR>
  <TD>GetBankLSB<BR>SetBankLSB</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>×</TD>
  <TD>○</TD>
  <TD>○</TD>
  <TD>○</TD>
 </TR>
</TABLE>
<DIV>※1：これらのイベントの時刻は0[tick]であるべきである。</DIV>
<DIV>※2：エンドオブトラックの時刻は、そのトラックの最後のイベントと同じ時刻かそれ以降でなければならない。</DIV>
<DIV>※3：ノートオンイベントに対してSetを適用した場合、音の長さを保ちつつノートオフイベントの位置も移動する。ノートオフイベントに対してSetを適用した場合、音の長さを保ちつつノートオンイベントの位置も移動する。</DIV>
<DIV>※4：Setを適用した場合、結合されているすべてのイベントの時刻が移動する。</DIV>
<DIV>※5：GetKindは、単品のMIDIイベントの種類を返す。また、SetKindは、結合イベントを別の結合イベントや単品イベントに変更できるため、MIDIイベントの総数が変わることがある。</DIV>
<DIV>※6：GetData/SetDataは、単品のMIDIイベントに対して適用される。</DIV>
<DIV>※7：ノートオンとノートオフを結合させていない場合、GetDurationは0を返し、SetDurationは無意味である。</DIV>



<H2><A NAME="APPENDIX_D">付録D　更新履歴</A></H2>

<TABLE WIDTH="100%" BORDER=1 CELLSPACING=1 CELLPADDING=2>
 <TR>
  <TH>
   ヴァージョン番号
  </TH>
  <TH>
   リリース年月日
  </TH>
  <TH>
   修正事項
  </TH>
 </TR>
 <TR>
  <TD>
   β0.1
  </TD>
  <TD>
   2004年6月20日
  </TD>
  <TD>
   <UL>
    <LI>多くのバグを抱えながらもとりあえず初リリース</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.2
  </TD>
  <TD>
   2004年7月20日
  </TD>
  <TD>
   <UL>
    <LI>C++言語から使えなかったバグを除去</LI>
    <LI>MIDITrack_MakeTime及びMIDITrack_BreakTimeに関するバグを除去、及び取説の正規化</LI>
    <LI>MIDITrack_MakeTimeEx及びMIDITrack_BreakTimeExを追加</LI>
    <LI>MIDIEvent_IsNoteの定義は、「ノートオンイベントとノートオフイベントの結合物に限る」と明確化</LI>
    <LI>MIDIEvent_DeleteSingle関数の公開化</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.3
  </TD>
  <TD>
   2004年12月19日
  </TD>
  <TD>
   <UL>
    <LI>MIDIData_SetFormatで、フォーマット0→フォーマット1への変換できないバグを修正</LI>
    <LI>MIDITrack_GetName及びMIDITrack_SetNameに関する動作定義を公開</LI>
    <LI>MIDITrack_GetFirstKindEvent及びMIDITrack_GetLastKindEvent関数を新たに定義</LI>
    <LI>MIDITrack_GetNextSameKindEvent及びMIDITrack_GetPrevSameKindEvent関数を公開</LI>
    <LI>テキスト系イベントで長さ0のテキストを設定したときに起こるバグを修正</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.4
  </TD>
  <TD>
   2005年01月15日
  </TD>
  <TD>
   <UL>
    <LI>MIDITrack_GetParent関数及びMIDIEvent_GetParent関数の作り忘れを修正</LI>
    <LI>公式ガイドブック内でMIDIEVENT_TRACKNAMEとMIDIEVENT_COPYRIGHTNOTICEの順が逆になっているのを訂正</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.5
  </TD>
  <TD>
   2005年04月23日
  </TD>
  <TD>
   <UL>
    <LI>MIDITrack_FindTimeSignature関数及びMIDIEvent_FindKeyParent関数の作り忘れと取説誤記を修正</LI>
    <LI>MIDIData構造体、MIDITrack構造体、MIDIEvent構造体に、m_lUser3(ユーザー用拡張領域その3)を追加</LI>
    <LI>SMF読み込み時、結合できるイベントは自動結合するようにした</LI>
    <LI>MIDIEvent_GetBank関数及びMIDIEvent_SetBank関数のバグを修正</LI>
    <LI>MIDIEvent_GetBankMSB関数及びMIDIEvent_GetBankLSB関数の新規追加</LI>
    <LI>MIDIEvent_SetBankMSB関数及びMIDIEvent_SetBankLSB関数の新規追加</LI>
    <LI>公式ガイドブックに「付録C　MIDIイベント取得・設定関数対応表」の新規追加</LI>
    <LI>公式ガイドブックのMIDIEvent_GetVelocity関数とMIDIEvent_SetVelocity関数の誤り訂正</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.6
  </TD>
  <TD>
   2005年09月18日
  </TD>
  <TD>
   <UL>
    <LI>Visual Basic用のMIDIData.basファイルで抜けている関数を追加</LI>
    <LI>MIDIEvent_GetMIDIMessage, MIDIEvent_SetMIDIMessage関数の追加</LI>
    <LI>公式ガイドブックの一部校正</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.7
  </TD>
  <TD>
   2007年01月18日
  </TD>
  <TD>
   <UL>
    <LI>MIDIEvent_GetData関数のバグ修正(データ部をそのままコピーするようにした)</LI>
    <LI>MIDIData_TimeToMillisec関数の追加</LI>
    <LI>MIDIData_MillisecToTime関数の追加</LI>
    <LI>MIDIData_MakeTime関数の追加</LI>
    <LI>MIDIData_MakeTimeEx関数の追加</LI>
    <LI>MIDIData_BreakTime関数の追加</LI>
    <LI>MIDIData_BreakTimeEx関数の追加</LI>
    <LI>MIDIData_FindTempo関数の追加</LI>
    <LI>MIDIData_FindTimeSignature関数の追加</LI>
    <LI>MIDIData_FindKeySignature関数の追加</LI>
    <LI>MIDITrack_FindTempo関数の追加</LI>
    <LI>公式ガイドブックの修正</LI>
    <LI>プロジェクトホームページを<A HREF="http://www.geocities.jp/ee65051/index.html">おーぷんMIDIぷろじぇくと</A>に変更</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.8
  </TD>
  <TD>
   2007年12月28日
  </TD>
  <TD>
   <UL>
    <LI>MIDIData_MakeTime関数の拍子分母が4以外のときにおける計算バグ修正</LI>
    <LI>MIDITrack_MakeTime関数の拍子分母が4以外のときにおける計算バグ修正</LI>
    <LI>MIDIEvent_SetFloating関数(内部隠蔽関数)のリンクリストポインタ接続バグ修正</LI>
    <LI>MIDIEvent_SetPrevEvent関数(内部隠蔽関数)のリンクリストポインタ接続バグ修正</LI>
    <LI>MIDIEvent_SetNextEvent関数(内部隠蔽関数)のリンクリストポインタ接続バグ修正</LI>
    <LI>MIDIEvent_SetTimeSingle関数(内部隠蔽関数)の浮遊イベントのときのポインタ接続バグ修正</LI>
    <LI>MIDIEvent_SetKindSingle関数(内部隠蔽関数)でイベントの種類および長さされないバグ修正</LI>
    <LI>MIDIEvent_SetKind関数でイベントの種類および長さが正しく設定されないバグ修正</LI>
    <LI>MIDIEvent_SetChannel関数でイベントのチャンネル番号が正しく設定されないバグ修正</LI>
    <LI>MIDIEvent_CreateClone関数の動作仕様変更(新しく生成したイベントは必ず浮遊状態とする)</LI>
    <LI>MIDIEvent_GetNumber関数のバグ修正および機能拡張</LI>
    <LI>MIDIEvent_SetNumber関数のバグ修正および機能拡張</LI>
    <LI>MIDIEvent_GetValue関数のバグ修正および機能拡張</LI>
    <LI>MIDIEvent_SetValue関数のバグ修正および機能拡張</LI>
    <LI>MIDIEvent_Combine関数の追加</LI>
    <LI>MIDIEvent_Chop関数の追加</LI>
    <LI>MIDITrack_FindTimeSignature関数のバグ修正</LI>
    <LI>MIDITrack_Create関数は、エンドオブトラックイベントが自動的に挿入される仕様を、イベントは何も挿入されない仕様に変更</LI>
    <LI>MIDIData_TimeToMillisec関数がSMPTEベースのMIDIデータにも対応</LI>
    <LI>MIDIData_MillisecToTime関数がSMPTEベースのMIDIデータにも対応</LI>
    <LI>MIDIData_SetFormat関数でフォーマット変換に失敗するバグ修正</LI>
    <LI>MIDIData_Save関数でランニングステータスが一部省略されてしまうバグを修正</LI>
    <LI>MIDIData_Load関数の名前をMIDIData_LoadFromSMFに変更</LI>
    <LI>MIDIData_Save関数の名前をMIDIData_SaveAsSMFに変更</LI>
    <LI>MIDIData_LoadFromBirnay関数を追加</LI>
    <LI>MIDIData_SaveAsBinary関数を追加</LI>
    <LI>MIDIData_Load関数の名前をMIDIData_LoadFromSMFで、イベントが自動結合するのを廃止(SMFでは結合概念はないため、勝手な解釈をしないようにした)。</LI>
    <LI>公式ガイドブックの修正</LI>
    <LI>公式ガイドブックのHTMLタグ不整合訂正、及びW3C HTML4.01の基準に適合化</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   β0.9
  </TD>
  <TD>
   2008年3月31日
  </TD>
  <TD>
   <UL>
    <LI>プロジェクトホームページを<A HREF="https://openmidiproject.osdn.jp/index.html">https://openmidiproject.osdn.jp/index.html</A>に変更</LI>
    <LI>MIN,MAX,CLIPマクロを新たに定義</LI>
    <LI><A HREF="#MIDIEvent_Combine">MIDIEvent_Combine</A>関数で、ノートオフイベントの場合でも、結合していなければ、直近のノートオンイベントと結合できるようにした</LI>
    <LI><A HREF="#MIDIData_SetFormat">MIDIData_SetFormat</A>関数でSMFフォーマット0から1又は2に変換するとき、各トラックにエンドオブトラックイベントを付け忘れるバグを修正</LI>
    <LI><A HREF="#MIDIData_MakeTime">MIDIData_MakeTime</A>関数・<A HREF="#MIDIData_MakeTimeEx">MIDIData_MakeTimeEx</A>関数・<A HREF="#MIDITrack_MakeTime">MIDITrack_MakeTime</A>関数・<A HREF="#MIDITrack_MakeTimeEx">MIDITrack_MakeTimeEx</A>関数で、SMPTEベースのMIDIデータもタイムコードを生成できるように改良。lMeasureにフレーム番号、lTickにサブフレーム番号を指定する。lBeatは無視される。</LI>
    <LI><A HREF="#MIDIData_BreakTime">MIDIData_BreakTime</A>関数・<A HREF="#MIDIData_BreakTimeEx">MIDIData_BreakTimeEx</A>関数・<A HREF="#MIDITrack_BreakTime">MIDITrack_BreakTime</A>関数・<A HREF="#MIDITrack_BreakTimeEx">MIDITrack_BreakTimeEx</A>関数で、SMPTEベースのMIDIデータもタイムコードを分解できるように改良。lMeasureにフレーム番号、lTickにサブフレーム番号が返される。lBeatは無視される。</LI>
    <LI>MIDIData_Merge関数をテスト的に追加</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.0
  </TD>
  <TD>
   2008年7月26日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_GetNextTrack">MIDITrack_GetNextTrack</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_GetPrevTrack">MIDITrack_GetPrevTrack</A>関数を追加。</LI>
    <LI>MIDITrack_GetNextEvent関数を廃止(<A HREF="#MIDIEvent_GetNextEvent">MIDIEvent_GetNextEvent</A>をご利用ください)。</LI>
    <LI>MIDITrack_GetPrevEvent関数を廃止(<A HREF="#MIDIEvent_GetPrevEvent">MIDIEvent_GetPrevEvent</A>をご利用ください)。</LI>
    <LI>MIDITrack_GetNextSameKindEvent関数を廃止(<A HREF="#MIDIEvent_GetNextSameKindEvent">MIDIEvent_GetNextSameKindEvent</A>をご利用ください)。</LI>
    <LI>MIDITrack_GetPrevSameKindEvent関数を廃止(<A HREF="#MIDIEvent_GetPrevSameKindEvent">MIDIEvent_GetPrevSameKindEvent</A>をご利用ください)。</LI>
    <LI>MIDIEvent_SetPrevEvent(内部隠蔽関数)で、EOTイベントの前にMIDIイベントを挿入する場合の、EOTの時刻の自動調整を修正。</LI>
    <LI>MIDIEvent_SetNextEvent(内部隠蔽関数)で、EOTイベントの次にMIDIイベントを挿入する場合の、挿入できないように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetTimeSingle">MIDIEvent_SetTimeSingle</A>関数で、pTempEventの直前にpEventを挿入する場合と、リンクリストの最後にpEventを挿入する場合の条件式を修正。</LI>
    <LI>MIDIData_Merge関数(β0.9でテスト追加)を廃止。</LI>
    <LI><A HREF="#MIDIData_SetFormat">MIDIData_SetFormat</A>で、フォーマット2に対応。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.1
  </TD>
  <TD>
   2008年8月16日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_SetChannel">MIDIEvent_SetChannel</A>関数で前後の同種イベントポインタをつなぎ変え忘れるバグを修正。</LI>
    <LI>Visual Basic用モジュール定義ファイル(MIDIData.bas)を最新状態に合わせて更新。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_GetNextSameKindEvent">MIDIEvent_GetNextSameKindEvent</A>関数の説明を明確にした。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_GetPrevSameKindEvent">MIDIEvent_GetPrevSameKindEvent</A>関数の説明を明確にした。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIData_GetTimeBase">MIDIData_GetTimeBase</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDITrack_CheckSetupTrack">MIDITrack_CheckSetupTrack</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDITrack_CheckNonSetupTrack">MIDITrack_CheckNonSetupTrack</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブック細部修正。</LI>
    </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.2
  </TD>
  <TD>
   2008年9月20日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_MillisecToTime">MIDITrack_MillisecToTime</A>関数の計算式バグを修正(<A HREF="#MIDIData_MillisecToTime">MIDIData_MillisecToTime</A>にも影響)。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.3
  </TD>
  <TD>
   2008年10月07日
  </TD>
  <TD>
   <UL>
    <LI>公式ガイドブックで<A HREF="#MIDIData_CountTrack">MIDIData_CountTrack</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDITrack_CountEvent">MIDITrack_CountEvent</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDITrack_RemoveEvent">MIDITrack_RemoveEvent</A>関数の説明修正。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDITrack_RemoveSingleEvent">MIDITrack_RemoveSingleEvent</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_Delete">MIDIEvent_Delete</A>関数の説明修正。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_DeleteSingle">MIDIEvent_DeleteSingle</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_SetTime">MIDIEvent_SetTime</A>関数の説明修正。</LI>
    <LI>公式ガイドブックで<A HREF="#MIDIEvent_SetTimeSingle">MIDIEvent_SetTimeSingle</A>関数の説明が抜けていたので追加。</LI>
    <LI>公式ガイドブックで<A HREF="#forEachTrack">forEachTrack</A>マクロの説明修正・追加。</LI>
    <LI>公式ガイドブックで<A HREF="#forEachEvent">forEachEvent</A>マクロの説明修正・追加。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.4
  </TD>
  <TD>
   2008年11月03日
  </TD>
  <TD>
   <UL>
    <LI>Cherryシーケンスファイル(*.chy)入出力に対応</LI>
    <LI><A HREF="#MIDIData_LoadFromCherry">MIDIData_LoadFromCherry</A>関数追加。</LI>
    <LI><A HREF="#MIDIData_SaveAsCherry">MIDIData_SaveAsCherry</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_FieldTable">MIDITrack構造体</A>に、m_lInputOn, m_lInputPort, m_lInputChannel, m_lOutputOn, m_lOutputPort, m_lOutputChannel, m_lTimePlus, m_lKeyPlus, m_lVelocityPlus, m_lViewMode, m_lForeColor, m_lBackColorのメンバ変数(フィールド)を追加。</LI>
    <LI><A HREF="#MIDIData_LoadFromBinary">MIDIData_LoadFromBinary</A>関数で、旧ファイルフォーマットと新ファイルフォーマットの両方が読み込めるように改造。</LI>
    <LI><A HREF="#MIDIData_SaveAsBinary">MIDIData_SaveAsBinary</A>関数で、MIDITrack構造体のm_lInputOn, m_lInputPort, m_lInputChannel, m_lOutputOn, m_lOutputPort, m_lOutputChannel, m_lTimePlus, m_lKeyPlus, m_lVelocityPlus, m_lViewMode, m_lForeColor, m_lBackColorのメンバ変数も保存するようにファイルフォーマットを変更。</LI>
    <LI><A HREF="#MIDITrack_GetInputOn">MIDITrack_GetInputOn</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetInputPort">MIDITrack_GetInputPort</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetInputChannel">MIDITrack_GetInputChannel</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetOutputOn">MIDITrack_GetOutputOn</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetOutputPort">MIDITrack_GetOutputPort</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetOutputChannel">MIDITrack_GetOutputChannel</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetTimePlus">MIDITrack_GetTimePlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetKeyPlus">MIDITrack_GetKeyPlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetVelocityPlus">MIDITrack_GetVelocityPlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetViewMode">MIDITrack_GetViewMode</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetForeColor">MIDITrack_GetForeColor</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetBackColor">MIDITrack_GetBackColor</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetInputOn">MIDITrack_SetInputOn</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetInputPort">MIDITrack_SetInputPort</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetInputChannel">MIDITrack_SetInputChannel</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetOutputOn">MIDITrack_SetOutputOn</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetOutputPort">MIDITrack_SetOutputPort</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetOutputChannel">MIDITrack_SetOutputChannel</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetTimePlus">MIDITrack_SetTimePlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetKeyPlus">MIDITrack_SetKeyPlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetVelocityPlus">MIDITrack_SetVelocityPlus</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetViewMode">MIDITrack_SetViewMode</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetForeColor">MIDITrack_SetForeColor</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_SetBackColor">MIDITrack_SetBackColor</A>関数追加。</LI>
    <LI><A HREF="#MIDITrack_GetBeginTime">MIDITrack_GetBeginTime</A>関数を実装し忘れていたので追加。</LI>
    <LI><A HREF="#MIDITrack_GetEndTime">MIDITrack_GetEndTime</A>関数を実装し忘れていたので追加。</LI>
    <LI><A HREF="#MIDIData_SaveAsSMF">MIDIData_SaveAsSMF</A>関数(実質的には内部のMIDITrack_SaveAsSMF関数)で先頭の空白を削除してしまうバグを修正。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.5
  </TD>
  <TD>
   2008年12月13日
  </TD>
  <TD>
   <UL>
    <LI>Cherryシーケンスファイル(*.chy)入出力の互換性強化(仮想コントロールチェンジに対応)。</LI>
    <LI><A HREF="#MIDITrack_InsertEventBefore">MIDITrack_InsertEventBefore</A>でイベント挿入に失敗した場合の挙動と戻り値を修正。</LI>
    <LI><A HREF="#MIDITrack_InsertEventAfter">MIDITrack_InsertEventAfter</A>でイベント挿入に失敗した場合の挙動と戻り値を修正。</LI>
    <LI><A HREF="#MIDITrack_InsertEvent">MIDITrack_InsertEvent</A>でイベント挿入に失敗した場合の挙動と戻り値を修正。</LI>
    <LI><A HREF="#MIDIEvent_CreateClone">MIDIEvent_CreateClone</A>関数で結合イベントを複製したときの戻り値イベントを修正。</LI>
    <LI><A HREF="#MIDITrack_CreateClone">MIDITrack_CreateClone</A>関数を追加。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.6
  </TD>
  <TD>
   2008年12月20日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_SetFormat">MIDIData_SetFormat</A>にてフォーマット変換後に、各MIDIトラックの入力ポート番号・入力チャンネル・出力ポート番号・出力チャンネル・表示モードを自動設定するように修正。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.7
  </TD>
  <TD>
   2008年12月27日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_CreateSMPTEOffset">MIDIEvent_CreateSMPTEOffset</A>のバグ修正。</LI>
    <LI><A HREF="#MIDIEvent_SetSMPTEOffset">MIDIEvent_SetSMPTEOffset</A>のバグ修正。</LI>
    <LI><A HREF="#MIDIEvent_SetKind">MIDIEvent_SetKind</A>内でSMPTEオフセットに変換したときのバグ修正。</LI>
    <LI><A HREF="#MIDIEvent_IsSequencerSpecific">MIDIEvent_IsSequencerSpecific</A>のバグ修正。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.8
  </TD>
  <TD>
   2009年01月17日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_InsertEvent">MIDITrack_InsertEvent</A>でノートオンより前にノートオフが来ることがあるバグ修正。</LI>
    <LI><A HREF="#MIDIData_SetFormat">MIDIEvent_SetFormat</A>で変換時にノートオンとノートオフの位置がおかしくなるバグ修正。</LI>
    <LI><A HREF="#MIDITrack_GetXFVersion">MIDITrack_GetXFVersion</A>を追加。</LI>
    <LI><A HREF="#MIDIData_GetXFVersion">MIDIData_GetXFVersion</A>を追加。</LI>
    <LI><A HREF="#MIDIData_LoadFromSMF">MIDIData_LoadFromSMF</A>でXFデータも読み込めるように対応。</LI>
    <LI><A HREF="#MIDIData_SaveAsSMF">MIDIData_SaveAsSMF</A>でXFデータも書き込めるように対応。</LI>
    <LI>公式ガイドブック細部修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   1.9
  </TD>
  <TD>
   2009年04月07日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_InsertSMPTEOffset">MIDITrack_InsertSMPTEOffset</A>を実装。</LI>
    <LI><A HREF="#MIDITrack_InsertSequencerSpecific">MIDITrack_InsertSequencerSpecific</A>を実装。</LI>
    <LI>公式ガイドブック誤記修正、細部修正、説明不足修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.0
  </TD>
  <TD>
   2009年07月14日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_SetTime">MIDIEvent_SetTime</A>及び<A HREF="#MIDIEvent_SetTimeSingle">MIDIEvent_SetTimeSingle</A>で音長さ=0のノートイベントが正しい順序で並べ替えられないバグを修正。</LI>
    <LI><A HREF="#MIDIData_LoadFromBinary">MIDITrack_LoadFromBinary</A>で音長さ=0のノートイベントが正しく読み込めないバグを修正。</LI>
    <LI><A HREF="#MIDIData_LoadFromSMF">MIDITrack_LoadFromSMF</A>で音長さ=0のノートイベントが正しく読み込めないバグを修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.1
  </TD>
  <TD>
   2009年12月13日
  </TD>
  <TD>
   <UL>
    <LI>malloc(0)が発生する恐れのある箇所を排除。データ部が0バイトのときはmallocしないように修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.2
  </TD>
  <TD>
   2010年02月28日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_InsertEventBefore">MIDITrack_InsertEventBefore</A>でノートイベントを挿入したときのノートオフイベントの挿入位置を修正。</LI>
    <LI><A HREF="#MIDITrack_InsertEventAfter">MIDITrack_InsertEventAfter</A>でノートイベントを挿入したときのノートオフイベントの挿入位置はそのままとする。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.3
  </TD>
  <TD>
   2010年07月30日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_GetTrack">MIDIData_GetTrack</A>関数を追加。</LI>
    <LI><A HREF="#MIDIData_LoadFromMIDICSV">MIDIData_LoadFromMIDICSV</A>関数を追加。</LI>
    <LI><A HREF="#MIDIData_SaveAsMIDICSV">MIDIData_SaveAsMIDICSV</A>関数を追加。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.4
  </TD>
  <TD>
   2012年01月10日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_LoadFromMIDICSV">MIDIData_LoadFromMIDICSV</A>関数で、テキスト系イベント内の"\011","\015","\012"をそれぞれTAB,CR,LFとして入力できるようにした。</LI>
    <LI><A HREF="#MIDIData_SaveAsMIDICSV">MIDIData_SaveAsMIDICSV</A>関数で、テキスト系イベント内のTAB,CR,LFをそれぞれ"\011","\015","\012"として出力できるようにした。また、改行コードはLFとした。MIDIDataライブラリ2.4以降のMIDICSVファイルは、LFを改行として認識可能なテキストエディタや表計算ソフトでご覧ください。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.5
  </TD>
  <TD>
   2012年02月10日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_LoadFromMIDICSV">MIDIData_LoadFromMIDICSV</A>関数で、テキスト系イベント内の一部の日本語文字が正しく入力されないバグを修正した。</LI>
    <LI><A HREF="#MIDIData_SaveAsMIDICSV">MIDIData_SaveAsMIDICSV</A>関数で、テキスト系イベント内一部の日本語文字が正しく出力されないバグを修正した。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.6
  </TD>
  <TD>
   2012年02月19日
  </TD>
  <TD>
   <UL>
    <LI>文字列がANSIとUNICODEの両方に対応。なお、今までのC/C++ソースコードはそのまま使えるが、再コンパイルは必要である。</LI>
    <LI>上記に伴い、公式ガイドブックに<A HREF="#MIDIOverview_ANSI_UNICODE">1-6.ANSIとUNICODEの使い分けについて</A>を追加。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_LoadFromBinary">MIDIData_LoadFromBinary</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_LoadFromSMF">MIDIData_LoadFromSMF</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_LoadFromCherry">MIDIData_LoadFromCherry</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_LoadFromMIDICSV">MIDIData_LoadFromMIDICSV</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>

    <LI>上記に伴い、<A HREF="#MIDIData_SaveAsBinary">MIDIData_SaveAsBinary</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_SaveAsSMF">MIDIData_SaveAsSMF</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_SaveAsCherry">MIDIData_SaveAsCherry</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_SaveAsMIDICSV">MIDIData_SaveAsMIDICSV</A>関数で、pszFileNameの型が<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型になった。</LI>

    <LI>上記に伴い、<A HREF="#MIDIData_GetTitle">MIDIData_GetTitle</A>関数で、pBufの型を<SPAN CLASS="KEYWORD">char</SPAN>*型からTCHAR*型に変更、lLenの単位をバイトから文字に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_GetCopyright">MIDIData_GetCopyright</A>関数で、pBufの型を<SPAN CLASS="KEYWORD">char</SPAN>*型からTCHAR*型に変更、lLenの単位をバイトから文字に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_GetComment">MIDIData_GetComment</A>関数で、pBufの型を<SPAN CLASS="KEYWORD">char</SPAN>*型からTCHAR*型に変更、lLenの単位をバイトから文字に変更した。</LI>

    <LI>上記に伴い、<A HREF="#MIDIData_SetTitle">MIDIData_SetTitle</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_SetCopyright">MIDIData_SetCopyright</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIData_SetComment">MIDIData_SetComment</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>

    <LI>上記に伴い、<A HREF="#MIDITrack_GetName">MIDITrack_GetName</A>関数で、pBufの型を<SPAN CLASS="KEYWORD">char</SPAN>*型からTCHAR*型に変更、lLenの単位をバイトから文字に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_SetName">MIDITrack_SetName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>

    <LI>上記に伴い、<A HREF="#MIDITrack_InsertTextEvent">MIDITrack_InsertTextEvent</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertTrackName">MIDITrack_InsertTrackName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertInstrumentName">MIDITrack_InsertInstrumentName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertLyric">MIDITrack_InsertLyric</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertMarker">MIDITrack_InsertMarker</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertCuePoint">MIDITrack_InsertCuePpoint</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertProgramName">MIDITrack_InsertProgramName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDITrack_InsertDeviceName">MIDITrack_InsertDeviceName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>

    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateTextEvent">MIDIEvent_CreateTextEvent</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateTrackName">MIDIEvent_CreateTrackName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateInstrumentName">MIDIEvent_CreateInstrumentName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateLyric">MIDIEvent_CreateLyric</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateMarker">MIDIEvent_CreateMarker</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateCuePoint">MIDIEvent_CreateCuePpoint</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateProgramName">MIDIEvent_CreateProgramName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_CreateDeviceName">MIDIEvent_CreateDeviceName</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>

    <LI>上記に伴い、<A HREF="#MIDIEvent_GetText">MIDIEvent_GetText</A>関数で、pDataの型を<SPAN CLASS="KEYWORD">char</SPAN>*型からTCHAR*型に変更、lLenの単位をバイトから文字に変更した。</LI>
    <LI>上記に伴い、<A HREF="#MIDIEvent_SetText">MIDIEvent_SetText</A>関数で、pszTextの型を<SPAN CLASS="KEYWORD">const char</SPAN>*型から<SPAN CLASS="KEYWORD">const</SPAN> TCHAR*型に変更した。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.7
  </TD>
  <TD>
   2012年09月30日
  </TD>
  <TD>
   <UL>
    <LI>TPQNベースの分解能の有効範囲を1〜32767[TPQN]とし、960[TPQN]より高い分解能のMIDIデータも取り扱えるようにした。これに伴い、<A HREF="#MIDIData_SetTimeBase">MIDIData_SetTimeBase</A>の内部演算を64bitとした。しかし依然として960[TPQN]を超えるMIDIデータの作成・編集は推奨しない。</LI>
    <LI>テンポの有効範囲を1〜60000000[μsec/4分音符]とした。</LI>
    <LI><A HREF="#MIDIData_LoadFromBinary">MIDIData_LoadFromBinary</A>で、フォーマット、トラック数、タイムベースのチェックに関するバグを修正した。</LI>
    <LI><A HREF="#MIDIData_LoadFromSMF">MIDIData_LoadFromSMF</A>で、フォーマット、トラック数、タイムベースのチェックに関するバグを修正した。</LI>
    <LI><A HREF="#MIDIData_LoadFromCherry">MIDIData_LoadFromCherry</A>で、フォーマット、トラック数、タイムベースのチェックに関するバグを修正した。</LI>
    <LI><A HREF="#MIDIData_LoadFromMIDICSV">MIDIData_LoadFromMIDICSV</A>で、フォーマット、トラック数、タイムベースのチェックに関するバグを修正した。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.8
  </TD>
  <TD>
   2013年05月05日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIDataLib_SetLocale">MIDIDataLib_SetLocale</A>を一時的に追加した。</LI>
    <LI>MIDIEvent_ToString及びMIDIEvent_ToStringEx内のバグを修正した。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   2.9
  </TD>
  <TD>
   2013年11月10日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDITrack_InsertPatchChange">MIDITrack_InsertPatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDITrack_InsertRPNChange">MIDITrack_InsertPatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDITrack_InsertNRPNChange">MIDITrack_InsertPatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDIEvent_CreatePatchChange">MIDIEvent_CreatePatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDIEvent_CreateRPNChange">MIDIEvent_CreatePatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDIEvent_CreateNRPNChange">MIDIEvent_CreatePatchChange</A>の引数の仕様を変更した。</LI>
    <LI><A HREF="#MIDIEvent_CreateSysExEvent">MIDIEvent_CreateSysExEvent</A>のエクスポート忘れを修正。</LI>
    <LI><A HREF="#MIDIData_LoadFromCherry">MIDIData_LoadFromCherry</A>に関する一連のバグを修正し、Cherryシーケンスファイル(*.chy)の読み込み精度を高めた。</LI>
    <LI><A HREF="#MIDIData_SaveAsCherry">MIDIData_SaveAsCherry</A>に関する一連のバグを修正し、Cherryシーケンスファイル(*.chy)の書き込み精度を高めた。</LI>
    <LI>MIDIIO.basのバグ修正。</LI>
    <LI>公式ガイドブックの誤記修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.0
  </TD>
  <TD>
   2014年04月29日
  </TD>
  <TD>
   <UL>
    <LI>開発環境を、古いVisualC++ 4.0から新しいVisualC++ 2008 Service Pack1に移行した。</LI>
    <LI>公式ガイドブックの誤記修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.1
  </TD>
  <TD>
   2014年05月29日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_TextEvent">テキストイベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_CopyrightNotice">著作権イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_TrackName">トラック名イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_InstrumentName">インストゥルメント名イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_Lyric">歌詞イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_Marker">マーカーイベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_CuePoint">キューポイントイベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_ProgramName">プログラム名イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDIEvent_DeviceName">デバイス名イベント</A>の文字コード指定を可能にした。</LI>
    <LI><A HREF="#MIDITrack_InsertTextEventEx">MIDITrack_InsertTextEventEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertCopyrightNoticeEx">MIDITrack_InsertCopyrightNoticeEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertTrackNameEx">MIDITrack_InsertTrackNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertInstrumentNameEx">MIDITrack_InsertInstrumentNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertLyricEx">MIDITrack_InsertLyricEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertMarkerEx">MIDITrack_InsertMarkerEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertCuePointEx">MIDITrack_InsertCuePointEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertProgramNameEx">MIDITrack_InsertProgramNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDITrack_InsertDeviceNameEx">MIDITrack_InsertDeviceNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateTextEventEx">MIDIEvent_CreateTextEventEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateCopyrightNoticeEx">MIDIEvent_CreateCopyrightNoticeEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateTrackNameEx">MIDIEvent_CreateTrackNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateInstrumentNameEx">MIDIEvent_CreateInstrumentNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateLyricEx">MIDIEvent_CreateLyricEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateMarkerEx">MIDIEvent_CreateMarkerEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateCuePointEx">MIDIEvent_CreateCuePointEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateProgramNameEx">MIDIEvent_CreateProgramNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_CreateDeviceNameEx">MIDIEvent_CreateDeviceNameEx</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_GetCharCode">MIDIEvent_GetCharCode</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_SetCharCode">MIDIEvent_SetCharCode</A>関数を追加。</LI>
    <LI><A HREF="#MIDIEvent_GetText">MIDIEvent_GetText</A>関数の動作仕様を変更。</LI>
    <LI><A HREF="#MIDIEvent_SetText">MIDIEvent_SetText</A>関数の動作仕様を変更。</LI>
    <LI>公式ガイドブックの誤記修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.2
  </TD>
  <TD>
   2015年05月04日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_LoadFromSMF">MIDIData_LoadFromSMF</A>の読み込み能力を強化。</LI>
    <LI>英語版の公式ガイドブックを追加。</LI>
    <LI>公式ガイドブックの誤記修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.3
  </TD>
  <TD>
   2016年04月17日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIDataLib_SetDefaultCharCode">MIDIDataLib_SetDefaultCharCode</A>で、MIDIEVENT_NOCHARCODEを指定した場合、Windowsのコントロールパネルにて指定されている文字コード(ANSI Code Page)に基づいてテキストエンコードするように変更。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.4
  </TD>
  <TD>
   2016年05月08日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_GetText">MIDIEvent_GetText</A>の文字コード指定に関するバグを修正。</LI>
    <LI><A HREF="#MIDIEvent_SetText">MIDIEvent_SetText</A>の文字コード指定に関するバグを修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.5
  </TD>
  <TD>
   2017年12月17日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_GetDataEntryMSB">MIDIEvent_GetDataEntryMSB</A>を追加。</LI>
    <LI><A HREF="#MIDIEvent_SetDataEntryMSB">MIDIEvent_SetDataEntryMSB</A>を追加。</LI>
    <LI><A HREF="#MIDIEvent_GetPatchNum">MIDIEvent_GetPatchNum</A>を追加。</LI>
    <LI><A HREF="#MIDIEvent_SetPatchNum">MIDIEvent_SetPatchNum</A>を追加。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.6
  </TD>
  <TD>
   2018年04月15日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_LoadFromWRK">MIDIData_LoadFromWRK</A>を追加。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.7
  </TD>
  <TD>
   2019年01月03日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_SetTime">MIDIEvent_SetTime</A>, <A HREF="#MIDIEvent_SetDuration">MIDIEvent_SetDuration</A>, <A HREF="#MIDIEvent_SetTimeSingle">MIDIData_SetTimeSingle</A>を長さ0のノートイベントに使用したときに、落ちることがあるバグを修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.8
  </TD>
  <TD>
   2019年05月19日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIData_LoadFromMabiMML">MIDIData_LoadFromMabiMML</A>を追加。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   3.9
  </TD>
  <TD>
   2019年11月17日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_GetValue">MIDIEvent_GetValue</A>で、チャンネルプリフィックスとポートプリフィックスのデータ部がない場合でも0を返すように修正。</LI>
    <LI><A HREF="#MIDIEvent_GetTempo">MIDIEvent_GetTempo</A>を、データ部がない場合でも60000000/120を返すように修正。</LI>
    <LI><A HREF="#MIDIEvent_GetSMPTEOffset">MIDIEvent_GetSMPTEOffset</A>を、データ部が一部ない場合でも可能な限り値を返すように修正。</LI>
    <LI><A HREF="#MIDIEvent_GetTimeSignature">MIDIEvent_GetTimeSignature</A>を、データ部が一部ない場合でも可能な限り値を返すように修正。</LI>
    <LI><A HREF="#MIDIEvent_GetKeySignature">MIDIEvent_GetKeySignature</A>を、データ部が一部ない場合でも可能な限り値を返すように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetValue">MIDIEvent_SetValue</A>で、チャンネルプリフィックスとポートプリフィックスのデータ部がない場合でも落ちないように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetTempo">MIDIEvent_SetTempo</A>を、データ部がない場合でも落ちないように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetSMPTEOffset">MIDIEvent_SetSMPTEOffset</A>を、データ部が一部ない場合でも可能な限り値を設定するように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetTimeSignature">MIDIEvent_SetTimeSignature</A>を、データ部が一部ない場合でも可能な限り値を設定するように修正。</LI>
    <LI><A HREF="#MIDIEvent_SetKeySignature">MIDIEvent_SetKeySignature</A>を、データ部が一部ない場合でも可能な限り値を設定するように修正。</LI>
    <LI><A HREF="#MIDIEvent_CreateNoteOn">MIDIEvent_CreateNoteOn</A>で、キー番号のクリッピングが誤っているバグを修正。</LI>
   </UL>
  </TD>
 </TR>
 <TR>
  <TD>
   4.0
  </TD>
  <TD>
   2020年01月05日
  </TD>
  <TD>
   <UL>
    <LI><A HREF="#MIDIEvent_CreateTextEvent">MIDIEvent_CreateTextEvent</A>で、UTF-8に対応。</LI>
    <LI><A HREF="#MIDIEvent_CreateTextEventEx">MIDIEvent_CreateTextEventEx</A>で、UTF-8に対応。</LI>
    <LI><A HREF="#MIDIEvent_GetCharCode">MIDIEvent_GetCharCode</A>で、UTF-8に対応。</LI>
    <LI><A HREF="#MIDIEvent_GetText">MIDIEvent_GetText</A>で、UTF-8に対応。</LI>
    <LI><A HREF="#MIDIEvent_SetCharCode">MIDIEvent_SetCharCode</A>で、UTF-8に対応。</LI>
    <LI><A HREF="#MIDIEvent_SetText">MIDIEvent_SetText</A>で、UTF-8に対応。</LI>
   </UL>
  </TD>
 </TR>


</TABLE>


</BODY>
</HTML>






